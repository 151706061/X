function g(a){throw a;}var i=void 0,l=null;function m(a){return function(){return this[a]}}var n,p=this;function aa(){}
function ba(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(c=="[object Window]")return"object";if(c=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(c=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(b=="function"&&typeof a.call=="undefined")return"object";return b}function q(a){return a!==i}function r(a){return a!=l}function ca(a){return ba(a)=="array"}function da(a){var b=ba(a);return b=="array"||b=="object"&&typeof a.length=="number"}function s(a){return typeof a=="string"}function t(a){return typeof a=="number"}function ea(a){return ba(a)=="function"}function fa(a){a=ba(a);return a=="object"||a=="array"||a=="function"}function ga(a){return a[ha]||(a[ha]=++ia)}
var ha="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),ia=0;function v(a,b){var c=a.split("."),d=p;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&q(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function w(a,b){function c(){}c.prototype=b.prototype;a.P=b.prototype;a.prototype=new c};var ja=0;function ka(a){if(!la.test(a))return a;a.indexOf("&")!=-1&&(a=a.replace(ma,"&amp;"));a.indexOf("<")!=-1&&(a=a.replace(na,"&lt;"));a.indexOf(">")!=-1&&(a=a.replace(oa,"&gt;"));a.indexOf('"')!=-1&&(a=a.replace(pa,"&quot;"));return a}var ma=/&/g,na=/</g,oa=/>/g,pa=/\"/g,la=/[&<>\"]/;
function qa(a,b){for(var c=0,d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=String(b).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=Math.max(d.length,e.length),h=0;c==0&&h<f;h++){var o=d[h]||"",k=e[h]||"",j=RegExp("(\\d*)(\\D*)","g"),I=RegExp("(\\d*)(\\D*)","g");do{var u=j.exec(o)||["","",""],C=I.exec(k)||["","",""];if(u[0].length==0&&C[0].length==0)break;c=ra(u[1].length==0?0:parseInt(u[1],10),C[1].length==0?0:parseInt(C[1],10))||ra(u[2].length==0,C[2].length==0)||ra(u[2],C[2])}while(c==
0)}return c}function ra(a,b){if(a<b)return-1;else if(a>b)return 1;return 0};var sa,ta,ua,va,wa;function xa(){return p.navigator?p.navigator.userAgent:l}va=ua=ta=sa=!1;var ya;if(ya=xa()){var za=p.navigator;sa=ya.indexOf("Opera")==0;ta=!sa&&ya.indexOf("MSIE")!=-1;ua=!sa&&ya.indexOf("WebKit")!=-1;va=!sa&&!ua&&za.product=="Gecko"}var Aa=sa,x=ta,Ba=va,Ca=ua,Da,Ea=p.navigator;Da=Ea&&Ea.platform||"";wa=Da.indexOf("Mac")!=-1;var Fa=Da.indexOf("Win")!=-1,Ga;
a:{var Ha="",Ia;if(Aa&&p.opera)var Ja=p.opera.version,Ha=typeof Ja=="function"?Ja():Ja;else if(Ba?Ia=/rv\:([^\);]+)(\)|;)/:x?Ia=/MSIE\s+([^\);]+)(\)|;)/:Ca&&(Ia=/WebKit\/(\S+)/),Ia)var Ka=Ia.exec(xa()),Ha=Ka?Ka[1]:"";if(x){var La,Ma=p.document;La=Ma?Ma.documentMode:i;if(La>parseFloat(Ha)){Ga=String(La);break a}}Ga=Ha}var Na={};function Oa(a){return Na[a]||(Na[a]=qa(Ga,a)>=0)}var Pa={};function Qa(){return Pa[9]||(Pa[9]=x&&document.documentMode&&document.documentMode>=9)};function Ra(a,b){for(var c in a)b.call(i,a[c],c,a)}var Sa=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];function Ta(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Sa.length;f++)c=Sa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var y=Array.prototype,Ua=y.indexOf?function(a,b,c){return y.indexOf.call(a,b,c)}:function(a,b,c){c=c==l?0:c<0?Math.max(0,a.length+c):c;if(s(a))return!s(b)||b.length!=1?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Va=y.forEach?function(a,b,c){y.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=s(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};function Wa(a){return y.concat.apply(y,arguments)}
function Xa(a){if(ca(a))return Wa(a);else{for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}}function Ya(a,b,c){return arguments.length<=2?y.slice.call(a,b):y.slice.call(a,b,c)};var Za;!x||Qa();var $a=x&&!Oa("8");function ab(){}ab.prototype.jb=!1;ab.prototype.H=function(){if(!this.jb)this.jb=!0,this.v()};ab.prototype.v=function(){this.Ub&&bb.apply(l,this.Ub)};function bb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];da(d)?bb.apply(l,d):d&&typeof d.H=="function"&&d.H()}};function z(a,b){this.type=a;this.currentTarget=this.target=b}w(z,ab);n=z.prototype;n.v=function(){delete this.type;delete this.target;delete this.currentTarget};n.K=!1;n.$=!0;n.stopPropagation=function(){this.K=!0};n.preventDefault=function(){this.$=!1};var cb=new Function("a","return a");function A(a,b){a&&this.t(a,b)}w(A,z);n=A.prototype;n.target=l;n.relatedTarget=l;n.offsetX=0;n.offsetY=0;n.clientX=0;n.clientY=0;n.screenX=0;n.screenY=0;n.button=0;n.keyCode=0;n.charCode=0;n.ctrlKey=!1;n.altKey=!1;n.shiftKey=!1;n.metaKey=!1;n.bc=!1;n.I=l;
n.t=function(a,b){var c=this.type=a.type;z.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ba){var e;a:{try{cb(d.nodeName);e=!0;break a}catch(f){}e=!1}e||(d=l)}}else if(c=="mouseover")d=a.fromElement;else if(c=="mouseout")d=a.toElement;this.relatedTarget=d;this.offsetX=a.offsetX!==i?a.offsetX:a.layerX;this.offsetY=a.offsetY!==i?a.offsetY:a.layerY;this.clientX=a.clientX!==i?a.clientX:a.pageX;this.clientY=a.clientY!==i?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||(c=="keypress"?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.bc=wa?a.metaKey:a.ctrlKey;this.state=a.state;this.I=a;delete this.$;delete this.K};n.stopPropagation=function(){A.P.stopPropagation.call(this);this.I.stopPropagation?this.I.stopPropagation():this.I.cancelBubble=!0};
n.preventDefault=function(){A.P.preventDefault.call(this);var a=this.I;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,$a)try{if(a.ctrlKey||a.keyCode>=112&&a.keyCode<=123)a.keyCode=-1}catch(b){}};n.v=function(){A.P.v.call(this);this.relatedTarget=this.currentTarget=this.target=this.I=l};function db(){}var eb=0;n=db.prototype;n.key=0;n.O=!1;n.fb=!1;n.t=function(a,b,c,d,e,f){ea(a)?this.mb=!0:a&&a.handleEvent&&ea(a.handleEvent)?this.mb=!1:g(Error("Invalid listener argument"));this.Y=a;this.Eb=b;this.src=c;this.type=d;this.capture=!!e;this.Ba=f;this.fb=!1;this.key=++eb;this.O=!1};n.handleEvent=function(a){return this.mb?this.Y.call(this.Ba||this.src,a):this.Y.handleEvent.call(this.Y,a)};var fb,gb=(fb="ScriptEngine"in p&&p.ScriptEngine()=="JScript")?p.ScriptEngineMajorVersion()+"."+p.ScriptEngineMinorVersion()+"."+p.ScriptEngineBuildVersion():"0";function B(a,b){this.ob=b;this.J=[];a>this.ob&&g(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.J.push(this.z?this.z():{})}w(B,ab);B.prototype.z=l;B.prototype.ib=l;B.prototype.getObject=function(){return this.J.length?this.J.pop():this.z?this.z():{}};function hb(a,b){a.J.length<a.ob?a.J.push(b):ib(a,b)}function ib(a,b){if(a.ib)a.ib(b);else if(fa(b))if(ea(b.H))b.H();else for(var c in b)delete b[c]}
B.prototype.v=function(){B.P.v.call(this);for(var a=this.J;a.length;)ib(this,a.pop());delete this.J};var jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb;
(function(){function a(){return{e:0,u:0}}function b(){return[]}function c(){function a(b){b=h.call(a.src,a.key,b);if(!b)return b}return a}function d(){return new db}function e(){return new A}var f=fb&&!(qa(gb,"5.7")>=0),h;ob=function(a){h=a};if(f){jb=function(){return o.getObject()};kb=function(a){hb(o,a)};lb=function(){return k.getObject()};mb=function(a){hb(k,a)};nb=function(){return j.getObject()};pb=function(){hb(j,c())};qb=function(){return I.getObject()};rb=function(a){hb(I,a)};sb=function(){return u.getObject()};
tb=function(a){hb(u,a)};var o=new B(0,600);o.z=a;var k=new B(0,600);k.z=b;var j=new B(0,600);j.z=c;var I=new B(0,600);I.z=d;var u=new B(0,600);u.z=e}else jb=a,kb=aa,lb=b,mb=aa,nb=c,pb=aa,qb=d,rb=aa,sb=e,tb=aa})();var ub={},D={},E={},vb={};
function F(a,b,c,d,e){if(b)if(ca(b)){for(var f=0;f<b.length;f++)F(a,b[f],c,d,e);return l}else{var d=!!d,h=D;b in h||(h[b]=jb());h=h[b];d in h||(h[d]=jb(),h.e++);var h=h[d],o=ga(a),k;h.u++;if(h[o]){k=h[o];for(f=0;f<k.length;f++)if(h=k[f],h.Y==c&&h.Ba==e){if(h.O)break;return k[f].key}}else k=h[o]=lb(),h.e++;f=nb();f.src=a;h=qb();h.t(c,f,a,b,d,e);c=h.key;f.key=c;k.push(h);ub[c]=h;E[o]||(E[o]=lb());E[o].push(h);a.addEventListener?(a==p||!a.hb)&&a.addEventListener(b,f,d):a.attachEvent(b in vb?vb[b]:vb[b]=
"on"+b,f);return c}else g(Error("Invalid event type"))}function wb(a,b,c,d,e){if(ca(b))for(var f=0;f<b.length;f++)wb(a,b[f],c,d,e);else{d=!!d;a:{f=D;if(b in f&&(f=f[b],d in f&&(f=f[d],a=ga(a),f[a]))){a=f[a];break a}a=l}if(a)for(f=0;f<a.length;f++)if(a[f].Y==c&&a[f].capture==d&&a[f].Ba==e){xb(a[f].key);break}}}
function xb(a){if(ub[a]){var b=ub[a];if(!b.O){var c=b.src,d=b.type,e=b.Eb,f=b.capture;c.removeEventListener?(c==p||!c.hb)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in vb?vb[d]:vb[d]="on"+d,e);c=ga(c);e=D[d][f][c];if(E[c]){var h=E[c],o=Ua(h,b);o>=0&&y.splice.call(h,o,1);h.length==0&&delete E[c]}b.O=!0;e.rb=!0;yb(d,f,c,e);delete ub[a]}}}
function yb(a,b,c,d){if(!d.ka&&d.rb){for(var e=0,f=0;e<d.length;e++)if(d[e].O){var h=d[e].Eb;h.src=l;pb(h);rb(d[e])}else e!=f&&(d[f]=d[e]),f++;d.length=f;d.rb=!1;f==0&&(mb(d),delete D[a][b][c],D[a][b].e--,D[a][b].e==0&&(kb(D[a][b]),delete D[a][b],D[a].e--),D[a].e==0&&(kb(D[a]),delete D[a]))}}
function zb(a){var b,c=0,d=b==l;b=!!b;if(a==l)Ra(E,function(a){for(var e=a.length-1;e>=0;e--){var f=a[e];if(d||b==f.capture)xb(f.key),c++}});else if(a=ga(a),E[a])for(var a=E[a],e=a.length-1;e>=0;e--){var f=a[e];if(d||b==f.capture)xb(f.key),c++}}function Ab(a,b,c,d,e){var f=1,b=ga(b);if(a[b]){a.u--;a=a[b];a.ka?a.ka++:a.ka=1;try{for(var h=a.length,o=0;o<h;o++){var k=a[o];k&&!k.O&&(f&=Bb(k,e)!==!1)}}finally{a.ka--,yb(c,d,b,a)}}return Boolean(f)}
function Bb(a,b){var c=a.handleEvent(b);a.fb&&xb(a.key);return c}
ob(function(a,b){if(!ub[a])return!0;var c=ub[a],d=c.type,e=D;if(!(d in e))return!0;var e=e[d],f,h;Za===i&&(Za=x&&!p.addEventListener);if(Za){var o;if(!(o=b))a:{o="window.event".split(".");for(var k=p;f=o.shift();)if(r(k[f]))k=k[f];else{o=l;break a}o=k}f=o;o=!0 in e;k=!1 in e;if(o){if(f.keyCode<0||f.returnValue!=i)return!0;a:{var j=!1;if(f.keyCode==0)try{f.keyCode=-1;break a}catch(I){j=!0}if(j||f.returnValue==i)f.returnValue=!0}}j=sb();j.t(f,this);f=!0;try{if(o){for(var u=lb(),C=j.currentTarget;C;C=
C.parentNode)u.push(C);h=e[!0];h.u=h.e;for(var J=u.length-1;!j.K&&J>=0&&h.u;J--)j.currentTarget=u[J],f&=Ab(h,u[J],d,!0,j);if(k){h=e[!1];h.u=h.e;for(J=0;!j.K&&J<u.length&&h.u;J++)j.currentTarget=u[J],f&=Ab(h,u[J],d,!1,j)}}else f=Bb(c,j)}finally{if(u)u.length=0,mb(u);j.H();tb(j)}return f}d=new A(b,this);try{f=Bb(c,d)}finally{d.H()}return f});var Cb=0;function Db(){}w(Db,ab);n=Db.prototype;n.hb=!0;n.Da=l;n.addEventListener=function(a,b,c,d){F(this,a,b,c,d)};n.removeEventListener=function(a,b,c,d){wb(this,a,b,c,d)};
n.dispatchEvent=function(a){var b=a.type||a,c=D;if(b in c){if(s(a))a=new z(a,this);else if(a instanceof z)a.target=a.target||this;else{var d=a,a=new z(b,this);Ta(a,d)}var d=1,e,c=c[b],b=!0 in c,f;if(b){e=[];for(f=this;f;f=f.Da)e.push(f);f=c[!0];f.u=f.e;for(var h=e.length-1;!a.K&&h>=0&&f.u;h--)a.currentTarget=e[h],d&=Ab(f,e[h],a.type,!0,a)&&a.$!=!1}if(!1 in c)if(f=c[!1],f.u=f.e,b)for(h=0;!a.K&&h<e.length&&f.u;h++)a.currentTarget=e[h],d&=Ab(f,e[h],a.type,!1,a)&&a.$!=!1;else for(e=this;!a.K&&e&&f.u;e=
e.Da)a.currentTarget=e,d&=Ab(f,e,a.type,!1,a)&&a.$!=!1;a=Boolean(d)}else a=!0;return a};n.v=function(){Db.P.v.call(this);zb(this);this.Da=l};function G(){this.i="base";this.Nb="X"+ja++}w(G,Db);G.prototype.className=m("i");G.prototype.id=m("Nb");G.prototype.print=function(){var a=Object.keys(this),b="",c="<unknown>",d=0;for(d in a){var e="this."+a[d],f=eval(e);e=="this._className"?c=f:b+=e+": "+f+"\n"}a="== X."+c+" ==\n";a+=b;return a};v("X.base",G);v("X.base.prototype.className",G.prototype.className);v("X.base.prototype.id",G.prototype.id);v("X.base.prototype.print",G.prototype.print);function H(a){var b="Unknown error!";r(a)&&(b=a);G.call(this);this.i="exception";this.ic=b;this.jc=Error().stack}w(H,G);v("X.exception",H);function K(a,b,c){(!t(a)||a<0||a>1||!t(b)||b<0||b>1||!t(c)||c<0||c>1)&&g(new H("Fatal: Wrong RGB values - must be in range 0..1!"));G.call(this);this.i="color";this.Xa=a;this.Ma=b;this.Ia=c}w(K,G);K.prototype.red=m("Xa");K.prototype.green=m("Ma");K.prototype.blue=m("Ia");K.prototype.s=function(){var a=Array(3);a[0]=this.Xa;a[1]=this.Ma;a[2]=this.Ia;return a};v("X.color",K);v("X.color.prototype.red",K.prototype.red);v("X.color.prototype.green",K.prototype.green);v("X.color.prototype.blue",K.prototype.blue);
v("X.color.prototype.flatten",K.prototype.s);function Eb(a,b){var c;c=(c=a.className)&&typeof c.split=="function"?c.split(/\s+/):[];var d=Ya(arguments,1),e;e=c;for(var f=0,h=0;h<d.length;h++)Ua(e,d[h])>=0||(e.push(d[h]),f++);e=f==d.length;a.className=c.join(" ");return e};function Fb(a,b){this.width=a;this.height=b}function Gb(a,b){return a==b?!0:!a||!b?!1:a.width==b.width&&a.height==b.height}Fb.prototype.D=function(){return new Fb(this.width,this.height)};Fb.prototype.toString=function(){return"("+this.width+" x "+this.height+")"};Fb.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};Fb.prototype.scale=function(a){this.width*=a;this.height*=a;return this};var Hb=!x||Qa();!Ba&&!x||x&&Qa()||Ba&&Oa("1.9.1");x&&Oa("9");function Ib(a,b){this.x=q(a)?a:0;this.y=q(b)?b:0}Ib.prototype.D=function(){return new Ib(this.x,this.y)};Ib.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function Jb(a,b){Ra(b,function(b,d){d=="style"?a.style.cssText=b:d=="class"?a.className=b:d=="for"?a.htmlFor=b:d in Kb?a.setAttribute(Kb[d],b):d.lastIndexOf("aria-",0)==0?a.setAttribute(d,b):a[d]=b})}var Kb={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};
function Lb(a,b,c){var d=arguments,e=document,f=d[0],h=d[1];if(!Hb&&h&&(h.name||h.type)){f=["<",f];h.name&&f.push(' name="',ka(h.name),'"');if(h.type){f.push(' type="',ka(h.type),'"');var o={};Ta(o,h);h=o;delete h.type}f.push(">");f=f.join("")}f=e.createElement(f);if(h)s(h)?f.className=h:ca(h)?Eb.apply(l,[f].concat(h)):Jb(f,h);d.length>2&&Mb(e,f,d);return f}
function Mb(a,b,c){function d(c){c&&b.appendChild(s(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];da(f)&&!(fa(f)&&f.nodeType>0)?Va(Nb(f)?Xa(f):f,d):d(f)}}function Nb(a){if(a&&typeof a.length=="number")if(fa(a))return typeof a.item=="function"||typeof a.item=="string";else if(ea(a))return typeof a.item=="function";return!1};function L(){G.call(this);this.i="console";this.ta=l}w(L,G);L.prototype.za=function(){if(!this.ta){var a;(a=(a=document)?a.parentWindow||a.defaultView:window)||g(new H("Fatal: Could not get the window!"));(a=a.console)||g(new H("Fatal: The console is not available!"));this.ta=a}return this.ta};L.prototype.N=function(a){var b=this.za();b&&b.log(a)};L.prototype.kb=function(a){var b=this.za();b&&b.error(a)};v("X.console",L);v("X.console.prototype.console_",L.prototype.za);
v("X.console.prototype.out",L.prototype.N);v("X.console.prototype.err",L.prototype.kb);function M(){G.call(this);this.i="shader";var a=this.C="";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexColor;\n";a+="attribute float vertexOpacity;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="varying lowp vec4 fragmentColor;\n";a+="\n";a+="void main(void) {\n";a+="  gl_Position = perspective * view * vec4(vertexPosition, 1.0);\n";a+="  fragmentColor = vec4(vertexColor,vertexOpacity);\n";a+="}\n";this.C=a;a=this.va="";a+="varying lowp vec4 fragmentColor;\n";
a+="\n";a+="void main(void) {\n";a+="  gl_FragColor = fragmentColor;\n";a+="}\n";this.va=a;this.Wa="vertexPosition";this.Ka="vertexColor";this.Ta="vertexOpacity";this.bb="view";this.Va="perspective"}w(M,G);n=M.prototype;n.gc=m("C");n.Xb=m("va");n.position=m("Wa");n.color=m("Ka");n.view=m("bb");n.Z=m("Va");n.opacity=m("Ta");
n.Ib=function(){var a=31337,a=this.C.search(this.Wa);a==-1&&g(new H("Fatal: Could not validate shader! The positionAttribute was bogus."));a=this.C.search(this.Ka);a==-1&&g(new H("Fatal: Could not validate shader! The colorAttribute was bogus."));a=this.C.search(this.Ta);a==-1&&g(new H("Fatal: Could not validate shader! The opacityAttribute was bogus."));a=this.C.search(this.Va);a==-1&&g(new H("Fatal: Could not validate shader! The perspectiveUniform was bogus."));a=this.C.search(this.bb);a==-1&&
g(new H("Fatal: Could not validate shader! The viewUniform was bogus."));return!0};v("X.shaders",M);v("X.shaders.prototype.vertex",M.prototype.gc);v("X.shaders.prototype.fragment",M.prototype.Xb);v("X.shaders.prototype.position",M.prototype.position);v("X.shaders.prototype.color",M.prototype.color);v("X.shaders.prototype.view",M.prototype.view);v("X.shaders.prototype.perspective",M.prototype.Z);v("X.shaders.prototype.opacity",M.prototype.opacity);v("X.shaders.prototype.validate",M.prototype.Ib);function N(a,b){this.x=a;this.y=b}w(N,Ib);n=N.prototype;n.D=function(){return new N(this.x,this.y)};n.la=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};n.scale=function(a){this.x*=a;this.y*=a;return this};n.lb=function(){this.x=-this.x;this.y=-this.y;return this};n.normalize=function(){return this.scale(1/this.la())};n.add=function(a){this.x+=a.x;this.y+=a.y;return this};n.Fa=function(a){this.x-=a.x;this.y-=a.y;return this};function O(a,b){if(a instanceof O)this.j=a.Ga();else{var c;if(c=da(a))a:{for(var d=c=0;d<a.length;d++){if(!da(a[d])||c>0&&a[d].length!=c){c=!1;break a}for(var e=0;e<a[d].length;e++)if(!t(a[d][e])){c=!1;break a}if(c==0)c=a[d].length}c=c!=0}c?this.j=Xa(a):a instanceof Fb?this.j=Ob(a.height,a.width):t(a)&&t(b)&&a>0&&b>0?this.j=Ob(a,b):g(Error("Invalid argument(s) for Matrix contructor"))}this.f=new Fb(this.j[0].length,this.j.length)}
function Pb(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new O(b)}function Qb(a,b,c){for(var d=0;d<a.f.height;d++)for(var e=0;e<a.f.width;e++)b.call(c,a.j[d][e],d,e,a)}function Rb(a,b){var c=new O(a.f);Qb(a,function(d,e,f){c.j[e][f]=b.call(i,d,e,f,a)});return c}function Ob(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}n=O.prototype;
n.add=function(a){Gb(this.f,a.f)||g(Error("Matrix summation is only supported on arrays of equal size"));return Rb(this,function(b,c,d){return b+a.j[c][d]})};function P(a,b,c,d){Sb(a,b,c)||g(Error("Index out of bounds when setting matrix value, ("+b+","+c+") in size ("+a.f.height+","+a.f.width+")"));a.j[b][c]=d}
n.multiply=function(a){if(a instanceof O)return this.f.width!=a.f.height&&g(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),Tb(this,a);else if(t(a))return Ub(this,a);else g(Error("A matrix can only be multiplied by a number or another matrix."))};n.Fa=function(a){Gb(this.f,a.f)||g(Error("Matrix subtraction is only supported on arrays of equal size."));return Rb(this,function(b,c,d){return b-a.j[c][d]})};n.Ga=m("j");
n.toString=function(){var a=0;Qb(this,function(b){b=String(b).length;b>a&&(a=b)});var b=[];Va(this.j,function(c){b.push("[ ");Va(c,function(c){c=String(c);b.push(Array(a-c.length+1).join(" ")+c+" ")});b.push("]\n")});return b.join("")};function Sb(a,b,c){return b>=0&&b<a.f.height&&c>=0&&c<a.f.width}function Tb(a,b){var c=new O(a.f.height,b.f.width);Qb(c,function(a,e,f){for(var h=a=0;h<this.f.width;h++)a+=(!Sb(this,e,h)?0:this.j[e][h])*(!Sb(b,h,f)?0:b.j[h][f]);P(c,e,f,a)},a);return c}
function Ub(a,b){return Rb(a,function(a){return a*b})};function Q(a,b,c){this.x=q(a)?a:0;this.y=q(b)?b:0;this.c=q(c)?c:0}Q.prototype.D=function(){return new Q(this.x,this.y,this.c)};Q.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.c+")"};Q.prototype.Ga=function(){return[this.x,this.y,this.c]};function R(a,b,c){this.x=a;this.y=b;this.c=c}w(R,Q);n=R.prototype;n.D=function(){return new R(this.x,this.y,this.c)};n.la=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.c*this.c)};n.scale=function(a){this.x*=a;this.y*=a;this.c*=a;return this};n.lb=function(){this.x=-this.x;this.y=-this.y;this.c=-this.c;return this};n.normalize=function(){return this.scale(1/this.la())};n.add=function(a){this.x+=a.x;this.y+=a.y;this.c+=a.c;return this};
n.Fa=function(a){this.x-=a.x;this.y-=a.y;this.c-=a.c;return this};function Vb(a,b){return new R(a.y*b.c-a.c*b.y,a.c*b.x-a.x*b.c,a.x*b.y-a.y*b.x)};O.prototype.s=function(){var a=[],b=this.f;if(b.height==0||b.width==0)return[];var c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(!Sb(this,c,d)?l:this.j[c][d]);return a};O.prototype.translate=function(a){this.f.width!=this.f.height&&g(new H("Fatal: Can not translate non-square matrix!"));var b=this.f,c=Pb(b.height);a instanceof N&&b.height==3?(P(c,0,2,a.x),P(c,1,2,a.y)):a instanceof R&&b.height==4?(P(c,0,3,a.x),P(c,1,3,a.y),P(c,2,3,a.c)):g(new H("Fatal: Translation failed!"));return this.multiply(c)};function Wb(a){this.X=a||Xb}function Xb(a,b){if(String(a)<String(b))return-1;else if(String(a)>String(b))return 1;return 0}n=Wb.prototype;n.p=l;n.X=l;n.B=l;n.A=l;n.e=0;
n.add=function(a){if(this.p==l)return this.A=this.B=this.p=new Yb(a),this.e=1,!0;var b=!1;Zb(this,function(c){var d=l;if(this.X(c.value,a)>0){if(d=c.left,c.left==l){var e=new Yb(a,c);c.left=e;if(c==this.B)this.B=e;b=!0;$b(this,c)}}else if(this.X(c.value,a)<0&&(d=c.right,c.right==l)){e=new Yb(a,c);c.right=e;if(c==this.A)this.A=e;b=!0;$b(this,c)}return d});b&&(this.e+=1);return b};
n.remove=function(a){var b=l;Zb(this,function(c){var d=l;if(this.X(c.value,a)>0)d=c.left;else if(this.X(c.value,a)<0)d=c.right;else if(b=c.value,c.left!=l||c.right!=l){var e=l,f;if(c.left!=l){f=ac(this,c.left);if(f!=c.left){if(f.parent.right=f.left)f.left.parent=f.parent;f.left=c.left;f.left.parent=f;e=f.parent}f.parent=c.parent;f.right=c.right;if(f.right)f.right.parent=f;if(c==this.A)this.A=f}else{f=bc(this,c.right);if(f!=c.right){if(f.parent.left=f.right)f.right.parent=f.parent;f.right=c.right;
f.right.parent=f;e=f.parent}f.parent=c.parent;f.left=c.left;if(f.left)f.left.parent=f;if(c==this.B)this.B=f}cc(c)?c.parent.left=f:dc(c)?c.parent.right=f:this.p=f;$b(this,e?e:f)}else if(cc(c)){this.oc=1;c.parent.left=l;if(c==this.B)this.B=c.parent;$b(this,c.parent)}else if(dc(c)){c.parent.right=l;if(c==this.A)this.A=c.parent;$b(this,c.parent)}else this.clear();return d});if(b)this.e=this.p?this.e-1:0;return b};n.clear=function(){this.A=this.B=this.p=l;this.e=0};
n.Aa=function(){var a=[];ec(this,function(b){a.push(b)});return a};function ec(a,b){if(a.p){var c,d=c=bc(a);for(c=c.left?c.left:c;d!=l;)if(d.left!=l&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=d.right!=l&&d.right!=c?d.right:d.parent;c=e}}}function Zb(a,b,c){for(c=c?c:a.p;c&&c!=l;)c=b.call(a,c)}
function $b(a,b){Zb(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;b-e>1?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&fc(this,a.left),jc(this,a)):e-b>1&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&jc(this,a.right),fc(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function fc(a,b){cc(b)?(b.parent.left=b.right,b.right.parent=b.parent):dc(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.p=b.right,a.p.parent=l);var c=b.right;b.right=b.right.left;if(b.right!=l)b.right.parent=b;c.left=b;b.parent=c}function jc(a,b){cc(b)?(b.parent.left=b.left,b.left.parent=b.parent):dc(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.p=b.left,a.p.parent=l);var c=b.left;b.left=b.left.right;if(b.left!=l)b.left.parent=b;c.right=b;b.parent=c}
function bc(a,b){if(!b)return a.B;var c=b;Zb(a,function(a){var b=l;if(a.left)b=c=a.left;return b},b);return c}function ac(a,b){if(!b)return a.A;var c=b;Zb(a,function(a){var b=l;if(a.right)b=c=a.right;return b},b);return c}function Yb(a,b){this.value=a;this.parent=b?b:l}Yb.prototype.left=l;Yb.prototype.right=l;Yb.prototype.height=1;function dc(a){return!!a.parent&&a.parent.right==a}function cc(a){return!!a.parent&&a.parent.left==a};function S(a,b,c){r(a)||g(new H("Fatal: Invalid GL Buffer!"));r(b)||g(new H("Fatal: Invalid number of items!"));r(c)||g(new H("Fatal: Invalid item size!"));G.call(this);this.i="buffer";this.fa=a;this.Pa=b;this.ga=c}w(S,G);S.prototype.Yb=m("fa");S.prototype.$b=m("Pa");S.prototype.ac=m("ga");v("X.buffer",S);v("X.buffer.prototype.glBuffer",S.prototype.Yb);v("X.buffer.prototype.itemCount",S.prototype.$b);v("X.buffer.prototype.itemSize",S.prototype.ac);var kc="StopIteration"in p?p.StopIteration:Error("StopIteration");function lc(){}lc.prototype.next=function(){g(kc)};lc.prototype.Q=function(){return this};function T(a,b){this.o={};this.g=[];var c=arguments.length;if(c>1){c%2&&g(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){var e;if(a instanceof T)mc(a),e=a.g.concat(),d=a.Aa();else{var c=[],f=0;for(e in a)c[f++]=e;e=c;c=[];f=0;for(d in a)c[f++]=a[d];d=c}for(c=0;c<e.length;c++)this.set(e[c],d[c])}}n=T.prototype;n.e=0;n.ca=0;n.Aa=function(){mc(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.o[this.g[b]]);return a};
function nc(a,b){return oc(a.o,b)}function pc(a,b){for(var c=0;c<a.g.length;c++){var d=a.g[c];if(oc(a.o,d)&&a.o[d]==b)return!0}return!1}n.clear=function(){this.o={};this.ca=this.e=this.g.length=0};n.remove=function(a){return oc(this.o,a)?(delete this.o[a],this.e--,this.ca++,this.g.length>2*this.e&&mc(this),!0):!1};
function mc(a){if(a.e!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];oc(a.o,d)&&(a.g[c++]=d);b++}a.g.length=c}if(a.e!=a.g.length){for(var e={},c=b=0;b<a.g.length;)d=a.g[b],oc(e,d)||(a.g[c++]=d,e[d]=1),b++;a.g.length=c}}n.get=function(a,b){return oc(this.o,a)?this.o[a]:b};n.set=function(a,b){oc(this.o,a)||(this.e++,this.g.push(a),this.ca++);this.o[a]=b};n.D=function(){return new T(this)};
n.Q=function(a){mc(this);var b=0,c=this.g,d=this.o,e=this.ca,f=this,h=new lc;h.next=function(){for(;;){e!=f.ca&&g(Error("The map has changed since the iterator was created"));b>=c.length&&g(kc);var h=c[b++];return a?h:d[h]}};return h};function oc(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function U(){G.call(this);this.i="colors";this.k=new T;this.G=-1}w(U,G);n=U.prototype;n.add=function(a){a instanceof Array&&a.length==3&&(a=new K(a[0],a[1],a[2]));(!r(a)||!(a instanceof K))&&g(new H("Fatal: Invalid color."));nc(this.k,++this.G)&&g(new H("Fatal: Could not get unique id."));this.k.set(this.G,a);return this.G};n.get=function(a){(!r(a)||!nc(this.k,a))&&g(new H("Fatal: Invalid id."));return this.k.get(a)};
n.remove=function(a){(!r(a)||!(a instanceof K))&&g(new H("Fatal: Invalid color."));if(!pc(this.k,a))return!1;var b=this.k.Q(!0);try{for(;;){var c=b.next();if(this.k.get(c)==a)return this.k.remove(c)}}catch(d){d!=kc&&g(d)}};n.Ea=function(a){r(a)||g(new H("Fatal: Invalid id."));return!nc(this.k,a)?!1:this.k.remove(a)};n.clear=function(){this.k=new T};n.count=function(){return this.k.e};n.s=function(){var a=[],b=this.k.Q(!0);try{for(;;)var c=this.k.get(b.next()).s(),a=a.concat(c)}catch(d){d!=kc&&g(d)}return a};
v("X.colors",U);v("X.colors.prototype.add",U.prototype.add);v("X.colors.prototype.get",U.prototype.get);v("X.colors.prototype.remove",U.prototype.remove);v("X.colors.prototype.removeById",U.prototype.Ea);v("X.colors.prototype.count",U.prototype.count);v("X.colors.prototype.flatten",U.prototype.s);function V(){G.call(this);this.i="points";this.l=new T;this.G=-1}w(V,G);n=V.prototype;n.add=function(a){r(a)||g(new H("Fatal: Invalid point."));ca(a)&&a.length==3&&(a=new Q(a[0],a[1],a[2]));a instanceof Q||g(new H("Fatal: Invalid point."));nc(this.l,++this.G)&&g(new H("Fatal: Could not get unique id."));this.l.set(this.G,a);return this.G};n.get=function(a){(!r(a)||!nc(this.l,a))&&g(new H("Fatal: Invalid id."));return this.l.get(a)};
n.remove=function(a){a instanceof Q||g(new H("Fatal: Invalid point."));if(!pc(this.l,a))return!1;var b=this.l.Q(!0);try{for(;;){var c=b.next();if(this.l.get(c)==a)return this.l.remove(c)}}catch(d){d!=kc&&g(d)}};n.Ea=function(a){r(a)||g(new H("Fatal: Invalid id."));return!nc(this.l,a)?!1:this.l.remove(a)};n.clear=function(){this.l=new T};n.count=function(){return this.l.e};n.s=function(){var a=[],b=this.l.Q(!0);try{for(;;)var c=this.l.get(b.next()).Ga(),a=a.concat(c)}catch(d){d!=kc&&g(d)}return a};
v("X.points",V);v("X.points.prototype.add",V.prototype.add);v("X.points.prototype.get",V.prototype.get);v("X.points.prototype.remove",V.prototype.remove);v("X.points.prototype.removeById",V.prototype.Ea);v("X.points.prototype.count",V.prototype.count);v("X.points.prototype.flatten",V.prototype.s);function qc(a){z.call(this,a)}w(qc,z);v("X.event",qc);v("X.event.uniqueId",function(a){return a+"_"+Cb++});function W(a,b){(!t(a)||!t(b))&&g(new H("Fatal: A camera needs valid width and height values."));G.call(this);this.i="camera";this.Mb=45;this.r=new R(0,0,100);this.w=new R(0,0,0);this.Qb=new R(0,1,0);var c=a/b,d=1*Math.tan(this.Mb*Math.PI/360),e=-d;this.Ob=new O([[2/(d*c-e*c),0,(d*c+e*c)/(d*c-e*c),0],[0,2/(d-e),(d+e)/(d-e),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]]);this.W=rc(this,this.r,this.w)}w(W,G);var sc="pan_"+Cb++,tc="rotate_"+Cb++,uc="zoom_"+Cb++;n=W.prototype;
n.Ca=function(a){(!r(a)||!(a instanceof Y))&&g(new H("Fatal: Could not observe the interactor."));F(a,sc,this.Ab.bind(this));F(a,tc,this.Bb.bind(this));F(a,uc,this.Cb.bind(this))};n.Cb=function(a){a instanceof vc||g(new H("Fatal: Received no valid zoom event!"));a.wa?this.Jb(a.ea):this.Kb(a.ea)};n.Ab=function(a){a instanceof wc||g(new H("Fatal: Received no valid pan event!"));this.Db(a.R)};n.Bb=function(a){a instanceof xc||g(new H("Fatal: Received no valid rotate event!"));this.rotate(a.R)};n.Z=m("Ob");
n.view=m("W");n.position=m("r");n.Db=function(a){a instanceof N||g(new H("Fatal: Invalid distance vector for pan operation."));this.r.x+=a.x;this.r.y-=a.y;this.w.x+=a.x;this.w.y-=a.y;this.W=rc(this,this.r,this.w);this.dispatchEvent(new yc)};n.rotate=function(a){a instanceof N||g(new H("Fatal: Invalid distance vector for rotate operation."));this.r.x+=a.x;this.r.y-=a.y;this.W=rc(this,this.r,this.w);this.dispatchEvent(new yc)};
n.Jb=function(a){var b=30;r(a)&&!a&&(b=1);this.r.c-=b;this.w.c-=b;this.W=rc(this,this.r,this.w);this.dispatchEvent(new yc)};n.Kb=function(a){var b=30;r(a)&&!a&&(b=1);this.r.c+=b;this.w.c+=b;this.W=rc(this,this.r,this.w);this.dispatchEvent(new yc)};
function rc(a,b,c){(!(b instanceof R)||!(c instanceof R))&&g(new H("Fatal: 3D vectors required for calculating the view."));var d=Pb(4),c=new R(b.x-c.x,b.y-c.y,b.c-c.c),c=c.normalize(),a=a.Qb.D(),e=Vb(a,c),a=Vb(c,e),e=e.normalize(),a=a.normalize();P(d,0,0,e.x);P(d,0,1,e.y);P(d,0,2,e.c);P(d,0,3,0);P(d,1,0,a.x);P(d,1,1,a.y);P(d,1,2,a.c);P(d,1,3,0);P(d,2,0,c.x);P(d,2,1,c.y);P(d,2,2,c.c);P(d,2,3,0);P(d,3,0,0);P(d,3,1,0);P(d,3,2,0);P(d,3,3,1);b=b.D();return d.translate(b.lb())}
function wc(){z.call(this,sc);this.R=l}w(wc,qc);function xc(){z.call(this,tc);this.R=l;this.Lb=0}w(xc,qc);function vc(){z.call(this,uc);this.ea=this.wa=!1}w(vc,qc);v("X.camera",W);v("X.camera.prototype.observe",W.prototype.Ca);v("X.camera.prototype.onZoom",W.prototype.Cb);v("X.camera.prototype.onPan",W.prototype.Ab);v("X.camera.prototype.onRotate",W.prototype.Bb);v("X.camera.prototype.perspective",W.prototype.Z);v("X.camera.prototype.view",W.prototype.view);v("X.camera.prototype.position",W.prototype.position);
v("X.camera.prototype.pan",W.prototype.Db);v("X.camera.prototype.rotate",W.prototype.rotate);v("X.camera.prototype.zoomIn",W.prototype.Jb);v("X.camera.prototype.zoomOut",W.prototype.Kb);v("X.camera.prototype.observe",W.prototype.Ca);v("X.camera.PanEvent",wc);v("X.camera.RotateEvent",xc);v("X.camera.ZoomEvent",vc);function Z(a){var b=zc;if(r(a)&&(a==Ac||a==zc))b=a;G.call(this);this.i="object";this.Pb=b;this.Ja=l;this.d=new V;this.h=new U;this.hc=this.kc=l;this.Sa=1;this.mc=!0}w(Z,G);var zc="TRIANGLES",Ac="LINES";n=Z.prototype;n.type=m("Pb");n.cc=m("d");n.Sb=m("h");n.color=m("Ja");n.aa=function(a){!r(a)&&!(a instanceof K)&&g(new H("Fatal: Invalid color."));this.Ja=a};n.opacity=m("Sa");n.ma=function(a){(!t(a)||a>1||a<0)&&g(new H("Fatal: Invalid opacity."));this.Sa=a};
function Bc(a,b){(!r(a)||!r(b)||!(a instanceof Z)||!(b instanceof Z))&&g(new H("Fatal: Two valid X.objects are required for comparison."));if(a.opacity()<=b.opacity())return 1;else if(a.opacity()>b.opacity())return-1}v("X.object",Z);v("X.object.prototype.type",Z.prototype.type);v("X.object.prototype.points",Z.prototype.cc);v("X.object.prototype.colors",Z.prototype.Sb);v("X.object.prototype.color",Z.prototype.color);v("X.object.prototype.setColor",Z.prototype.aa);v("X.object.prototype.opacity",Z.prototype.opacity);
v("X.object.prototype.setOpacity",Z.prototype.ma);v("X.object.OPACITY_COMPARATOR",Bc);function Cc(a){this.Wb=a;this.nb=F(this.Wb,Ba?"DOMMouseScroll":"mousewheel",this)}w(Cc,Db);
Cc.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.I;if(a.type=="mousewheel"){c=1;if(x||Ca&&(Fa||Oa("532.0")))c=40;d=Ca&&wa&&-a.wheelDelta%c!=0?-a.wheelDelta:-a.wheelDelta/c;q(a.wheelDeltaX)?(b=Ca&&wa&&-a.wheelDeltaX%c!=0?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Ca&&wa&&-a.wheelDeltaY%c!=0?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,d>100?d=3:d<-100&&(d=-3),q(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;t(this.pb)&&(b=Math.min(Math.max(b,-this.pb),this.pb));t(this.qb)&&(c=Math.min(Math.max(c,
-this.qb),this.qb));b=new Dc(d,a,b,c);try{this.dispatchEvent(b)}finally{b.H()}};Cc.prototype.v=function(){Cc.P.v.call(this);xb(this.nb);delete this.nb};function Dc(a,b,c,d){b&&this.t(b,i);this.type="mousewheel";this.detail=a;this.nc=c;this.Tb=d}w(Dc,A);function Y(a){(!r(a)||!(a instanceof Element))&&g(new H("Fatal: Could not add interactor to the given element."));G.call(this);this.i="interactor";this.M=a;this.Qa=l;this.ja=this.ia=this.S=!1;this.ha=new N(0,0)}w(Y,G);n=Y.prototype;n.ub=function(){this.Qa=new Cc(this.M);F(this.Qa,"mousewheel",this.zb.bind(this))};n.sb=function(){F(this.M,"mousedown",this.vb.bind(this));F(this.M,"mouseup",this.yb.bind(this));this.M.oncontextmenu=function(){return!1}};
n.tb=function(){F(this.M,"mousemove",this.wb.bind(this));F(this.M,"mouseout",this.xb.bind(this))};n.vb=function(a){if(a.button==0)this.S=!0;else if(a.button==1)this.ia=!0;else if(a.button==2)this.ja=!0;a.preventDefault()};n.yb=function(a){if(a.button==0)this.S=!1;else if(a.button==1)this.ia=!1;else if(a.button==2)this.ja=!1;a.preventDefault()};n.xb=function(a){this.ja=this.ia=this.S=!1;this.ha.x=0;this.ha.y=0;a.preventDefault()};
n.wb=function(a){this.dispatchEvent("mouseup");a.preventDefault();var b=a.shiftKey,c=new N(a.clientX,a.clientY),a=this.ha.Fa(c);this.ha=c.D();if(Math.abs(a.x)<2)a.x=0;if(Math.abs(a.y)<2)a.y=0;if(a.la()!=0)if(this.S&&!b)b=new xc,b.R=a,b.Lb=0,this.dispatchEvent(b);else if(this.ia||this.S&&b)b=new wc,b.R=a,this.dispatchEvent(b);else if(this.ja)b=new vc,b.wa=a.y<0,b.ea=!1,this.dispatchEvent(b)};n.zb=function(a){a.preventDefault();var b=new vc;b.wa=a.Tb>0;b.ea=!0;this.dispatchEvent(b)};
v("X.interactor",Y);v("X.interactor.prototype.observeMouseWheel",Y.prototype.ub);v("X.interactor.prototype.observeMouseClicks",Y.prototype.sb);v("X.interactor.prototype.observeMouseMovement",Y.prototype.tb);v("X.interactor.prototype.onMouseDown",Y.prototype.vb);v("X.interactor.prototype.onMouseUp",Y.prototype.yb);v("X.interactor.prototype.onMouseMovementOutside",Y.prototype.xb);v("X.interactor.prototype.onMouseMovementInside",Y.prototype.wb);v("X.interactor.prototype.onMouseWheel",Y.prototype.zb);function $(a,b){if(!(this instanceof Ec)&&!(this instanceof Fc)){var c="";c+="Fatal: X.renderer should not be instantiated directly.";c+="Use X.renderer2D or X.renderer3D instead.";g(new H(c))}(!t(a)||!t(b))&&g(new H("Fatal: Invalid width or height for the renderer."));G.call(this);this.i="renderer";this.ua=-1;this.cb=a;this.Na=b;this.Ha="#000000";this.Oa=this.F=this.xa=this.ya=this.b=this.m=this.da=l;this.Ra=new Wb(Bc);this.Ya=new T;this.La=new T;this.Ua=new T}w($,G);var Gc="render_"+Cb++;
function yc(){z.call(this,Gc);this.lc=Date.now()}w(yc,qc);n=$.prototype;n.Vb=m("ua");n.width=m("cb");n.fc=function(a){this.m&&this.m.style.setProperty("width",a.toString());this.cb=a};n.height=m("Na");n.ec=function(a){this.m&&this.m.style.setProperty("height",a.toString());this.Na=a};n.backgroundColor=m("Ha");n.Fb=function(a){this.m&&this.m.style.setProperty("background-color",a.toString());this.Ha=a};n.canvas=function(){r(this.m)||g(new H("Fatal: No valid canvas for this renderer!"));return this.m};
n.gb=function(){if(!this.da){var a=document.body;a||g(new H("Fatal: Could not find <body></body>!"));this.da=a}return this.da};n.Gb=function(a){a||g(new H("Fatal: Could not find container!"));this.da=a};n.ba=function(a){this.Gb(s(a)?document.getElementById(a):a)};n.Rb=m("F");n.Zb=m("Oa");
n.t=function(){if(!r(this.m)){var a=Lb("canvas");a.style.setProperty("background-color",this.backgroundColor().toString());a.width=this.width();a.height=this.height();this.gb().appendChild(a);try{var b=a.getContext("experimental-webgl")}catch(c){g(new H("Fatal: Exception while getting GL Context!\n"+c))}b||g(new H("Fatal: WebGL not supported!"));try{b.viewport(0,0,this.width(),this.height()),b.clearColor(0,0,0,0),b.enable(b.BLEND),b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA),b.disable(b.DEPTH_TEST),
b.depthFunc(b.LEQUAL),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)}catch(d){g(new H("Fatal: Exception while accessing GL Context!\n"+d))}var e=new Y(a);e.ub();e.sb();e.tb();var f=new W(this.width(),this.height());f.Ca(e);F(f,Gc,this.L.bind(this));this.m=a;this.b=b;this.F=f;this.Oa=e;this.eb(new M)}};
n.eb=function(a){(!r(this.m)||!r(this.b)||!r(this.F))&&g(new H("Fatal: Renderer was not initialized properly!"));(!r(a)||!(a instanceof M))&&g(new H("Fatal: Could not add shaders!"));a.Ib();var b=this.b.createShader(this.b.FRAGMENT_SHADER),c=this.b.createShader(this.b.VERTEX_SHADER);this.b.shaderSource(b,a.va);this.b.shaderSource(c,a.C);this.b.compileShader(b);this.b.compileShader(c);(!this.b.getShaderParameter(b,this.b.COMPILE_STATUS)||!this.b.getShaderParameter(c,this.b.COMPILE_STATUS))&&g(new H("Fatal: Shader compilation failed!"));
var d=this.b.createProgram();this.b.attachShader(d,c);this.b.attachShader(d,b);this.b.linkProgram(d);this.b.getProgramParameter(d,this.b.LINK_STATUS)||g(new H("Fatal: Could not create shader program!"));this.b.useProgram(d);this.ab=this.b.getAttribLocation(d,a.position());this.b.enableVertexAttribArray(this.ab);this.Za=this.b.getAttribLocation(d,a.color());this.b.enableVertexAttribArray(this.Za);this.$a=this.b.getAttribLocation(d,a.opacity());this.b.enableVertexAttribArray(this.$a);this.xa=d;this.ya=
a};
n.n=function(a){(!r(this.m)||!r(this.b)||!r(this.F))&&g(new H("Fatal: Renderer was not initialized properly!"));(!r(a)||!(a instanceof Z))&&g(new H("Fatal: Illegal object!"));var b=!1,c=new K(1,1,1),d=l;a.color()===l?(b=a.d.count()==a.h.count(),d=a.h):c=a.color();if(!b){d=new U;for(b=0;b<a.d.count();b++)d.add(c)}c=this.b.createBuffer();this.b.bindBuffer(this.b.ARRAY_BUFFER,c);this.b.bufferData(this.b.ARRAY_BUFFER,new Float32Array(a.d.s()),this.b.STATIC_DRAW);c=new S(c,a.d.count(),3);b=this.b.createBuffer();this.b.bindBuffer(this.b.ARRAY_BUFFER,
b);this.b.bufferData(this.b.ARRAY_BUFFER,new Float32Array(d.s()),this.b.STATIC_DRAW);var d=new S(b,d.count(),3),b=this.b.createBuffer(),e=Array(a.d.s().length),f;for(f=0;f<e.length;++f)e[f]=a.opacity();this.b.bindBuffer(this.b.ARRAY_BUFFER,b);this.b.bufferData(this.b.ARRAY_BUFFER,new Float32Array(e),this.b.STATIC_DRAW);b=new S(b,1,1);this.Ra.add(a)||g(new H("Fatal: Could not add object to this renderer."));this.Ya.set(a.id(),c);this.La.set(a.id(),d);this.Ua.set(a.id(),b)};
n.L=function(){(!this.m||!this.b||!this.F)&&g(new H("Fatal: The renderer was not initialized properly!"));this.b.clear(this.b.COLOR_BUFFER_BIT|this.b.DEPTH_BUFFER_BIT);var a=this.F.Z(),b=this.F.view();this.b.uniformMatrix4fv(this.b.getUniformLocation(this.xa,this.ya.Z()),!1,new Float32Array(a.s()));this.b.uniformMatrix4fv(this.b.getUniformLocation(this.xa,this.ya.view()),!1,new Float32Array(b.s()));var a=this.Ra.Aa(),b=a.length,c;for(c=0;c<b;++c){var d=a[c];if(d){var e=d.id(),f=this.Ya.get(e),h=this.La.get(e),
e=this.Ua.get(e);this.b.bindBuffer(this.b.ARRAY_BUFFER,f.fa);this.b.vertexAttribPointer(this.ab,f.ga,this.b.FLOAT,!1,0,0);this.b.bindBuffer(this.b.ARRAY_BUFFER,h.fa);this.b.vertexAttribPointer(this.Za,h.ga,this.b.FLOAT,!1,0,0);this.b.bindBuffer(this.b.ARRAY_BUFFER,e.fa);this.b.vertexAttribPointer(this.$a,e.ga,this.b.FLOAT,!1,0,0);h=-1;if(d.type()==zc)h=this.b.TRIANGLES;else if(d.type()==Ac)h=this.b.LINES;this.b.drawArrays(h,0,f.Pa)}else g(new H("Fatal: Could not retrieve object for (re-)drawing!"))}};
v("X.renderer",$);v("X.renderer.prototype.dimension",$.prototype.Vb);v("X.renderer.prototype.width",$.prototype.width);v("X.renderer.prototype.setWidth",$.prototype.fc);v("X.renderer.prototype.height",$.prototype.height);v("X.renderer.prototype.setHeight",$.prototype.ec);v("X.renderer.prototype.backgroundColor",$.prototype.backgroundColor);v("X.renderer.prototype.setBackgroundColor",$.prototype.Fb);v("X.renderer.prototype.canvas",$.prototype.canvas);v("X.renderer.prototype.container",$.prototype.gb);
v("X.renderer.prototype.setContainer",$.prototype.Gb);v("X.renderer.prototype.setContainerById",$.prototype.ba);v("X.renderer.prototype.camera",$.prototype.Rb);v("X.renderer.prototype.interactor",$.prototype.Zb);v("X.renderer.prototype.init",$.prototype.t);v("X.renderer.prototype.addShaders",$.prototype.eb);v("X.renderer.prototype.addObject",$.prototype.n);v("X.renderer.prototype.render",$.prototype.L);v("X.renderer.RenderEvent",yc);function Ec(a,b){$.call(this,a,b);this.i="renderer2D";this.ua=2}w(Ec,$);v("X.renderer2D",Ec);function Hc(a,b,c,d,e){(!r(a)||!(a instanceof R))&&g(new H("Fatal: Invalid center for the cuboid!"));(!t(b)||!t(c)||!t(d))&&g(new H("Fatal: Wrong edge lengths for the cuboid!"));Z.call(this,e);this.i="cuboid";this.q=a;this.T=b;this.U=c;this.V=d;this.a=1;this.sa=this.ra=this.qa=this.pa=this.oa=this.na=l;Ic(this)}w(Hc,Z);
function Jc(a){var b=new K(1,0,0),c=new K(0,1,0),d=new K(0,0,1),e=new K(1,1,0),f=new K(1,0,1),h=new K(0,1,1);(!r(b)||!(b instanceof K))&&g(new H("Fatal: Wrong color for side A!"));(!r(c)||!(c instanceof K))&&g(new H("Fatal: Wrong color for side B!"));(!r(d)||!(d instanceof K))&&g(new H("Fatal: Wrong color for side C!"));(!r(e)||!(e instanceof K))&&g(new H("Fatal: Wrong color for side D!"));(!r(f)||!(f instanceof K))&&g(new H("Fatal: Wrong color for side E!"));(!r(h)||!(h instanceof K))&&g(new H("Fatal: Wrong color for side F!"));
a.na=b;a.oa=c;a.pa=d;a.qa=e;a.ra=f;a.sa=h;Ic(a)}Hc.prototype.Hb=function(a){t(a)||g(new H("Fatal: Wrong spacing value!"));this.a=a;Ic(this)};
function Ic(a){a.d.clear();a.h.clear();var b=new R(a.q.x-a.T,a.q.y+a.U,a.q.c+a.V),c=new R(a.q.x+a.T,a.q.y+a.U,a.q.c+a.V),d=new R(a.q.x-a.T,a.q.y-a.U,a.q.c+a.V),e=new R(a.q.x-a.T,a.q.y+a.U,a.q.c-a.V),f=2*a.T/a.a,h=2*a.U/a.a,o=2*a.V/a.a,k,j=0;for(k=0;k<f;++k)for(j=0;j<h;++j)if(a.d.add([e.x+k*a.a,e.y-j*a.a,e.c]),a.d.add([e.x+k*a.a+1,e.y-j*a.a,e.c]),a.d.add([e.x+k*a.a,e.y-j*a.a-1,e.c]),a.d.add([e.x+k*a.a+1,e.y-j*a.a,e.c]),a.d.add([e.x+k*a.a,e.y-j*a.a-1,e.c]),a.d.add([e.x+k*a.a+1,e.y-j*a.a-1,e.c]),a.sa){var I;
for(I=0;I<6;++I)a.h.add(a.sa)}for(k=0;k<f;++k)for(j=0;j<o;++j)if(a.d.add([b.x+k*a.a,b.y,b.c-j*a.a]),a.d.add([b.x+k*a.a+1,b.y,b.c-j*a.a]),a.d.add([b.x+k*a.a,b.y,b.c-j*a.a-1]),a.d.add([b.x+k*a.a+1,b.y,b.c-j*a.a]),a.d.add([b.x+k*a.a,b.y,b.c-j*a.a-1]),a.d.add([b.x+k*a.a+1,b.y,b.c-j*a.a-1]),a.oa)for(e=0;e<6;++e)a.h.add(a.oa);for(k=0;k<h;++k)for(j=0;j<o;++j)if(a.d.add([c.x,c.y-k*a.a,c.c-j*a.a]),a.d.add([c.x,c.y-k*a.a-1,c.c-j*a.a]),a.d.add([c.x,c.y-k*a.a,c.c-j*a.a-1]),a.d.add([c.x,c.y-k*a.a-1,c.c-j*a.a]),
a.d.add([c.x,c.y-k*a.a,c.c-j*a.a-1]),a.d.add([c.x,c.y-k*a.a-1,c.c-j*a.a-1]),a.pa)for(e=0;e<6;++e)a.h.add(a.pa);for(k=0;k<f;++k)for(j=0;j<o;++j)if(a.d.add([d.x+k*a.a,d.y,d.c-j*a.a]),a.d.add([d.x+k*a.a+1,d.y,d.c-j*a.a]),a.d.add([d.x+k*a.a,d.y,d.c-j*a.a-1]),a.d.add([d.x+k*a.a+1,d.y,d.c-j*a.a]),a.d.add([d.x+k*a.a,d.y,d.c-j*a.a-1]),a.d.add([d.x+k*a.a+1,d.y,d.c-j*a.a-1]),a.qa)for(c=0;c<6;++c)a.h.add(a.qa);for(k=0;k<h;++k)for(j=0;j<o;++j)if(a.d.add([b.x,b.y-k*a.a,b.c-j*a.a]),a.d.add([b.x,b.y-k*a.a-1,b.c-
j*a.a]),a.d.add([b.x,b.y-k*a.a,b.c-j*a.a-1]),a.d.add([b.x,b.y-k*a.a-1,b.c-j*a.a]),a.d.add([b.x,b.y-k*a.a,b.c-j*a.a-1]),a.d.add([b.x,b.y-k*a.a-1,b.c-j*a.a-1]),a.ra)for(d=0;d<6;++d)a.h.add(a.ra);for(k=0;k<f;++k)for(j=0;j<h;++j)if(a.d.add([b.x+k*a.a,b.y-j*a.a,b.c]),a.d.add([b.x+k*a.a+1,b.y-j*a.a,b.c]),a.d.add([b.x+k*a.a,b.y-j*a.a-1,b.c]),a.d.add([b.x+k*a.a+1,b.y-j*a.a,b.c]),a.d.add([b.x+k*a.a,b.y-j*a.a-1,b.c]),a.d.add([b.x+k*a.a+1,b.y-j*a.a-1,b.c]),a.na)for(o=0;o<6;++o)a.h.add(a.na)}v("X.cuboid",Hc);
v("X.cuboid.prototype.setSpacing",Hc.prototype.Hb);function Kc(a,b,c){Hc.call(this,a,b,b,b,c);this.i="cube"}w(Kc,Hc);v("X.cube",Kc);function Fc(a,b){$.call(this,a,b);this.i="renderer3D";this.ua=3}w(Fc,$);v("X.renderer3D",Fc);var Lc={dc:function(){var a=new L;a.N("Starting sampleApp.init..");try{var b=new Ec(300,300);b.ba("sliceView1");b.t();var c=new Ec(300,300);c.ba("sliceView2");c.t();var d=new Ec(300,300);d.ba("sliceView3");d.t();var e=new Fc(912,400);e.ba("threeDView");e.Fb("#b3b3e7");e.t();var f=new Z;f.d.add([2,2,0]);f.d.add([3,3,0]);f.d.add([1,2.5,0]);f.aa(new K(1,0,0));f.h.add(new K(1,1,1));f.h.add(new K(1,1,1));f.h.add(new K(1,1,1));var h=new Z(Ac);h.d.add([20,20,0]);h.d.add([30,30,0]);h.d.add([10,20.5,0]);h.d.add([10,
40.5,0]);h.h.add(new K(1,1,1));h.h.add(new K(1,0,0));h.h.add(new K(0,0,1));h.h.add(new K(0,0,1));h.ma(0.5);var o=new Z;o.d.add([-40,-40,0]);o.d.add([-50,-50,0]);o.d.add([-30,-30,0]);o.d.add([10,20.5,0]);var k=new K(0,1,0),j=new Z;j.d.add([-30,40,0]);j.d.add([-50,30,0]);j.d.add([-30,30,0]);j.d.add([-10,20,0]);j.aa(k);j.ma(0.5);var I=new K(0,1,0),u=new Z;u.d.add([-30,40,-10]);u.d.add([-50,30,-10]);u.d.add([-20,10,-10]);u.d.add([-10,10,-10]);u.aa(I);u.ma(0.1);var C=new Hc(new R(10,10,10),5,10,20);Jc(C);
C.Hb(2);var J=new Kc(new R(-10,-10,-10),5);J.aa(new K(0,0,1));var gc=new Kc(new R(0,0,0),3);Jc(gc);b.n(f);c.n(f);d.n(f);e.n(f);e.n(h);e.n(o);e.n(j);e.n(u);e.n(C);e.n(J);e.n(gc);b.L();c.L();d.L();e.L();a.N(b.print());a.N(c.print());a.N(d.print());a.N(e.print());var Mc=function(a){var a=a.target.result.split("\n"),b=new Z,c;for(c=0;c<a.length;c++){var d=a[c].split(" ");d[3]=="vertex"&&b.d.add([d[4],d[5],d[6]])}e.n(b);e.L()},hc=document.getElementById("threeDView");hc.addEventListener("dragover",function(a){a.stopPropagation();
a.preventDefault()},!1);hc.addEventListener("drop",function(a){a.stopPropagation();a.preventDefault();var a=a.dataTransfer.files,b,c=0;for(b=0;c=a[b];b++){var d=new FileReader;d.onloadend=Mc;d.readAsText(c)}},!1)}catch(ic){ic instanceof H&&a.kb(ic.print())}}};v("sampleApp",Lc);v("sampleApp.run",Lc.dc);
