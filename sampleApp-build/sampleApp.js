function g(a){throw a;}var i=void 0,j=null;function k(a){return function(){return this[a]}}var l,n=this;function aa(){}
function ba(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(c=="[object Window]")return"object";if(c=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(c=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(b=="function"&&typeof a.call=="undefined")return"object";return b}function o(a){return a!==i}function p(a){return a!=j}function ca(a){return ba(a)=="array"}function da(a){var b=ba(a);return b=="array"||b=="object"&&typeof a.length=="number"}function s(a){return typeof a=="string"}function u(a){return typeof a=="number"}function ea(a){return ba(a)=="function"}function fa(a){a=ba(a);return a=="object"||a=="array"||a=="function"}function ga(a){return a[ha]||(a[ha]=++ia)}
var ha="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),ia=0;function v(a,b){var c=a.split("."),d=n;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)!c.length&&o(b)?d[f]=b:d=d[f]?d[f]:d[f]={}}function w(a,b){function c(){}c.prototype=b.prototype;a.N=b.prototype;a.prototype=new c};var ja=0;function ka(a){if(!la.test(a))return a;a.indexOf("&")!=-1&&(a=a.replace(ma,"&amp;"));a.indexOf("<")!=-1&&(a=a.replace(na,"&lt;"));a.indexOf(">")!=-1&&(a=a.replace(oa,"&gt;"));a.indexOf('"')!=-1&&(a=a.replace(pa,"&quot;"));return a}var ma=/&/g,na=/</g,oa=/>/g,pa=/\"/g,la=/[&<>\"]/;
function qa(a,b){for(var c=0,d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=String(b).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(d.length,f.length),h=0;c==0&&h<e;h++){var m=d[h]||"",t=f[h]||"",q=RegExp("(\\d*)(\\D*)","g"),U=RegExp("(\\d*)(\\D*)","g");do{var r=q.exec(m)||["","",""],G=U.exec(t)||["","",""];if(r[0].length==0&&G[0].length==0)break;c=ra(r[1].length==0?0:parseInt(r[1],10),G[1].length==0?0:parseInt(G[1],10))||ra(r[2].length==0,G[2].length==0)||ra(r[2],G[2])}while(c==
0)}return c}function ra(a,b){if(a<b)return-1;else if(a>b)return 1;return 0};var sa,ta,ua,va,wa;function xa(){return n.navigator?n.navigator.userAgent:j}va=ua=ta=sa=!1;var ya;if(ya=xa()){var za=n.navigator;sa=ya.indexOf("Opera")==0;ta=!sa&&ya.indexOf("MSIE")!=-1;ua=!sa&&ya.indexOf("WebKit")!=-1;va=!sa&&!ua&&za.product=="Gecko"}var Aa=sa,x=ta,Ba=va,Ca=ua,Da,Ea=n.navigator;Da=Ea&&Ea.platform||"";wa=Da.indexOf("Mac")!=-1;var Fa=Da.indexOf("Win")!=-1,Ga;
a:{var Ha="",Ia;if(Aa&&n.opera)var Ja=n.opera.version,Ha=typeof Ja=="function"?Ja():Ja;else if(Ba?Ia=/rv\:([^\);]+)(\)|;)/:x?Ia=/MSIE\s+([^\);]+)(\)|;)/:Ca&&(Ia=/WebKit\/(\S+)/),Ia)var Ka=Ia.exec(xa()),Ha=Ka?Ka[1]:"";if(x){var La,Ma=n.document;La=Ma?Ma.documentMode:i;if(La>parseFloat(Ha)){Ga=String(La);break a}}Ga=Ha}var Na={};function Oa(a){return Na[a]||(Na[a]=qa(Ga,a)>=0)}var Pa={};function Qa(){return Pa[9]||(Pa[9]=x&&document.documentMode&&document.documentMode>=9)};function Ra(a,b){for(var c in a)b.call(i,a[c],c,a)}var Sa=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];function Ta(a,b){for(var c,d,f=1;f<arguments.length;f++){d=arguments[f];for(c in d)a[c]=d[c];for(var e=0;e<Sa.length;e++)c=Sa[e],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var y=Array.prototype,Ua=y.indexOf?function(a,b,c){return y.indexOf.call(a,b,c)}:function(a,b,c){c=c==j?0:c<0?Math.max(0,a.length+c):c;if(s(a))return!s(b)||b.length!=1?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Va=y.forEach?function(a,b,c){y.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=s(a)?a.split(""):a,e=0;e<d;e++)e in f&&b.call(c,f[e],e,a)};function Wa(a){return y.concat.apply(y,arguments)}
function Xa(a){if(ca(a))return Wa(a);else{for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}}function Ya(a,b,c){return arguments.length<=2?y.slice.call(a,b):y.slice.call(a,b,c)};var Za;!x||Qa();var $a=x&&!Oa("8");function ab(){}ab.prototype.Ya=!1;ab.prototype.F=function(){if(!this.Ya)this.Ya=!0,this.t()};ab.prototype.t=function(){this.Ib&&bb.apply(j,this.Ib)};function bb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];da(d)?bb.apply(j,d):d&&typeof d.F=="function"&&d.F()}};function z(a,b){this.type=a;this.currentTarget=this.target=b}w(z,ab);l=z.prototype;l.t=function(){delete this.type;delete this.target;delete this.currentTarget};l.I=!1;l.V=!0;l.stopPropagation=function(){this.I=!0};l.preventDefault=function(){this.V=!1};var cb=new Function("a","return a");function A(a,b){a&&this.p(a,b)}w(A,z);l=A.prototype;l.target=j;l.relatedTarget=j;l.offsetX=0;l.offsetY=0;l.clientX=0;l.clientY=0;l.screenX=0;l.screenY=0;l.button=0;l.keyCode=0;l.charCode=0;l.ctrlKey=!1;l.altKey=!1;l.shiftKey=!1;l.metaKey=!1;l.Qb=!1;l.G=j;
l.p=function(a,b){var c=this.type=a.type;z.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ba){var f;a:{try{cb(d.nodeName);f=!0;break a}catch(e){}f=!1}f||(d=j)}}else if(c=="mouseover")d=a.fromElement;else if(c=="mouseout")d=a.toElement;this.relatedTarget=d;this.offsetX=a.offsetX!==i?a.offsetX:a.layerX;this.offsetY=a.offsetY!==i?a.offsetY:a.layerY;this.clientX=a.clientX!==i?a.clientX:a.pageX;this.clientY=a.clientY!==i?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||(c=="keypress"?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.Qb=wa?a.metaKey:a.ctrlKey;this.state=a.state;this.G=a;delete this.V;delete this.I};l.stopPropagation=function(){A.N.stopPropagation.call(this);this.G.stopPropagation?this.G.stopPropagation():this.G.cancelBubble=!0};
l.preventDefault=function(){A.N.preventDefault.call(this);var a=this.G;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,$a)try{if(a.ctrlKey||a.keyCode>=112&&a.keyCode<=123)a.keyCode=-1}catch(b){}};l.t=function(){A.N.t.call(this);this.relatedTarget=this.currentTarget=this.target=this.G=j};function db(){}var eb=0;l=db.prototype;l.key=0;l.M=!1;l.Ua=!1;l.p=function(a,b,c,d,f,e){ea(a)?this.ab=!0:a&&a.handleEvent&&ea(a.handleEvent)?this.ab=!1:g(Error("Invalid listener argument"));this.T=a;this.tb=b;this.src=c;this.type=d;this.capture=!!f;this.qa=e;this.Ua=!1;this.key=++eb;this.M=!1};l.handleEvent=function(a){return this.ab?this.T.call(this.qa||this.src,a):this.T.handleEvent.call(this.T,a)};var fb,gb=(fb="ScriptEngine"in n&&n.ScriptEngine()=="JScript")?n.ScriptEngineMajorVersion()+"."+n.ScriptEngineMinorVersion()+"."+n.ScriptEngineBuildVersion():"0";function B(a,b){this.cb=b;this.H=[];a>this.cb&&g(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.H.push(this.v?this.v():{})}w(B,ab);B.prototype.v=j;B.prototype.Xa=j;B.prototype.getObject=function(){return this.H.length?this.H.pop():this.v?this.v():{}};function hb(a,b){a.H.length<a.cb?a.H.push(b):ib(a,b)}function ib(a,b){if(a.Xa)a.Xa(b);else if(fa(b))if(ea(b.F))b.F();else for(var c in b)delete b[c]}
B.prototype.t=function(){B.N.t.call(this);for(var a=this.H;a.length;)ib(this,a.pop());delete this.H};var jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb;
(function(){function a(){return{d:0,q:0}}function b(){return[]}function c(){function a(b){b=h.call(a.src,a.key,b);if(!b)return b}return a}function d(){return new db}function f(){return new A}var e=fb&&!(qa(gb,"5.7")>=0),h;ob=function(a){h=a};if(e){jb=function(){return m.getObject()};kb=function(a){hb(m,a)};lb=function(){return t.getObject()};mb=function(a){hb(t,a)};nb=function(){return q.getObject()};pb=function(){hb(q,c())};qb=function(){return U.getObject()};rb=function(a){hb(U,a)};sb=function(){return r.getObject()};
tb=function(a){hb(r,a)};var m=new B(0,600);m.v=a;var t=new B(0,600);t.v=b;var q=new B(0,600);q.v=c;var U=new B(0,600);U.v=d;var r=new B(0,600);r.v=f}else jb=a,kb=aa,lb=b,mb=aa,nb=c,pb=aa,qb=d,rb=aa,sb=f,tb=aa})();var ub={},C={},D={},vb={};
function E(a,b,c,d,f){if(b)if(ca(b)){for(var e=0;e<b.length;e++)E(a,b[e],c,d,f);return j}else{var d=!!d,h=C;b in h||(h[b]=jb());h=h[b];d in h||(h[d]=jb(),h.d++);var h=h[d],m=ga(a),t;h.q++;if(h[m]){t=h[m];for(e=0;e<t.length;e++)if(h=t[e],h.T==c&&h.qa==f){if(h.M)break;return t[e].key}}else t=h[m]=lb(),h.d++;e=nb();e.src=a;h=qb();h.p(c,e,a,b,d,f);c=h.key;e.key=c;t.push(h);ub[c]=h;D[m]||(D[m]=lb());D[m].push(h);a.addEventListener?(a==n||!a.Wa)&&a.addEventListener(b,e,d):a.attachEvent(b in vb?vb[b]:vb[b]=
"on"+b,e);return c}else g(Error("Invalid event type"))}function wb(a,b,c,d,f){if(ca(b))for(var e=0;e<b.length;e++)wb(a,b[e],c,d,f);else{d=!!d;a:{e=C;if(b in e&&(e=e[b],d in e&&(e=e[d],a=ga(a),e[a]))){a=e[a];break a}a=j}if(a)for(e=0;e<a.length;e++)if(a[e].T==c&&a[e].capture==d&&a[e].qa==f){xb(a[e].key);break}}}
function xb(a){if(ub[a]){var b=ub[a];if(!b.M){var c=b.src,d=b.type,f=b.tb,e=b.capture;c.removeEventListener?(c==n||!c.Wa)&&c.removeEventListener(d,f,e):c.detachEvent&&c.detachEvent(d in vb?vb[d]:vb[d]="on"+d,f);c=ga(c);f=C[d][e][c];if(D[c]){var h=D[c],m=Ua(h,b);m>=0&&y.splice.call(h,m,1);h.length==0&&delete D[c]}b.M=!0;f.gb=!0;yb(d,e,c,f);delete ub[a]}}}
function yb(a,b,c,d){if(!d.ea&&d.gb){for(var f=0,e=0;f<d.length;f++)if(d[f].M){var h=d[f].tb;h.src=j;pb(h);rb(d[f])}else f!=e&&(d[e]=d[f]),e++;d.length=e;d.gb=!1;e==0&&(mb(d),delete C[a][b][c],C[a][b].d--,C[a][b].d==0&&(kb(C[a][b]),delete C[a][b],C[a].d--),C[a].d==0&&(kb(C[a]),delete C[a]))}}
function zb(a){var b,c=0,d=b==j;b=!!b;if(a==j)Ra(D,function(a){for(var e=a.length-1;e>=0;e--){var f=a[e];if(d||b==f.capture)xb(f.key),c++}});else if(a=ga(a),D[a])for(var a=D[a],f=a.length-1;f>=0;f--){var e=a[f];if(d||b==e.capture)xb(e.key),c++}}function Ab(a,b,c,d,f){var e=1,b=ga(b);if(a[b]){a.q--;a=a[b];a.ea?a.ea++:a.ea=1;try{for(var h=a.length,m=0;m<h;m++){var t=a[m];t&&!t.M&&(e&=Bb(t,f)!==!1)}}finally{a.ea--,yb(c,d,b,a)}}return Boolean(e)}
function Bb(a,b){var c=a.handleEvent(b);a.Ua&&xb(a.key);return c}
ob(function(a,b){if(!ub[a])return!0;var c=ub[a],d=c.type,f=C;if(!(d in f))return!0;var f=f[d],e,h;Za===i&&(Za=x&&!n.addEventListener);if(Za){var m;if(!(m=b))a:{m="window.event".split(".");for(var t=n;e=m.shift();)if(p(t[e]))t=t[e];else{m=j;break a}m=t}e=m;m=!0 in f;t=!1 in f;if(m){if(e.keyCode<0||e.returnValue!=i)return!0;a:{var q=!1;if(e.keyCode==0)try{e.keyCode=-1;break a}catch(U){q=!0}if(q||e.returnValue==i)e.returnValue=!0}}q=sb();q.p(e,this);e=!0;try{if(m){for(var r=lb(),G=q.currentTarget;G;G=
G.parentNode)r.push(G);h=f[!0];h.q=h.d;for(var H=r.length-1;!q.I&&H>=0&&h.q;H--)q.currentTarget=r[H],e&=Ab(h,r[H],d,!0,q);if(t){h=f[!1];h.q=h.d;for(H=0;!q.I&&H<r.length&&h.q;H++)q.currentTarget=r[H],e&=Ab(h,r[H],d,!1,q)}}else e=Bb(c,q)}finally{if(r)r.length=0,mb(r);q.F();tb(q)}return e}d=new A(b,this);try{e=Bb(c,d)}finally{d.F()}return e});var Cb=0;function Db(){}w(Db,ab);l=Db.prototype;l.Wa=!0;l.sa=j;l.addEventListener=function(a,b,c,d){E(this,a,b,c,d)};l.removeEventListener=function(a,b,c,d){wb(this,a,b,c,d)};
l.dispatchEvent=function(a){var b=a.type||a,c=C;if(b in c){if(s(a))a=new z(a,this);else if(a instanceof z)a.target=a.target||this;else{var d=a,a=new z(b,this);Ta(a,d)}var d=1,f,c=c[b],b=!0 in c,e;if(b){f=[];for(e=this;e;e=e.sa)f.push(e);e=c[!0];e.q=e.d;for(var h=f.length-1;!a.I&&h>=0&&e.q;h--)a.currentTarget=f[h],d&=Ab(e,f[h],a.type,!0,a)&&a.V!=!1}if(!1 in c)if(e=c[!1],e.q=e.d,b)for(h=0;!a.I&&h<f.length&&e.q;h++)a.currentTarget=f[h],d&=Ab(e,f[h],a.type,!1,a)&&a.V!=!1;else for(f=this;!a.I&&f&&e.q;f=
f.sa)a.currentTarget=f,d&=Ab(e,f,a.type,!1,a)&&a.V!=!1;a=Boolean(d)}else a=!0;return a};l.t=function(){Db.N.t.call(this);zb(this);this.sa=j};function F(){this.h="base";this.Bb="X"+ja++}w(F,Db);F.prototype.className=k("h");F.prototype.id=k("Bb");F.prototype.print=function(){var a=Object.keys(this),b="",c="<unknown>",d=0;for(d in a){var f="this."+a[d],e=eval(f);f=="this._className"?c=e:b+=f+": "+e+"\n"}a="== X."+c+" ==\n";a+=b;return a};v("X.base",F);v("X.base.prototype.className",F.prototype.className);v("X.base.prototype.id",F.prototype.id);v("X.base.prototype.print",F.prototype.print);function I(a){var b="Unknown error!";p(a)&&(b=a);F.call(this);this.h="exception";this.Xb=b;this.Yb=Error().stack}w(I,F);v("X.exception",I);function J(a,b,c){(!u(a)||a<0||a>1||!u(b)||b<0||b>1||!u(c)||c<0||c>1)&&g(new I("Fatal: Wrong RGB values - must be in range 0..1!"));F.call(this);this.h="color";this.Ma=a;this.Ba=b;this.xa=c}w(J,F);J.prototype.red=k("Ma");J.prototype.green=k("Ba");J.prototype.blue=k("xa");J.prototype.o=function(){var a=Array(3);a[0]=this.Ma;a[1]=this.Ba;a[2]=this.xa;return a};v("X.color",J);v("X.color.prototype.red",J.prototype.red);v("X.color.prototype.green",J.prototype.green);v("X.color.prototype.blue",J.prototype.blue);
v("X.color.prototype.flatten",J.prototype.o);function Eb(a,b){var c;c=(c=a.className)&&typeof c.split=="function"?c.split(/\s+/):[];var d=Ya(arguments,1),f;f=c;for(var e=0,h=0;h<d.length;h++)Ua(f,d[h])>=0||(f.push(d[h]),e++);f=e==d.length;a.className=c.join(" ");return f};function Fb(a,b){this.width=a;this.height=b}function Gb(a,b){return a==b?!0:!a||!b?!1:a.width==b.width&&a.height==b.height}Fb.prototype.B=function(){return new Fb(this.width,this.height)};Fb.prototype.toString=function(){return"("+this.width+" x "+this.height+")"};Fb.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};Fb.prototype.scale=function(a){this.width*=a;this.height*=a;return this};var Hb=!x||Qa();!Ba&&!x||x&&Qa()||Ba&&Oa("1.9.1");x&&Oa("9");function Ib(a,b){this.x=o(a)?a:0;this.y=o(b)?b:0}Ib.prototype.B=function(){return new Ib(this.x,this.y)};Ib.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function Jb(a,b){Ra(b,function(b,d){d=="style"?a.style.cssText=b:d=="class"?a.className=b:d=="for"?a.htmlFor=b:d in Kb?a.setAttribute(Kb[d],b):d.lastIndexOf("aria-",0)==0?a.setAttribute(d,b):a[d]=b})}var Kb={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};
function Lb(a,b,c){var d=arguments,f=document,e=d[0],h=d[1];if(!Hb&&h&&(h.name||h.type)){e=["<",e];h.name&&e.push(' name="',ka(h.name),'"');if(h.type){e.push(' type="',ka(h.type),'"');var m={};Ta(m,h);h=m;delete h.type}e.push(">");e=e.join("")}e=f.createElement(e);if(h)s(h)?e.className=h:ca(h)?Eb.apply(j,[e].concat(h)):Jb(e,h);d.length>2&&Mb(f,e,d);return e}
function Mb(a,b,c){function d(c){c&&b.appendChild(s(c)?a.createTextNode(c):c)}for(var f=2;f<c.length;f++){var e=c[f];da(e)&&!(fa(e)&&e.nodeType>0)?Va(Nb(e)?Xa(e):e,d):d(e)}}function Nb(a){if(a&&typeof a.length=="number")if(fa(a))return typeof a.item=="function"||typeof a.item=="string";else if(ea(a))return typeof a.item=="function";return!1};function K(){F.call(this);this.h="console";this.ia=j}w(K,F);K.prototype.oa=function(){if(!this.ia){var a;(a=(a=document)?a.parentWindow||a.defaultView:window)||g(new I("Fatal: Could not get the window!"));(a=a.console)||g(new I("Fatal: The console is not available!"));this.ia=a}return this.ia};K.prototype.L=function(a){var b=this.oa();b&&b.log(a)};K.prototype.Za=function(a){var b=this.oa();b&&b.error(a)};v("X.console",K);v("X.console.prototype.console_",K.prototype.oa);
v("X.console.prototype.out",K.prototype.L);v("X.console.prototype.err",K.prototype.Za);function L(){F.call(this);this.h="shader";var a=this.A="";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexColor;\n";a+="attribute float vertexOpacity;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="varying lowp vec4 fragmentColor;\n";a+="\n";a+="void main(void) {\n";a+="  gl_Position = perspective * view * vec4(vertexPosition, 1.0);\n";a+="  fragmentColor = vec4(vertexColor,vertexOpacity);\n";a+="}\n";this.A=a;a=this.ka="";a+="varying lowp vec4 fragmentColor;\n";
a+="\n";a+="void main(void) {\n";a+="  gl_FragColor = fragmentColor;\n";a+="}\n";this.ka=a;this.La="vertexPosition";this.za="vertexColor";this.Ia="vertexOpacity";this.Ra="view";this.Ka="perspective"}w(L,F);l=L.prototype;l.Vb=k("A");l.Lb=k("ka");l.position=k("La");l.color=k("za");l.view=k("Ra");l.U=k("Ka");l.opacity=k("Ia");
l.wb=function(){var a=31337,a=this.A.search(this.La);a==-1&&g(new I("Fatal: Could not validate shader! The positionAttribute was bogus."));a=this.A.search(this.za);a==-1&&g(new I("Fatal: Could not validate shader! The colorAttribute was bogus."));a=this.A.search(this.Ia);a==-1&&g(new I("Fatal: Could not validate shader! The opacityAttribute was bogus."));a=this.A.search(this.Ka);a==-1&&g(new I("Fatal: Could not validate shader! The perspectiveUniform was bogus."));a=this.A.search(this.Ra);a==-1&&
g(new I("Fatal: Could not validate shader! The viewUniform was bogus."));return!0};v("X.shaders",L);v("X.shaders.prototype.vertex",L.prototype.Vb);v("X.shaders.prototype.fragment",L.prototype.Lb);v("X.shaders.prototype.position",L.prototype.position);v("X.shaders.prototype.color",L.prototype.color);v("X.shaders.prototype.view",L.prototype.view);v("X.shaders.prototype.perspective",L.prototype.U);v("X.shaders.prototype.opacity",L.prototype.opacity);v("X.shaders.prototype.validate",L.prototype.wb);function M(a,b){this.x=a;this.y=b}w(M,Ib);l=M.prototype;l.B=function(){return new M(this.x,this.y)};l.fa=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};l.scale=function(a){this.x*=a;this.y*=a;return this};l.$a=function(){this.x=-this.x;this.y=-this.y;return this};l.normalize=function(){return this.scale(1/this.fa())};l.add=function(a){this.x+=a.x;this.y+=a.y;return this};l.ua=function(a){this.x-=a.x;this.y-=a.y;return this};function N(a,b){if(a instanceof N)this.g=a.va();else{var c;if(c=da(a))a:{for(var d=c=0;d<a.length;d++){if(!da(a[d])||c>0&&a[d].length!=c){c=!1;break a}for(var f=0;f<a[d].length;f++)if(!u(a[d][f])){c=!1;break a}if(c==0)c=a[d].length}c=c!=0}c?this.g=Xa(a):a instanceof Fb?this.g=Ob(a.height,a.width):u(a)&&u(b)&&a>0&&b>0?this.g=Ob(a,b):g(Error("Invalid argument(s) for Matrix contructor"))}this.e=new Fb(this.g[0].length,this.g.length)}
function Pb(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new N(b)}function Qb(a,b,c){for(var d=0;d<a.e.height;d++)for(var f=0;f<a.e.width;f++)b.call(c,a.g[d][f],d,f,a)}function Rb(a,b){var c=new N(a.e);Qb(a,function(d,f,e){c.g[f][e]=b.call(i,d,f,e,a)});return c}function Ob(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var f=0;f<b;f++)c[d][f]=0}return c}l=N.prototype;
l.add=function(a){Gb(this.e,a.e)||g(Error("Matrix summation is only supported on arrays of equal size"));return Rb(this,function(b,c,d){return b+a.g[c][d]})};function O(a,b,c,d){Sb(a,b,c)||g(Error("Index out of bounds when setting matrix value, ("+b+","+c+") in size ("+a.e.height+","+a.e.width+")"));a.g[b][c]=d}
l.multiply=function(a){if(a instanceof N)return this.e.width!=a.e.height&&g(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),Tb(this,a);else if(u(a))return Ub(this,a);else g(Error("A matrix can only be multiplied by a number or another matrix."))};l.ua=function(a){Gb(this.e,a.e)||g(Error("Matrix subtraction is only supported on arrays of equal size."));return Rb(this,function(b,c,d){return b-a.g[c][d]})};l.va=k("g");
l.toString=function(){var a=0;Qb(this,function(b){b=String(b).length;b>a&&(a=b)});var b=[];Va(this.g,function(c){b.push("[ ");Va(c,function(c){c=String(c);b.push(Array(a-c.length+1).join(" ")+c+" ")});b.push("]\n")});return b.join("")};function Sb(a,b,c){return b>=0&&b<a.e.height&&c>=0&&c<a.e.width}function Tb(a,b){var c=new N(a.e.height,b.e.width);Qb(c,function(a,f,e){for(var h=a=0;h<this.e.width;h++)a+=(!Sb(this,f,h)?0:this.g[f][h])*(!Sb(b,h,e)?0:b.g[h][e]);O(c,f,e,a)},a);return c}
function Ub(a,b){return Rb(a,function(a){return a*b})};function P(a,b,c){this.x=o(a)?a:0;this.y=o(b)?b:0;this.b=o(c)?c:0}P.prototype.B=function(){return new P(this.x,this.y,this.b)};P.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.b+")"};P.prototype.va=function(){return[this.x,this.y,this.b]};function Q(a,b,c){this.x=a;this.y=b;this.b=c}w(Q,P);l=Q.prototype;l.B=function(){return new Q(this.x,this.y,this.b)};l.fa=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};l.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};l.$a=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};l.normalize=function(){return this.scale(1/this.fa())};l.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
l.ua=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};function Vb(a,b){return new Q(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};N.prototype.o=function(){var a=[],b=this.e;if(b.height==0||b.width==0)return[];var c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(!Sb(this,c,d)?j:this.g[c][d]);return a};N.prototype.translate=function(a){this.e.width!=this.e.height&&g(new I("Fatal: Can not translate non-square matrix!"));var b=this.e,c=Pb(b.height);a instanceof M&&b.height==3?(O(c,0,2,a.x),O(c,1,2,a.y)):a instanceof Q&&b.height==4?(O(c,0,3,a.x),O(c,1,3,a.y),O(c,2,3,a.b)):g(new I("Fatal: Translation failed!"));return this.multiply(c)};function Wb(a){this.S=a||Xb}function Xb(a,b){if(String(a)<String(b))return-1;else if(String(a)>String(b))return 1;return 0}l=Wb.prototype;l.m=j;l.S=j;l.z=j;l.w=j;l.d=0;
l.add=function(a){if(this.m==j)return this.w=this.z=this.m=new Yb(a),this.d=1,!0;var b=!1;Zb(this,function(c){var d=j;if(this.S(c.value,a)>0){if(d=c.left,c.left==j){var f=new Yb(a,c);c.left=f;if(c==this.z)this.z=f;b=!0;$b(this,c)}}else if(this.S(c.value,a)<0&&(d=c.right,c.right==j)){f=new Yb(a,c);c.right=f;if(c==this.w)this.w=f;b=!0;$b(this,c)}return d});b&&(this.d+=1);return b};
l.remove=function(a){var b=j;Zb(this,function(c){var d=j;if(this.S(c.value,a)>0)d=c.left;else if(this.S(c.value,a)<0)d=c.right;else if(b=c.value,c.left!=j||c.right!=j){var f=j,e;if(c.left!=j){e=ac(this,c.left);if(e!=c.left){if(e.parent.right=e.left)e.left.parent=e.parent;e.left=c.left;e.left.parent=e;f=e.parent}e.parent=c.parent;e.right=c.right;if(e.right)e.right.parent=e;if(c==this.w)this.w=e}else{e=bc(this,c.right);if(e!=c.right){if(e.parent.left=e.right)e.right.parent=e.parent;e.right=c.right;
e.right.parent=e;f=e.parent}e.parent=c.parent;e.left=c.left;if(e.left)e.left.parent=e;if(c==this.z)this.z=e}dc(c)?c.parent.left=e:ec(c)?c.parent.right=e:this.m=e;$b(this,f?f:e)}else if(dc(c)){this.cc=1;c.parent.left=j;if(c==this.z)this.z=c.parent;$b(this,c.parent)}else if(ec(c)){c.parent.right=j;if(c==this.w)this.w=c.parent;$b(this,c.parent)}else this.clear();return d});if(b)this.d=this.m?this.d-1:0;return b};l.clear=function(){this.w=this.z=this.m=j;this.d=0};
l.pa=function(){var a=[];fc(this,function(b){a.push(b)});return a};function fc(a,b){if(a.m){var c,d=c=bc(a);for(c=c.left?c.left:c;d!=j;)if(d.left!=j&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var f=d,d=d.right!=j&&d.right!=c?d.right:d.parent;c=f}}}function Zb(a,b,c){for(c=c?c:a.m;c&&c!=j;)c=b.call(a,c)}
function $b(a,b){Zb(a,function(a){var b=a.left?a.left.height:0,f=a.right?a.right.height:0;b-f>1?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&gc(this,a.left),hc(this,a)):f-b>1&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&hc(this,a.right),gc(this,a));b=a.left?a.left.height:0;f=a.right?a.right.height:0;a.height=Math.max(b,f)+1;return a.parent},b)}
function gc(a,b){dc(b)?(b.parent.left=b.right,b.right.parent=b.parent):ec(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.m=b.right,a.m.parent=j);var c=b.right;b.right=b.right.left;if(b.right!=j)b.right.parent=b;c.left=b;b.parent=c}function hc(a,b){dc(b)?(b.parent.left=b.left,b.left.parent=b.parent):ec(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.m=b.left,a.m.parent=j);var c=b.left;b.left=b.left.right;if(b.left!=j)b.left.parent=b;c.right=b;b.parent=c}
function bc(a,b){if(!b)return a.z;var c=b;Zb(a,function(a){var b=j;if(a.left)b=c=a.left;return b},b);return c}function ac(a,b){if(!b)return a.w;var c=b;Zb(a,function(a){var b=j;if(a.right)b=c=a.right;return b},b);return c}function Yb(a,b){this.value=a;this.parent=b?b:j}Yb.prototype.left=j;Yb.prototype.right=j;Yb.prototype.height=1;function ec(a){return!!a.parent&&a.parent.right==a}function dc(a){return!!a.parent&&a.parent.left==a};function R(a,b,c){p(a)||g(new I("Fatal: Invalid GL Buffer!"));p(b)||g(new I("Fatal: Invalid number of items!"));p(c)||g(new I("Fatal: Invalid item size!"));F.call(this);this.h="buffer";this.$=a;this.Ea=b;this.aa=c}w(R,F);R.prototype.Mb=k("$");R.prototype.Ob=k("Ea");R.prototype.Pb=k("aa");v("X.buffer",R);v("X.buffer.prototype.glBuffer",R.prototype.Mb);v("X.buffer.prototype.itemCount",R.prototype.Ob);v("X.buffer.prototype.itemSize",R.prototype.Pb);var ic="StopIteration"in n?n.StopIteration:Error("StopIteration");function jc(){}jc.prototype.next=function(){g(ic)};jc.prototype.O=function(){return this};function S(a,b){this.l={};this.f=[];var c=arguments.length;if(c>1){c%2&&g(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){var f;if(a instanceof S)kc(a),f=a.f.concat(),d=a.pa();else{var c=[],e=0;for(f in a)c[e++]=f;f=c;c=[];e=0;for(d in a)c[e++]=a[d];d=c}for(c=0;c<f.length;c++)this.set(f[c],d[c])}}l=S.prototype;l.d=0;l.X=0;l.pa=function(){kc(this);for(var a=[],b=0;b<this.f.length;b++)a.push(this.l[this.f[b]]);return a};
function lc(a,b){return mc(a.l,b)}function nc(a,b){for(var c=0;c<a.f.length;c++){var d=a.f[c];if(mc(a.l,d)&&a.l[d]==b)return!0}return!1}l.clear=function(){this.l={};this.X=this.d=this.f.length=0};l.remove=function(a){return mc(this.l,a)?(delete this.l[a],this.d--,this.X++,this.f.length>2*this.d&&kc(this),!0):!1};
function kc(a){if(a.d!=a.f.length){for(var b=0,c=0;b<a.f.length;){var d=a.f[b];mc(a.l,d)&&(a.f[c++]=d);b++}a.f.length=c}if(a.d!=a.f.length){for(var f={},c=b=0;b<a.f.length;)d=a.f[b],mc(f,d)||(a.f[c++]=d,f[d]=1),b++;a.f.length=c}}l.get=function(a,b){return mc(this.l,a)?this.l[a]:b};l.set=function(a,b){mc(this.l,a)||(this.d++,this.f.push(a),this.X++);this.l[a]=b};l.B=function(){return new S(this)};
l.O=function(a){kc(this);var b=0,c=this.f,d=this.l,f=this.X,e=this,h=new jc;h.next=function(){for(;;){f!=e.X&&g(Error("The map has changed since the iterator was created"));b>=c.length&&g(ic);var h=c[b++];return a?h:d[h]}};return h};function mc(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function T(){F.call(this);this.h="colors";this.j=new S;this.D=-1}w(T,F);l=T.prototype;l.add=function(a){(!p(a)||!(a instanceof J))&&g(new I("Fatal: Invalid color."));lc(this.j,++this.D)&&g(new I("Fatal: Could not get unique id."));this.j.set(this.D,a);return this.D};l.get=function(a){(!p(a)||!lc(this.j,a))&&g(new I("Fatal: Invalid id."));return this.j.get(a)};
l.remove=function(a){(!p(a)||!(a instanceof J))&&g(new I("Fatal: Invalid color."));if(!nc(this.j,a))return!1;var b=this.j.O(!0);try{for(;;){var c=b.next();if(this.j.get(c)==a)return this.j.remove(c)}}catch(d){d!=ic&&g(d)}};l.ta=function(a){p(a)||g(new I("Fatal: Invalid id."));return!lc(this.j,a)?!1:this.j.remove(a)};l.count=function(){return this.j.d};l.o=function(){var a=[],b=this.j.O(!0);try{for(;;)var c=this.j.get(b.next()).o(),a=a.concat(c)}catch(d){d!=ic&&g(d)}return a};v("X.colors",T);
v("X.colors.prototype.add",T.prototype.add);v("X.colors.prototype.get",T.prototype.get);v("X.colors.prototype.remove",T.prototype.remove);v("X.colors.prototype.removeById",T.prototype.ta);v("X.colors.prototype.count",T.prototype.count);v("X.colors.prototype.flatten",T.prototype.o);function V(){F.call(this);this.h="points";this.k=new S;this.D=-1}w(V,F);l=V.prototype;l.add=function(a){p(a)||g(new I("Fatal: Invalid point."));ca(a)&&a.length==3&&(a=new P(a[0],a[1],a[2]));a instanceof P||g(new I("Fatal: Invalid point."));lc(this.k,++this.D)&&g(new I("Fatal: Could not get unique id."));this.k.set(this.D,a);return this.D};l.get=function(a){(!p(a)||!lc(this.k,a))&&g(new I("Fatal: Invalid id."));return this.k.get(a)};
l.remove=function(a){a instanceof P||g(new I("Fatal: Invalid point."));if(!nc(this.k,a))return!1;var b=this.k.O(!0);try{for(;;){var c=b.next();if(this.k.get(c)==a)return this.k.remove(c)}}catch(d){d!=ic&&g(d)}};l.ta=function(a){p(a)||g(new I("Fatal: Invalid id."));return!lc(this.k,a)?!1:this.k.remove(a)};l.count=function(){return this.k.d};l.o=function(){var a=[],b=this.k.O(!0);try{for(;;)var c=this.k.get(b.next()).va(),a=a.concat(c)}catch(d){d!=ic&&g(d)}return a};v("X.points",V);
v("X.points.prototype.add",V.prototype.add);v("X.points.prototype.get",V.prototype.get);v("X.points.prototype.remove",V.prototype.remove);v("X.points.prototype.removeById",V.prototype.ta);v("X.points.prototype.count",V.prototype.count);v("X.points.prototype.flatten",V.prototype.o);function oc(a){z.call(this,a)}w(oc,z);v("X.event",oc);v("X.event.uniqueId",function(a){return a+"_"+Cb++});function W(a,b){(!u(a)||!u(b))&&g(new I("Fatal: A camera needs valid width and height values."));F.call(this);this.h="camera";this.Ab=45;this.n=new Q(0,0,100);this.u=new Q(0,0,0);this.Eb=new Q(0,1,0);var c=a/b,d=1*Math.tan(this.Ab*Math.PI/360),f=-d;this.Cb=new N([[2/(d*c-f*c),0,(d*c+f*c)/(d*c-f*c),0],[0,2/(d-f),(d+f)/(d-f),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]]);this.R=pc(this,this.n,this.u)}w(W,F);var qc="pan_"+Cb++,rc="rotate_"+Cb++,sc="zoom_"+Cb++;l=W.prototype;
l.ra=function(a){(!p(a)||!(a instanceof Y))&&g(new I("Fatal: Could not observe the interactor."));E(a,qc,this.pb.bind(this));E(a,rc,this.qb.bind(this));E(a,sc,this.rb.bind(this))};l.rb=function(a){a instanceof tc||g(new I("Fatal: Received no valid zoom event!"));a.la?this.xb(a.Z):this.yb(a.Z)};l.pb=function(a){a instanceof uc||g(new I("Fatal: Received no valid pan event!"));this.sb(a.P)};l.qb=function(a){a instanceof vc||g(new I("Fatal: Received no valid rotate event!"));this.rotate(a.P)};l.U=k("Cb");
l.view=k("R");l.position=k("n");l.sb=function(a){a instanceof M||g(new I("Fatal: Invalid distance vector for pan operation."));this.n.x+=a.x;this.n.y-=a.y;this.u.x+=a.x;this.u.y-=a.y;this.R=pc(this,this.n,this.u);this.dispatchEvent(new wc)};l.rotate=function(a){a instanceof M||g(new I("Fatal: Invalid distance vector for rotate operation."));this.n.x+=a.x;this.n.y-=a.y;this.R=pc(this,this.n,this.u);this.dispatchEvent(new wc)};
l.xb=function(a){var b=30;p(a)&&!a&&(b=1);this.n.b-=b;this.u.b-=b;this.R=pc(this,this.n,this.u);this.dispatchEvent(new wc)};l.yb=function(a){var b=30;p(a)&&!a&&(b=1);this.n.b+=b;this.u.b+=b;this.R=pc(this,this.n,this.u);this.dispatchEvent(new wc)};
function pc(a,b,c){(!(b instanceof Q)||!(c instanceof Q))&&g(new I("Fatal: 3D vectors required for calculating the view."));var d=Pb(4),c=new Q(b.x-c.x,b.y-c.y,b.b-c.b),c=c.normalize(),a=a.Eb.B(),f=Vb(a,c),a=Vb(c,f),f=f.normalize(),a=a.normalize();O(d,0,0,f.x);O(d,0,1,f.y);O(d,0,2,f.b);O(d,0,3,0);O(d,1,0,a.x);O(d,1,1,a.y);O(d,1,2,a.b);O(d,1,3,0);O(d,2,0,c.x);O(d,2,1,c.y);O(d,2,2,c.b);O(d,2,3,0);O(d,3,0,0);O(d,3,1,0);O(d,3,2,0);O(d,3,3,1);b=b.B();return d.translate(b.$a())}
function uc(){z.call(this,qc);this.P=j}w(uc,oc);function vc(){z.call(this,rc);this.P=j;this.zb=0}w(vc,oc);function tc(){z.call(this,sc);this.Z=this.la=!1}w(tc,oc);v("X.camera",W);v("X.camera.prototype.observe",W.prototype.ra);v("X.camera.prototype.onZoom",W.prototype.rb);v("X.camera.prototype.onPan",W.prototype.pb);v("X.camera.prototype.onRotate",W.prototype.qb);v("X.camera.prototype.perspective",W.prototype.U);v("X.camera.prototype.view",W.prototype.view);v("X.camera.prototype.position",W.prototype.position);
v("X.camera.prototype.pan",W.prototype.sb);v("X.camera.prototype.rotate",W.prototype.rotate);v("X.camera.prototype.zoomIn",W.prototype.xb);v("X.camera.prototype.zoomOut",W.prototype.yb);v("X.camera.prototype.observe",W.prototype.ra);v("X.camera.PanEvent",uc);v("X.camera.RotateEvent",vc);v("X.camera.ZoomEvent",tc);function Z(a){var b=xc;if(p(a)&&(a==yc||a==xc))b=a;F.call(this);this.h="object";this.Db=b;this.ya=j;this.c=new V;this.r=new T;this.Wb=this.Zb=j;this.Ha=1;this.ac=!0}w(Z,F);var xc="TRIANGLES",yc="LINES";l=Z.prototype;l.type=k("Db");l.Rb=k("c");l.Gb=k("r");l.color=k("ya");l.ga=function(a){!p(a)&&!(a instanceof J)&&g(new I("Fatal: Invalid color."));this.ya=a};l.opacity=k("Ha");l.ha=function(a){(!u(a)||a>1||a<0)&&g(new I("Fatal: Invalid opacity."));this.Ha=a};
function zc(a,b){(!p(a)||!p(b)||!(a instanceof Z)||!(b instanceof Z))&&g(new I("Fatal: Two valid X.objects are required for comparison."));if(a.opacity()<=b.opacity())return 1;else if(a.opacity()>b.opacity())return-1}v("X.object",Z);v("X.object.prototype.type",Z.prototype.type);v("X.object.prototype.points",Z.prototype.Rb);v("X.object.prototype.colors",Z.prototype.Gb);v("X.object.prototype.color",Z.prototype.color);v("X.object.prototype.setColor",Z.prototype.ga);v("X.object.prototype.opacity",Z.prototype.opacity);
v("X.object.prototype.setOpacity",Z.prototype.ha);v("X.object.OPACITY_COMPARATOR",zc);function Ac(a){this.Kb=a;this.bb=E(this.Kb,Ba?"DOMMouseScroll":"mousewheel",this)}w(Ac,Db);
Ac.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.G;if(a.type=="mousewheel"){c=1;if(x||Ca&&(Fa||Oa("532.0")))c=40;d=Ca&&wa&&-a.wheelDelta%c!=0?-a.wheelDelta:-a.wheelDelta/c;o(a.wheelDeltaX)?(b=Ca&&wa&&-a.wheelDeltaX%c!=0?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Ca&&wa&&-a.wheelDeltaY%c!=0?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,d>100?d=3:d<-100&&(d=-3),o(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;u(this.eb)&&(b=Math.min(Math.max(b,-this.eb),this.eb));u(this.fb)&&(c=Math.min(Math.max(c,
-this.fb),this.fb));b=new Bc(d,a,b,c);try{this.dispatchEvent(b)}finally{b.F()}};Ac.prototype.t=function(){Ac.N.t.call(this);xb(this.bb);delete this.bb};function Bc(a,b,c,d){b&&this.p(b,i);this.type="mousewheel";this.detail=a;this.bc=c;this.Hb=d}w(Bc,A);function Y(a){(!p(a)||!(a instanceof Element))&&g(new I("Fatal: Could not add interactor to the given element."));F.call(this);this.h="interactor";this.K=a;this.Fa=j;this.da=this.ca=this.Q=!1;this.ba=new M(0,0)}w(Y,F);l=Y.prototype;l.jb=function(){this.Fa=new Ac(this.K);E(this.Fa,"mousewheel",this.ob.bind(this))};l.hb=function(){E(this.K,"mousedown",this.kb.bind(this));E(this.K,"mouseup",this.nb.bind(this));this.K.oncontextmenu=function(){return!1}};
l.ib=function(){E(this.K,"mousemove",this.lb.bind(this));E(this.K,"mouseout",this.mb.bind(this))};l.kb=function(a){if(a.button==0)this.Q=!0;else if(a.button==1)this.ca=!0;else if(a.button==2)this.da=!0;a.preventDefault()};l.nb=function(a){if(a.button==0)this.Q=!1;else if(a.button==1)this.ca=!1;else if(a.button==2)this.da=!1;a.preventDefault()};l.mb=function(a){this.da=this.ca=this.Q=!1;this.ba.x=0;this.ba.y=0;a.preventDefault()};
l.lb=function(a){this.dispatchEvent("mouseup");a.preventDefault();var b=a.shiftKey,c=new M(a.clientX,a.clientY),a=this.ba.ua(c);this.ba=c.B();if(Math.abs(a.x)<2)a.x=0;if(Math.abs(a.y)<2)a.y=0;if(a.fa()!=0)if(this.Q&&!b)b=new vc,b.P=a,b.zb=0,this.dispatchEvent(b);else if(this.ca||this.Q&&b)b=new uc,b.P=a,this.dispatchEvent(b);else if(this.da)b=new tc,b.la=a.y<0,b.Z=!1,this.dispatchEvent(b)};l.ob=function(a){a.preventDefault();var b=new tc;b.la=a.Hb>0;b.Z=!0;this.dispatchEvent(b)};
v("X.interactor",Y);v("X.interactor.prototype.observeMouseWheel",Y.prototype.jb);v("X.interactor.prototype.observeMouseClicks",Y.prototype.hb);v("X.interactor.prototype.observeMouseMovement",Y.prototype.ib);v("X.interactor.prototype.onMouseDown",Y.prototype.kb);v("X.interactor.prototype.onMouseUp",Y.prototype.nb);v("X.interactor.prototype.onMouseMovementOutside",Y.prototype.mb);v("X.interactor.prototype.onMouseMovementInside",Y.prototype.lb);v("X.interactor.prototype.onMouseWheel",Y.prototype.ob);function $(a,b){if(!(this instanceof Cc)&&!(this instanceof Dc)){var c="";c+="Fatal: X.renderer should not be instantiated directly.";c+="Use X.renderer2D or X.renderer3D instead.";g(new I(c))}(!u(a)||!u(b))&&g(new I("Fatal: Invalid width or height for the renderer."));F.call(this);this.h="renderer";this.ja=-1;this.Sa=a;this.Ca=b;this.wa="#000000";this.Da=this.C=this.ma=this.na=this.a=this.i=this.Y=j;this.Ga=new Wb(zc);this.Na=new S;this.Aa=new S;this.Ja=new S}w($,F);var Ec="render_"+Cb++;
function wc(){z.call(this,Ec);this.$b=Date.now()}w(wc,oc);l=$.prototype;l.Jb=k("ja");l.width=k("Sa");l.Ub=function(a){this.i&&this.i.style.setProperty("width",a.toString());this.Sa=a};l.height=k("Ca");l.Tb=function(a){this.i&&this.i.style.setProperty("height",a.toString());this.Ca=a};l.backgroundColor=k("wa");l.ub=function(a){this.i&&this.i.style.setProperty("background-color",a.toString());this.wa=a};l.canvas=function(){p(this.i)||g(new I("Fatal: No valid canvas for this renderer!"));return this.i};
l.Va=function(){if(!this.Y){var a=document.body;a||g(new I("Fatal: Could not find <body></body>!"));this.Y=a}return this.Y};l.vb=function(a){a||g(new I("Fatal: Could not find container!"));this.Y=a};l.W=function(a){this.vb(s(a)?document.getElementById(a):a)};l.Fb=k("C");l.Nb=k("Da");
l.p=function(){if(!p(this.i)){var a=Lb("canvas");a.style.setProperty("background-color",this.backgroundColor().toString());a.width=this.width();a.height=this.height();this.Va().appendChild(a);try{var b=a.getContext("experimental-webgl")}catch(c){g(new I("Fatal: Exception while getting GL Context!\n"+c))}b||g(new I("Fatal: WebGL not supported!"));try{b.viewport(0,0,this.width(),this.height()),b.clearColor(0,0,0,0),b.enable(b.BLEND),b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA),b.disable(b.DEPTH_TEST),
b.depthFunc(b.LEQUAL),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)}catch(d){g(new I("Fatal: Exception while accessing GL Context!\n"+d))}var f=new Y(a);f.jb();f.hb();f.ib();var e=new W(this.width(),this.height());e.ra(f);E(e,Ec,this.J.bind(this));this.i=a;this.a=b;this.C=e;this.Da=f;this.Ta(new L)}};
l.Ta=function(a){(!p(this.i)||!p(this.a)||!p(this.C))&&g(new I("Fatal: Renderer was not initialized properly!"));(!p(a)||!(a instanceof L))&&g(new I("Fatal: Could not add shaders!"));a.wb();var b=this.a.createShader(this.a.FRAGMENT_SHADER),c=this.a.createShader(this.a.VERTEX_SHADER);this.a.shaderSource(b,a.ka);this.a.shaderSource(c,a.A);this.a.compileShader(b);this.a.compileShader(c);(!this.a.getShaderParameter(b,this.a.COMPILE_STATUS)||!this.a.getShaderParameter(c,this.a.COMPILE_STATUS))&&g(new I("Fatal: Shader compilation failed!"));
var d=this.a.createProgram();this.a.attachShader(d,c);this.a.attachShader(d,b);this.a.linkProgram(d);this.a.getProgramParameter(d,this.a.LINK_STATUS)||g(new I("Fatal: Could not create shader program!"));this.a.useProgram(d);this.Qa=this.a.getAttribLocation(d,a.position());this.a.enableVertexAttribArray(this.Qa);this.Oa=this.a.getAttribLocation(d,a.color());this.a.enableVertexAttribArray(this.Oa);this.Pa=this.a.getAttribLocation(d,a.opacity());this.a.enableVertexAttribArray(this.Pa);this.ma=d;this.na=
a};
l.s=function(a){(!p(this.i)||!p(this.a)||!p(this.C))&&g(new I("Fatal: Renderer was not initialized properly!"));(!p(a)||!(a instanceof Z))&&g(new I("Fatal: Illegal object!"));var b=!1,c=new J(1,1,1),d=j;a.color()===j?(b=a.c.count()==a.r.count(),d=a.r):c=a.color();if(!b){d=new T;for(b=0;b<a.c.count();b++)d.add(c)}c=this.a.createBuffer();this.a.bindBuffer(this.a.ARRAY_BUFFER,c);this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(a.c.o()),this.a.STATIC_DRAW);c=new R(c,a.c.count(),3);b=this.a.createBuffer();this.a.bindBuffer(this.a.ARRAY_BUFFER,
b);this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(d.o()),this.a.STATIC_DRAW);var d=new R(b,d.count(),3),b=this.a.createBuffer(),f=Array(a.c.o().length),e;for(e=0;e<f.length;++e)f[e]=a.opacity();this.a.bindBuffer(this.a.ARRAY_BUFFER,b);this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(f),this.a.STATIC_DRAW);b=new R(b,1,1);this.Ga.add(a)||g(new I("Fatal: Could not add object to this renderer."));this.Na.set(a.id(),c);this.Aa.set(a.id(),d);this.Ja.set(a.id(),b)};
l.J=function(){(!this.i||!this.a||!this.C)&&g(new I("Fatal: The renderer was not initialized properly!"));this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var a=this.C.U(),b=this.C.view();this.a.uniformMatrix4fv(this.a.getUniformLocation(this.ma,this.na.U()),!1,new Float32Array(a.o()));this.a.uniformMatrix4fv(this.a.getUniformLocation(this.ma,this.na.view()),!1,new Float32Array(b.o()));var a=this.Ga.pa(),b=a.length,c;for(c=0;c<b;++c){var d=a[c];if(d){var f=d.id(),e=this.Na.get(f),h=this.Aa.get(f),
f=this.Ja.get(f);this.a.bindBuffer(this.a.ARRAY_BUFFER,e.$);this.a.vertexAttribPointer(this.Qa,e.aa,this.a.FLOAT,!1,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,h.$);this.a.vertexAttribPointer(this.Oa,h.aa,this.a.FLOAT,!1,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,f.$);this.a.vertexAttribPointer(this.Pa,f.aa,this.a.FLOAT,!1,0,0);h=-1;if(d.type()==xc)h=this.a.TRIANGLES;else if(d.type()==yc)h=this.a.LINES;this.a.drawArrays(h,0,e.Ea)}else g(new I("Fatal: Could not retrieve object for (re-)drawing!"))}};
v("X.renderer",$);v("X.renderer.prototype.dimension",$.prototype.Jb);v("X.renderer.prototype.width",$.prototype.width);v("X.renderer.prototype.setWidth",$.prototype.Ub);v("X.renderer.prototype.height",$.prototype.height);v("X.renderer.prototype.setHeight",$.prototype.Tb);v("X.renderer.prototype.backgroundColor",$.prototype.backgroundColor);v("X.renderer.prototype.setBackgroundColor",$.prototype.ub);v("X.renderer.prototype.canvas",$.prototype.canvas);v("X.renderer.prototype.container",$.prototype.Va);
v("X.renderer.prototype.setContainer",$.prototype.vb);v("X.renderer.prototype.setContainerById",$.prototype.W);v("X.renderer.prototype.camera",$.prototype.Fb);v("X.renderer.prototype.interactor",$.prototype.Nb);v("X.renderer.prototype.init",$.prototype.p);v("X.renderer.prototype.addShaders",$.prototype.Ta);v("X.renderer.prototype.addObject",$.prototype.s);v("X.renderer.prototype.render",$.prototype.J);v("X.renderer.RenderEvent",wc);function Cc(a,b){$.call(this,a,b);this.h="renderer2D";this.ja=2}w(Cc,$);v("X.renderer2D",Cc);function Dc(a,b){$.call(this,a,b);this.h="renderer3D";this.ja=3}w(Dc,$);v("X.renderer3D",Dc);var Fc={Sb:function(){var a=new K;a.L("Starting sampleApp.init..");try{var b=new Cc(300,300);b.W("sliceView1");b.p();var c=new Cc(300,300);c.W("sliceView2");c.p();var d=new Cc(300,300);d.W("sliceView3");d.p();var f=new Dc(912,400);f.W("threeDView");f.ub("#b3b3e7");f.p();var e=new Z;e.c.add([2,2,0]);e.c.add([3,3,0]);e.c.add([1,2.5,0]);e.ga(new J(1,0,0));e.r.add(new J(1,1,1));e.r.add(new J(1,1,1));e.r.add(new J(1,1,1));var h=new Z(yc);h.c.add([20,20,0]);h.c.add([30,30,0]);h.c.add([10,20.5,0]);h.c.add([10,
40.5,0]);h.r.add(new J(1,1,1));h.r.add(new J(1,0,0));h.r.add(new J(0,0,1));h.r.add(new J(0,0,1));h.ha(0.5);var m=new Z;m.c.add([-40,-40,0]);m.c.add([-50,-50,0]);m.c.add([-30,-30,0]);m.c.add([10,20.5,0]);var t=new J(0,1,0),q=new Z;q.c.add([-30,40,0]);q.c.add([-50,30,0]);q.c.add([-30,30,0]);q.c.add([-10,20,0]);q.ga(t);q.ha(0.5);var U=new J(0,1,0),r=new Z;r.c.add([-30,40,-10]);r.c.add([-50,30,-10]);r.c.add([-20,10,-10]);r.c.add([-10,10,-10]);r.ga(U);r.ha(0.1);b.s(e);c.s(e);d.s(e);f.s(e);f.s(h);f.s(m);
f.s(q);f.s(r);b.J();c.J();d.J();f.J();a.L(b.print());a.L(c.print());a.L(d.print());a.L(f.print());var G=function(a){var a=a.target.result.split("\n"),b=new Z,c;for(c=0;c<a.length;c++){var d=a[c].split(" ");d[3]=="vertex"&&b.c.add([d[4],d[5],d[6]])}f.s(b);f.J()},H=document.getElementById("threeDView");H.addEventListener("dragover",function(a){a.stopPropagation();a.preventDefault()},!1);H.addEventListener("drop",function(a){a.stopPropagation();a.preventDefault();var a=a.dataTransfer.files,b,c=0;for(b=
0;c=a[b];b++){var d=new FileReader;d.onloadend=G;d.readAsText(c)}},!1)}catch(cc){cc instanceof I&&a.Za(cc.print())}}};v("sampleApp",Fc);v("sampleApp.run",Fc.Sb);
