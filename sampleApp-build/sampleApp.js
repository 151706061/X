function f(a){throw a;}var g=void 0,i=null;function j(a){return function(){return this[a]}}var l,m=this;
function n(a){var c=typeof a;if(c=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return c;var b=Object.prototype.toString.call(a);if(b=="[object Window]")return"object";if(b=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(b=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(c=="function"&&typeof a.call=="undefined")return"object";return c}function aa(a){var c=n(a);return c=="array"||c=="object"&&typeof a.length=="number"}function o(a){return typeof a=="string"}function p(a){return typeof a=="number"}function ba(a){a=n(a);return a=="object"||a=="array"||a=="function"}Math.floor(Math.random()*2147483648).toString(36);
function q(a,c){var b=a.split("."),d=m;!(b[0]in d)&&d.execScript&&d.execScript("var "+b[0]);for(var e;b.length&&(e=b.shift());)!b.length&&c!==g?d[e]=c:d=d[e]?d[e]:d[e]={}}function r(a,c){function b(){}b.prototype=c.prototype;a.Na=c.prototype;a.prototype=new b};function s(){this.d="base"}s.prototype.className=j("d");s.prototype.print=function(){var a=Object.keys(this),c="",b="<unknown>",d;for(d in a){var e="this."+a[d],h=eval(e);e=="this._className"?b=h:c+=e+": "+h+"\n"}a="== X."+b+" ==\n";a+=c;return a};q("X.base",s);q("X.base.prototype.className",s.prototype.className);q("X.base.prototype.print",s.prototype.print);function t(a){this.d="base";this.d="exception";this.Ja=a?a:"Unknown error!";this.Ka=Error().stack}r(t,s);q("X.exception",t);function u(a,c,b){this.d="base";this.d="color";this.da=a;this.Y=c;this.T=b;this.G=1}r(u,s);l=u.prototype;l.red=j("da");l.green=j("Y");l.blue=j("T");l.alpha=j("G");l.l=function(){var a=Array(4);a[0]=this.da;a[1]=this.Y;a[2]=this.T;a[3]=this.G;return a};l.Q=function(a){this.G=a};q("X.color",u);q("X.color.prototype.red",u.prototype.red);q("X.color.prototype.green",u.prototype.green);q("X.color.prototype.blue",u.prototype.blue);q("X.color.prototype.alpha",u.prototype.alpha);
q("X.color.prototype.flatten",u.prototype.l);q("X.color.prototype.setAlpha",u.prototype.Q);function ca(a){if(!da.test(a))return a;a.indexOf("&")!=-1&&(a=a.replace(ea,"&amp;"));a.indexOf("<")!=-1&&(a=a.replace(fa,"&lt;"));a.indexOf(">")!=-1&&(a=a.replace(ga,"&gt;"));a.indexOf('"')!=-1&&(a=a.replace(ha,"&quot;"));return a}var ea=/&/g,fa=/</g,ga=/>/g,ha=/\"/g,da=/[&<>\"]/;
function ia(a){for(var c=0,b=String(ja).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),a=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=Math.max(b.length,a.length),e=0;c==0&&e<d;e++){var h=b[e]||"",k=a[e]||"",y=RegExp("(\\d*)(\\D*)","g"),W=RegExp("(\\d*)(\\D*)","g");do{var v=y.exec(h)||["","",""],F=W.exec(k)||["","",""];if(v[0].length==0&&F[0].length==0)break;c=ka(v[1].length==0?0:parseInt(v[1],10),F[1].length==0?0:parseInt(F[1],10))||ka(v[2].length==0,F[2].length==0)||ka(v[2],F[2])}while(c==
0)}return c}function ka(a,c){if(a<c)return-1;else if(a>c)return 1;return 0};var w=Array.prototype,la=w.indexOf?function(a,c,b){return w.indexOf.call(a,c,b)}:function(a,c,b){b=b==i?0:b<0?Math.max(0,a.length+b):b;if(o(a))return!o(c)||c.length!=1?-1:a.indexOf(c,b);for(;b<a.length;b++)if(b in a&&a[b]===c)return b;return-1},ma=w.forEach?function(a,c,b){w.forEach.call(a,c,b)}:function(a,c,b){for(var d=a.length,e=o(a)?a.split(""):a,h=0;h<d;h++)h in e&&c.call(b,e[h],h,a)};function na(a){return w.concat.apply(w,arguments)}
function oa(a){if(n(a)=="array")return na(a);else{for(var c=[],b=0,d=a.length;b<d;b++)c[b]=a[b];return c}}function pa(a,c,b){return arguments.length<=2?w.slice.call(a,c):w.slice.call(a,c,b)};function qa(a,c){var b;b=(b=a.className)&&typeof b.split=="function"?b.split(/\s+/):[];var d=pa(arguments,1),e;e=b;for(var h=0,k=0;k<d.length;k++)la(e,d[k])>=0||(e.push(d[k]),h++);e=h==d.length;a.className=b.join(" ");return e};function ra(a,c){for(var b in a)c.call(g,a[b],b,a)}var sa=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];function ta(a,c){for(var b,d,e=1;e<arguments.length;e++){d=arguments[e];for(b in d)a[b]=d[b];for(var h=0;h<sa.length;h++)b=sa[h],Object.prototype.hasOwnProperty.call(d,b)&&(a[b]=d[b])}};var x,ua,z,va;function wa(){return m.navigator?m.navigator.userAgent:i}va=z=ua=x=!1;var A;if(A=wa()){var xa=m.navigator;x=A.indexOf("Opera")==0;ua=!x&&A.indexOf("MSIE")!=-1;z=!x&&A.indexOf("WebKit")!=-1;va=!x&&!z&&xa.product=="Gecko"}var B=ua,ya=va,za=z,ja;
a:{var C="",D;if(x&&m.opera)var Aa=m.opera.version,C=typeof Aa=="function"?Aa():Aa;else if(ya?D=/rv\:([^\);]+)(\)|;)/:B?D=/MSIE\s+([^\);]+)(\)|;)/:za&&(D=/WebKit\/(\S+)/),D)var Ba=D.exec(wa()),C=Ba?Ba[1]:"";if(B){var Ca,Da=m.document;Ca=Da?Da.documentMode:g;if(Ca>parseFloat(C)){ja=String(Ca);break a}}ja=C}var Ea={},Fa={};function Ia(){return Fa[9]||(Fa[9]=B&&document.documentMode&&document.documentMode>=9)};function Ja(a,c){this.width=a;this.height=c}l=Ja.prototype;l.t=function(){return new Ja(this.width,this.height)};l.toString=function(){return"("+this.width+" x "+this.height+")"};l.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};l.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};l.scale=function(a){this.width*=a;this.height*=a;return this};var Ka=!B||Ia();if(ya||B)if(!B||!Ia())ya&&(Ea["1.9.1"]||(Ea["1.9.1"]=ia("1.9.1")>=0));B&&(Ea["9"]||(Ea["9"]=ia("9")>=0));function La(a,c){this.x=a!==g?a:0;this.y=c!==g?c:0}La.prototype.t=function(){return new La(this.x,this.y)};La.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function Ma(a,c){ra(c,function(b,c){c=="style"?a.style.cssText=b:c=="class"?a.className=b:c=="for"?a.htmlFor=b:c in Na?a.setAttribute(Na[c],b):c.lastIndexOf("aria-",0)==0?a.setAttribute(c,b):a[c]=b})}var Na={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};
function Oa(a,c,b){var d=arguments,e=document,h=d[0],k=d[1];if(!Ka&&k&&(k.name||k.type)){h=["<",h];k.name&&h.push(' name="',ca(k.name),'"');if(k.type){h.push(' type="',ca(k.type),'"');var y={};ta(y,k);k=y;delete k.type}h.push(">");h=h.join("")}h=e.createElement(h);if(k)o(k)?h.className=k:n(k)=="array"?qa.apply(i,[h].concat(k)):Ma(h,k);d.length>2&&Pa(e,h,d);return h}
function Pa(a,c,b){function d(b){b&&c.appendChild(o(b)?a.createTextNode(b):b)}for(var e=2;e<b.length;e++){var h=b[e];aa(h)&&!(ba(h)&&h.nodeType>0)?ma(Qa(h)?oa(h):h,d):d(h)}}function Qa(a){if(a&&typeof a.length=="number")if(ba(a))return typeof a.item=="function"||typeof a.item=="string";else if(n(a)=="function")return typeof a.item=="function";return!1};function E(){this.d="base";this.d="console";this.H=i}r(E,s);E.prototype.N=function(){if(!this.H){var a;(a=(a=document)?a.parentWindow||a.defaultView:window)||f(new t("Fatal: Could not get the window!"));(a=a.console)||f(new t("Fatal: The console is not available!"));this.H=a}return this.H};E.prototype.u=function(a){var c=this.N();c&&c.log(a)};E.prototype.oa=function(a){var c=this.N();c&&c.error(a)};q("X.console",E);q("X.console.prototype.console_",E.prototype.N);q("X.console.prototype.out",E.prototype.u);
q("X.console.prototype.err",E.prototype.oa);function G(){this.d="base";this.d="shader";this.s="attribute vec3 vertexPosition;                                          \nattribute vec4 vertexColor;                                             \n                                                                        \nuniform mat4 view;                                                      \nuniform mat4 perspective;                                               \n                                                                        \nvarying lowp vec4 fragmentColor;                                        \n                                                                        \nvoid main(void) {                                                       \n  gl_Position = perspective * view * vec4(vertexPosition, 1.0);         \n  fragmentColor = vertexColor;                                          \n}                                                                       \n";
this.X="varying lowp vec4 fragmentColor;                   \n                                                   \nvoid main(void) {                                  \n  gl_FragColor = fragmentColor;                    \n}                                                  \n";this.ca="vertexPosition";this.V="vertexColor";this.ia="view";this.ba="perspective"}r(G,s);l=G.prototype;l.Ha=j("s");l.za=j("X");l.position=j("ca");l.color=j("V");l.view=j("ia");l.v=j("ba");
l.ta=function(){var a=31337,a=this.s.search(this.ca);a==-1&&f(new t("Fatal: Could not validate shader! The positionAttribute was bogus."));a=this.s.search(this.V);a==-1&&f(new t("Fatal: Could not validate shader! The colorAttribute was bogus."));a=this.s.search(this.ba);a==-1&&f(new t("Fatal: Could not validate shader! The perspectiveUniform was bogus."));a=this.s.search(this.ia);a==-1&&f(new t("Fatal: Could not validate shader! The viewUniform was bogus."));return!0};q("X.shaders",G);
q("X.shaders.prototype.vertex",G.prototype.Ha);q("X.shaders.prototype.fragment",G.prototype.za);q("X.shaders.prototype.position",G.prototype.position);q("X.shaders.prototype.color",G.prototype.color);q("X.shaders.prototype.view",G.prototype.view);q("X.shaders.prototype.perspective",G.prototype.v);q("X.shaders.prototype.validate",G.prototype.ta);function H(a,c){this.x=a;this.y=c}r(H,La);l=H.prototype;l.t=function(){return new H(this.x,this.y)};l.O=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};l.scale=function(a){this.x*=a;this.y*=a;return this};l.pa=function(){this.x=-this.x;this.y=-this.y;return this};l.normalize=function(){return this.scale(1/this.O())};l.add=function(a){this.x+=a.x;this.y+=a.y;return this};function I(a,c){if(a instanceof I)this.j=a.R();else{var b;if(b=aa(a))a:{for(var d=b=0;d<a.length;d++){if(!aa(a[d])||b>0&&a[d].length!=b){b=!1;break a}for(var e=0;e<a[d].length;e++)if(!p(a[d][e])){b=!1;break a}if(b==0)b=a[d].length}b=b!=0}b?this.j=oa(a):a instanceof Ja?this.j=Ra(a.height,a.width):p(a)&&p(c)&&a>0&&c>0?this.j=Ra(a,c):f(Error("Invalid argument(s) for Matrix contructor"))}this.b=new Ja(this.j[0].length,this.j.length)}
function Sa(a){for(var c=[],b=0;b<a;b++){c[b]=[];for(var d=0;d<a;d++)c[b][d]=b==d?1:0}return new I(c)}function Ta(a,c,b){for(var d=0;d<a.b.height;d++)for(var e=0;e<a.b.width;e++)c.call(b,a.j[d][e],d,e,a)}function Ua(a,c){var b=new I(a.b);Ta(a,function(d,e,h){b.j[e][h]=c.call(g,d,e,h,a)});return b}function Ra(a,c){for(var b=[],d=0;d<a;d++){b[d]=[];for(var e=0;e<c;e++)b[d][e]=0}return b}
I.prototype.add=function(a){this.b==a.b||(!this.b||!a.b?0:this.b.width==a.b.width&&this.b.height==a.b.height)||f(Error("Matrix summation is only supported on arrays of equal size"));return Ua(this,function(c,b,d){return c+a.j[b][d]})};function J(a,c,b){return!(c>=0&&c<a.b.height&&b>=0&&b<a.b.width)?i:a.j[c][b]}function K(a,c,b,d){c>=0&&c<a.b.height&&b>=0&&b<a.b.width||f(Error("Index out of bounds when setting matrix value, ("+c+","+b+") in size ("+a.b.height+","+a.b.width+")"));a.j[c][b]=d}
I.prototype.multiply=function(a){if(a instanceof I)return this.b.width!=a.b.height&&f(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),Va(this,a);else if(p(a))return Wa(this,a);else f(Error("A matrix can only be multiplied by a number or another matrix."))};I.prototype.R=j("j");
I.prototype.toString=function(){var a=0;Ta(this,function(b){b=String(b).length;b>a&&(a=b)});var c=[];ma(this.j,function(b){c.push("[ ");ma(b,function(b){b=String(b);c.push(Array(a-b.length+1).join(" ")+b+" ")});c.push("]\n")});return c.join("")};function Va(a,c){var b=new I(a.b.height,c.b.width);Ta(b,function(a,e,h){for(var k=a=0;k<this.b.width;k++)a+=J(this,e,k)*J(c,k,h);K(b,e,h,a)},a);return b}function Wa(a,c){return Ua(a,function(a){return a*c})};function L(a,c,b){this.x=a!==g?a:0;this.y=c!==g?c:0;this.e=b!==g?b:0}L.prototype.t=function(){return new L(this.x,this.y,this.e)};L.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.e+")"};L.prototype.R=function(){return[this.x,this.y,this.e]};function M(a,c,b){this.x=a;this.y=c;this.e=b}r(M,L);l=M.prototype;l.t=function(){return new M(this.x,this.y,this.e)};l.O=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.e*this.e)};l.scale=function(a){this.x*=a;this.y*=a;this.e*=a;return this};l.pa=function(){this.x=-this.x;this.y=-this.y;this.e=-this.e;return this};l.normalize=function(){return this.scale(1/this.O())};l.add=function(a){this.x+=a.x;this.y+=a.y;this.e+=a.e;return this};
function Xa(a,c){return new M(a.y*c.e-a.e*c.y,a.e*c.x-a.x*c.e,a.x*c.y-a.y*c.x)};I.prototype.l=function(){var a=[],c=this.b;if(c.height==0||c.width==0)return[];for(var b=0;b<c.height;b++)for(var d=0;d<c.width;d++)a.push(J(this,d,b));return a};I.prototype.translate=function(a){this.b.width!=this.b.height&&f(new t("Fatal: Can not translate non-square matrix!"));var c=this.b,b=Sa(c.height);a instanceof H&&c.height==3?(K(b,0,2,a.x),K(b,1,2,a.y)):a instanceof M&&c.height==4?(K(b,0,3,a.x),K(b,1,3,a.y),K(b,2,3,a.e)):f(new t("Fatal: Translation failed!"));return this.multiply(b)};var N="StopIteration"in m?m.StopIteration:Error("StopIteration");function Ya(){}Ya.prototype.next=function(){f(N)};Ya.prototype.r=function(){return this};function O(a,c){this.i={};this.f=[];var b=arguments.length;if(b>1){b%2&&f(Error("Uneven number of arguments"));for(var d=0;d<b;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){var e;if(a instanceof O){Za(a);d=a.f.concat();Za(a);e=[];for(b=0;b<a.f.length;b++)e.push(a.i[a.f[b]])}else{var b=[],h=0;for(d in a)b[h++]=d;d=b;b=[];h=0;for(e in a)b[h++]=a[e];e=b}for(b=0;b<d.length;b++)this.set(d[b],e[b])}}l=O.prototype;l.p=0;l.B=0;function P(a,c){return Q(a.i,c)}
function $a(a,c){for(var b=0;b<a.f.length;b++){var d=a.f[b];if(Q(a.i,d)&&a.i[d]==c)return!0}return!1}l.clear=function(){this.i={};this.B=this.p=this.f.length=0};l.remove=function(a){return Q(this.i,a)?(delete this.i[a],this.p--,this.B++,this.f.length>2*this.p&&Za(this),!0):!1};
function Za(a){if(a.p!=a.f.length){for(var c=0,b=0;c<a.f.length;){var d=a.f[c];Q(a.i,d)&&(a.f[b++]=d);c++}a.f.length=b}if(a.p!=a.f.length){for(var e={},b=c=0;c<a.f.length;)d=a.f[c],Q(e,d)||(a.f[b++]=d,e[d]=1),c++;a.f.length=b}}l.get=function(a,c){return Q(this.i,a)?this.i[a]:c};l.set=function(a,c){Q(this.i,a)||(this.p++,this.f.push(a),this.B++);this.i[a]=c};l.t=function(){return new O(this)};
l.r=function(a){Za(this);var c=0,b=this.f,d=this.i,e=this.B,h=this,k=new Ya;k.next=function(){for(;;){e!=h.B&&f(Error("The map has changed since the iterator was created"));c>=b.length&&f(N);var k=b[c++];return a?k:d[k]}};return k};function Q(a,c){return Object.prototype.hasOwnProperty.call(a,c)};function S(a,c,b){a||f(new t("Fatal: Invalid GL Buffer."));c||f(new t("Fatal: Invalid number of items."));b||f(new t("Fatal: Invalid item size."));this.d="base";this.d="buffer";this.J=a;this.aa=c;this.K=b}r(S,s);S.prototype.Aa=j("J");S.prototype.Ba=j("aa");S.prototype.Ca=j("K");q("X.buffer",S);q("X.buffer.prototype.glBuffer",S.prototype.Aa);q("X.buffer.prototype.itemCount",S.prototype.Ba);q("X.buffer.prototype.itemSize",S.prototype.Ca);function T(){this.d="base";this.d="colors";this.g=new O;this.q=-1}r(T,s);l=T.prototype;l.add=function(a){(a==i||!(a instanceof u))&&f(new t("Fatal: Invalid color."));P(this.g,++this.q)&&f(new t("Fatal: Could not get unique id."));this.g.set(this.q,a);return this.q};l.get=function(a){(a==i||!P(this.g,a))&&f(new t("Fatal: Invalid id."));return this.g.get(a)};
l.remove=function(a){(a==i||!(a instanceof u))&&f(new t("Fatal: Invalid color."));if(!$a(this.g,a))return!1;var c=this.g.r(!0);try{for(;;){var b=c.next();if(this.g.get(b)==a)return this.g.remove(b)}}catch(d){d!=N&&f(d)}};l.P=function(a){a==i&&f(new t("Fatal: Invalid id."));return!P(this.g,a)?!1:this.g.remove(a)};l.count=function(){return this.g.p};l.l=function(){var a=[],c=this.g.r(!0);try{for(;;)var b=this.g.get(c.next()).l(),a=a.concat(b)}catch(d){d!=N&&f(d)}return a};q("X.colors",T);
q("X.colors.prototype.add",T.prototype.add);q("X.colors.prototype.get",T.prototype.get);q("X.colors.prototype.remove",T.prototype.remove);q("X.colors.prototype.removeById",T.prototype.P);q("X.colors.prototype.count",T.prototype.count);q("X.colors.prototype.flatten",T.prototype.l);function U(){this.d="base";this.d="points";this.h=new O;this.q=-1}r(U,s);l=U.prototype;l.add=function(a){a==i&&f(new t("Fatal: Invalid point."));n(a)=="array"&&a.length==3&&(a=new L(a[0],a[1],a[2]));a instanceof L||f(new t("Fatal: Invalid point."));P(this.h,++this.q)&&f(new t("Fatal: Could not get unique id."));this.h.set(this.q,a);return this.q};l.get=function(a){(a==i||!P(this.h,a))&&f(new t("Fatal: Invalid id."));return this.h.get(a)};
l.remove=function(a){(a==i||!(a instanceof L))&&f(new t("Fatal: Invalid point."));if(!$a(this.h,a))return!1;var c=this.h.r(!0);try{for(;;){var b=c.next();if(this.h.get(b)==a)return this.h.remove(b)}}catch(d){d!=N&&f(d)}};l.P=function(a){a==i&&f(new t("Fatal: Invalid id."));return!P(this.h,a)?!1:this.h.remove(a)};l.count=function(){return this.h.p};l.l=function(){var a=[],c=this.h.r(!0);try{for(;;)var b=this.h.get(c.next()).R(),a=a.concat(b)}catch(d){d!=N&&f(d)}return a};q("X.points",U);
q("X.points.prototype.add",U.prototype.add);q("X.points.prototype.get",U.prototype.get);q("X.points.prototype.remove",U.prototype.remove);q("X.points.prototype.removeById",U.prototype.P);q("X.points.prototype.count",U.prototype.count);q("X.points.prototype.flatten",U.prototype.l);function V(a){this.d="base";a||f(new t("Fatal: A valid renderer is required to create a camera."));this.d="camera";this.ea=a;this.ua=this.la(45,this.ea.width()/this.ea.height(),1,1E4);this.va=this.qa(new M(0,0,100),new M(0,0,0),new M(0,1,0))}r(V,s);l=V.prototype;l.v=j("ua");l.view=j("va");l.la=function(a,c,b,d){var a=b*Math.tan(a*Math.PI/360),e=-a;return this.ma(e*c,a*c,e,a,b,d)};
l.ma=function(a,c,b,d,e,h){return new I([[2*e/(c-a),0,(c+a)/(c-a),0],[0,2*e/(d-b),(d+b)/(d-b),0],[0,0,-(h+e)/(h-e),-2*h*e/(h-e)],[0,0,-1,0]])};
l.qa=function(a,c,b){(!(a instanceof M)||!(c instanceof M)||!(b instanceof M))&&f(new t("Fatal: 3D vectors required for calculating the view."));var d=Sa(4),c=new M(a.x-c.x,a.y-c.y,a.e-c.e);c.normalize();var b=b.t(),e=Xa(b,c),b=Xa(c,e);e.normalize();b.normalize();K(d,0,0,e.x);K(d,0,1,e.y);K(d,0,2,e.e);K(d,0,3,0);K(d,1,0,b.x);K(d,1,1,b.y);K(d,1,2,b.e);K(d,1,3,0);K(d,2,0,c.x);K(d,2,1,c.y);K(d,2,2,c.e);K(d,2,3,0);K(d,3,0,0);K(d,3,1,0);K(d,3,2,0);K(d,3,3,1);return d.translate(a.pa())};q("X.camera",V);
q("X.camera.prototype.perspective",V.prototype.v);q("X.camera.prototype.view",V.prototype.view);q("X.camera.prototype.calculatePerspective_",V.prototype.la);q("X.camera.prototype.calculateViewingFrustum_",V.prototype.ma);q("X.camera.prototype.lookAt_",V.prototype.qa);function Y(a,c){this.d="base";this.d="renderer";this.I=-1;this.ja=a;this.Z=c;this.S="#000000";this.o=this.L=this.M=this.a=this.k=this.C=i;this.D=new O;this.fa=new O;this.W=new O;this.$=-1}r(Y,s);l=Y.prototype;l.ya=j("I");l.width=j("ja");l.Ga=function(a){this.k&&this.k.style.setProperty("width",a.toString());this.ja=a};l.height=j("Z");l.Fa=function(a){this.k&&this.k.style.setProperty("height",a.toString());this.Z=a};l.backgroundColor=j("S");
l.ra=function(a){this.k&&this.k.style.setProperty("background-color",a.toString());this.S=a};l.na=function(){if(!this.C){var a=document.body;a||f(new t("Fatal: Could not find <body></body>!"));this.C=a}return this.C};l.sa=function(a){a||f(new t("Fatal: Could not find container!"));this.C=a};l.A=function(a){this.sa(o(a)?document.getElementById(a):a)};
l.z=function(){if(this.k==i){var a=Oa("canvas");a.style.setProperty("background-color",this.backgroundColor().toString());a.width=this.width();a.height=this.height();this.na().appendChild(a);try{var c=a.getContext("experimental-webgl")}catch(b){f(new t("Fatal: Exception while getting GL Context!\n"+b))}c||f(new t("Fatal: WebGL not supported!"));try{c.viewport(0,0,this.width(),this.height()),c.clearColor(0,0,0,0),c.enable(c.DEPTH_TEST),c.depthFunc(c.LEQUAL),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT)}catch(d){f(new t("Fatal: Exception while accessing GL Context!\n"+
d))}var e=new V(this);this.k=a;this.a=c;this.o=e;this.ka(new G)}};
l.ka=function(a){(this.k==i||this.a==i||this.o==i)&&f(new t("Fatal: Renderer was not initialized properly!"));(a==i||!(a instanceof G))&&f(new t("Fatal: Could not add shaders!"));a.ta();var c=this.a.createShader(this.a.FRAGMENT_SHADER),b=this.a.createShader(this.a.VERTEX_SHADER);this.a.shaderSource(c,a.X);this.a.shaderSource(b,a.s);this.a.compileShader(c);this.a.compileShader(b);(!this.a.getShaderParameter(c,this.a.COMPILE_STATUS)||!this.a.getShaderParameter(b,this.a.COMPILE_STATUS))&&f(new t("Fatal: Shader compilation failed!"));
var d=this.a.createProgram();this.a.attachShader(d,b);this.a.attachShader(d,c);this.a.linkProgram(d);this.a.getProgramParameter(d,this.a.LINK_STATUS)||f(new t("Fatal: Could not create shader program!"));this.a.useProgram(d);this.ha=this.a.getAttribLocation(d,a.position());this.a.enableVertexAttribArray(this.ha);this.ga=this.a.getAttribLocation(d,a.color());this.a.enableVertexAttribArray(this.ga);this.L=d;this.M=a};
l.m=function(a){(!this.k||!this.a||!this.o)&&f(new t("Fatal: Renderer was not initialized properly!"));(!a||!(a instanceof Z))&&f(new t("Fatal: Illegal object!"));var c=!1,b=new u(1,1,1),d=i;a.color()===i?(c=a.c.count()==a.n.count(),d=a.n):b=a.color();if(!c){d=new T;for(c=0;c<a.c.count();c++)d.add(b)}b=this.a.createBuffer();this.a.bindBuffer(this.a.ARRAY_BUFFER,b);this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(a.c.l()),this.a.STATIC_DRAW);b=new S(b,a.c.count(),3);c=this.a.createBuffer();this.a.bindBuffer(this.a.ARRAY_BUFFER,
c);this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(d.l()),this.a.STATIC_DRAW);d=new S(c,d.count(),4);P(this.D,++this.$)&&f(new t("Fatal: Could not get unique id."));c=this.$;this.D.set(c,a);this.fa.set(c,b);this.W.set(c,d);return c};
l.w=function(){(!this.k||!this.a||!this.o)&&f(new t("Fatal: The renderer was not initialized properly!"));this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var a=this.o.v(),c=this.o.view();this.a.uniformMatrix4fv(this.a.getUniformLocation(this.L,this.M.v()),!1,new Float32Array(a.l()));this.a.uniformMatrix4fv(this.a.getUniformLocation(this.L,this.M.view()),!1,new Float32Array(c.l()));a=this.D.r(!0);try{for(;;){var b=a.next();if(this.D.get(b)){var d=this.fa.get(b),e=this.W.get(b);this.a.bindBuffer(this.a.ARRAY_BUFFER,
d.J);this.a.vertexAttribPointer(this.ha,d.K,this.a.FLOAT,!1,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,e.J);this.a.vertexAttribPointer(this.ga,e.K,this.a.FLOAT,!1,0,0);this.a.drawArrays(this.a.TRIANGLES,0,d.aa)}}}catch(h){h!=N&&f(h)}};
l.xa=function(a){var c=this.o.view(),b=this.o.v(),d=Sa(4);d.multiply(c);d.multiply(b);var c=d.b,b=Array(c.width),e;for(e=0;e<b.length;e++)b[e]=Array(1),b[e][0]=1;a instanceof H&&c.width>=2?(b[0][0]=a.x,b[1][0]=a.y):a instanceof M&&c.width>=3?(b[0][0]=a.x,b[1][0]=a.y,b[2][0]=a.e):f(new t("Fatal: Multiplication by vector failed!"));d=d.multiply(new I(b));a=(J(d,0,0)+1)/2;a*=this.width();d=(1-J(d,0,1))/2;d*=this.height();return new H(Math.round(a),Math.round(d))};q("X.renderer",Y);
q("X.renderer.prototype.dimension",Y.prototype.ya);q("X.renderer.prototype.width",Y.prototype.width);q("X.renderer.prototype.setWidth",Y.prototype.Ga);q("X.renderer.prototype.height",Y.prototype.height);q("X.renderer.prototype.setHeight",Y.prototype.Fa);q("X.renderer.prototype.backgroundColor",Y.prototype.backgroundColor);q("X.renderer.prototype.setBackgroundColor",Y.prototype.ra);q("X.renderer.prototype.container",Y.prototype.na);q("X.renderer.prototype.setContainer",Y.prototype.sa);
q("X.renderer.prototype.init",Y.prototype.z);q("X.renderer.prototype.setContainerById",Y.prototype.A);q("X.renderer.prototype.addShaders",Y.prototype.ka);q("X.renderer.prototype.addObject",Y.prototype.m);q("X.renderer.prototype.render",Y.prototype.w);q("X.renderer.prototype.convertWorldToDisplayCoordinates",Y.prototype.xa);function $(a,c){Y.call(this,a,c);this.d="renderer2D";this.I=2}r($,Y);q("X.renderer2D",$);function ab(a,c){Y.call(this,a,c);this.d="renderer3D";this.I=3}r(ab,Y);q("X.renderer3D",ab);function Z(){this.d="base";this.d="object";this.U=i;this.c=new U;this.n=new T;this.Ia=this.La=i;this.Ma=!0}r(Z,s);Z.prototype.Da=j("c");Z.prototype.wa=j("n");Z.prototype.color=j("U");Z.prototype.F=function(a){a==i&&!(a instanceof u)&&f(new t("Fatal: Invalid color."));this.U=a};q("X.object",Z);q("X.object.prototype.points",Z.prototype.Da);q("X.object.prototype.colors",Z.prototype.wa);q("X.object.prototype.color",Z.prototype.color);q("X.object.prototype.setColor",Z.prototype.F);var bb={Ea:function(){var a=new E;a.u("Starting sampleApp.init..");try{var c=new $(300,300);c.A("sliceView1");c.z();var b=new $(300,300);b.A("sliceView2");b.z();var d=new $(300,300);d.A("sliceView3");d.z();var e=new ab(912,400);e.A("threeDView");e.ra("#b3b3e7");e.z();var h=new Z;h.c.add([2,2,0]);h.c.add([3,3,0]);h.c.add([1,2.5,0]);h.F(new u(1,0,0));h.n.add(new u(1,1,1));h.n.add(new u(1,1,1));h.n.add(new u(1,1,1));var k=new Z;k.c.add([20,20,0]);k.c.add([30,30,0]);k.c.add([10,20.5,0]);k.n.add(new u(1,
1,1));k.n.add(new u(1,0,0));k.n.add(new u(0,0,1));var y=new Z;y.c.add([-40,-40,0]);y.c.add([-50,-50,0]);y.c.add([-30,-30,0]);y.c.add([10,20.5,0]);var W=new u(0,1,0);W.Q(1);var v=new Z;v.c.add([-30,40,0]);v.c.add([-50,30,0]);v.c.add([-30,30,0]);v.c.add([-10,20,0]);v.F(W);var F=new u(0,1,0);F.Q(0.1);var R=new Z;R.c.add([-30,40,0]);R.c.add([-50,30,0]);R.c.add([-20,10,0]);R.c.add([-10,10,0]);R.F(F);c.m(h);b.m(h);d.m(h);e.m(h);e.m(k);e.m(y);e.m(v);e.m(R);c.w();b.w();d.w();e.w();a.u(c.print());a.u(b.print());
a.u(d.print());a.u(e.print());var cb=function(a){for(var a=a.target.result.split("\n"),b=new Z,c=0;c<a.length;c++){var d=a[c].split(" ");d[3]=="vertex"&&b.c.add([d[4],d[5],d[6]])}e.m(b);e.w()},Ga=document.getElementById("threeDView");Ga.addEventListener("dragover",function(a){a.stopPropagation();a.preventDefault()},!1);Ga.addEventListener("drop",function(a){a.stopPropagation();a.preventDefault();for(var a=a.dataTransfer.files,b=0,c;c=a[b];b++){var d=new FileReader;d.onloadend=cb;d.readAsText(c)}},
!1)}catch(Ha){Ha instanceof t&&a.oa(Ha.print())}}};q("sampleApp",bb);q("sampleApp.run",bb.Ea);
