function g(a){throw a;}var i=void 0,k=null;function m(a){return function(){return this[a]}}var n,p=this;function aa(){}
function ba(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(c=="[object Window]")return"object";if(c=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(c=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(b=="function"&&typeof a.call=="undefined")return"object";return b}function q(a){return a!==i}function r(a){return a!=k}function ca(a){return ba(a)=="array"}function da(a){var b=ba(a);return b=="array"||b=="object"&&typeof a.length=="number"}function s(a){return typeof a=="string"}function t(a){return typeof a=="number"}function ea(a){return ba(a)=="function"}function fa(a){a=ba(a);return a=="object"||a=="array"||a=="function"}function ga(a){return a[ha]||(a[ha]=++ia)}
var ha="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),ia=0;function u(a,b){var c=a.split("."),d=p;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var f;c.length&&(f=c.shift());)!c.length&&q(b)?d[f]=b:d=d[f]?d[f]:d[f]={}}function w(a,b){function c(){}c.prototype=b.prototype;a.Q=b.prototype;a.prototype=new c};var ja=0;function ka(a){if(!la.test(a))return a;a.indexOf("&")!=-1&&(a=a.replace(ma,"&amp;"));a.indexOf("<")!=-1&&(a=a.replace(na,"&lt;"));a.indexOf(">")!=-1&&(a=a.replace(oa,"&gt;"));a.indexOf('"')!=-1&&(a=a.replace(pa,"&quot;"));return a}var ma=/&/g,na=/</g,oa=/>/g,pa=/\"/g,la=/[&<>\"]/;
function qa(a,b){for(var c=0,d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=String(b).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(d.length,f.length),h=0;c==0&&h<e;h++){var o=d[h]||"",j=f[h]||"",l=RegExp("(\\d*)(\\D*)","g"),B=RegExp("(\\d*)(\\D*)","g");do{var v=l.exec(o)||["","",""],C=B.exec(j)||["","",""];if(v[0].length==0&&C[0].length==0)break;c=ra(v[1].length==0?0:parseInt(v[1],10),C[1].length==0?0:parseInt(C[1],10))||ra(v[2].length==0,C[2].length==0)||ra(v[2],C[2])}while(c==
0)}return c}function ra(a,b){if(a<b)return-1;else if(a>b)return 1;return 0};var sa,ta,ua,va,wa;function xa(){return p.navigator?p.navigator.userAgent:k}va=ua=ta=sa=!1;var ya;if(ya=xa()){var za=p.navigator;sa=ya.indexOf("Opera")==0;ta=!sa&&ya.indexOf("MSIE")!=-1;ua=!sa&&ya.indexOf("WebKit")!=-1;va=!sa&&!ua&&za.product=="Gecko"}var Aa=sa,x=ta,Ba=va,Ca=ua,Da,Ea=p.navigator;Da=Ea&&Ea.platform||"";wa=Da.indexOf("Mac")!=-1;var Fa=Da.indexOf("Win")!=-1,Ga;
a:{var Ha="",Ia;if(Aa&&p.opera)var Ja=p.opera.version,Ha=typeof Ja=="function"?Ja():Ja;else if(Ba?Ia=/rv\:([^\);]+)(\)|;)/:x?Ia=/MSIE\s+([^\);]+)(\)|;)/:Ca&&(Ia=/WebKit\/(\S+)/),Ia)var Ka=Ia.exec(xa()),Ha=Ka?Ka[1]:"";if(x){var La,Ma=p.document;La=Ma?Ma.documentMode:i;if(La>parseFloat(Ha)){Ga=String(La);break a}}Ga=Ha}var Na={};function Oa(a){return Na[a]||(Na[a]=qa(Ga,a)>=0)}var Pa={};function Qa(){return Pa[9]||(Pa[9]=x&&document.documentMode&&document.documentMode>=9)};function Ra(a,b){for(var c in a)b.call(i,a[c],c,a)}var Sa=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];function Ta(a,b){for(var c,d,f=1;f<arguments.length;f++){d=arguments[f];for(c in d)a[c]=d[c];for(var e=0;e<Sa.length;e++)c=Sa[e],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var y=Array.prototype,Ua=y.indexOf?function(a,b,c){return y.indexOf.call(a,b,c)}:function(a,b,c){c=c==k?0:c<0?Math.max(0,a.length+c):c;if(s(a))return!s(b)||b.length!=1?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Va=y.forEach?function(a,b,c){y.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=s(a)?a.split(""):a,e=0;e<d;e++)e in f&&b.call(c,f[e],e,a)};function Wa(a){return y.concat.apply(y,arguments)}
function Xa(a){if(ca(a))return Wa(a);else{for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}}function Ya(a,b,c){return arguments.length<=2?y.slice.call(a,b):y.slice.call(a,b,c)};var Za;!x||Qa();var $a=x&&!Oa("8");function ab(){}ab.prototype.ob=!1;ab.prototype.I=function(){if(!this.ob)this.ob=!0,this.z()};ab.prototype.z=function(){this.Zb&&bb.apply(k,this.Zb)};function bb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];da(d)?bb.apply(k,d):d&&typeof d.I=="function"&&d.I()}};function z(a,b){this.type=a;this.currentTarget=this.target=b}w(z,ab);n=z.prototype;n.z=function(){delete this.type;delete this.target;delete this.currentTarget};n.L=!1;n.ca=!0;n.stopPropagation=function(){this.L=!0};n.preventDefault=function(){this.ca=!1};var cb=new Function("a","return a");function A(a,b){a&&this.u(a,b)}w(A,z);n=A.prototype;n.target=k;n.relatedTarget=k;n.offsetX=0;n.offsetY=0;n.clientX=0;n.clientY=0;n.screenX=0;n.screenY=0;n.button=0;n.keyCode=0;n.charCode=0;n.ctrlKey=!1;n.altKey=!1;n.shiftKey=!1;n.metaKey=!1;n.hc=!1;n.J=k;
n.u=function(a,b){var c=this.type=a.type;z.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ba){var f;a:{try{cb(d.nodeName);f=!0;break a}catch(e){}f=!1}f||(d=k)}}else if(c=="mouseover")d=a.fromElement;else if(c=="mouseout")d=a.toElement;this.relatedTarget=d;this.offsetX=a.offsetX!==i?a.offsetX:a.layerX;this.offsetY=a.offsetY!==i?a.offsetY:a.layerY;this.clientX=a.clientX!==i?a.clientX:a.pageX;this.clientY=a.clientY!==i?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||(c=="keypress"?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.hc=wa?a.metaKey:a.ctrlKey;this.state=a.state;this.J=a;delete this.ca;delete this.L};n.stopPropagation=function(){A.Q.stopPropagation.call(this);this.J.stopPropagation?this.J.stopPropagation():this.J.cancelBubble=!0};
n.preventDefault=function(){A.Q.preventDefault.call(this);var a=this.J;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,$a)try{if(a.ctrlKey||a.keyCode>=112&&a.keyCode<=123)a.keyCode=-1}catch(b){}};n.z=function(){A.Q.z.call(this);this.relatedTarget=this.currentTarget=this.target=this.J=k};function db(){}var eb=0;n=db.prototype;n.key=0;n.P=!1;n.kb=!1;n.u=function(a,b,c,d,f,e){ea(a)?this.rb=!0:a&&a.handleEvent&&ea(a.handleEvent)?this.rb=!1:g(Error("Invalid listener argument"));this.aa=a;this.Jb=b;this.src=c;this.type=d;this.capture=!!f;this.Da=e;this.kb=!1;this.key=++eb;this.P=!1};n.handleEvent=function(a){return this.rb?this.aa.call(this.Da||this.src,a):this.aa.handleEvent.call(this.aa,a)};var fb,gb=(fb="ScriptEngine"in p&&p.ScriptEngine()=="JScript")?p.ScriptEngineMajorVersion()+"."+p.ScriptEngineMinorVersion()+"."+p.ScriptEngineBuildVersion():"0";function D(a,b){this.tb=b;this.K=[];a>this.tb&&g(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.K.push(this.B?this.B():{})}w(D,ab);D.prototype.B=k;D.prototype.nb=k;D.prototype.getObject=function(){return this.K.length?this.K.pop():this.B?this.B():{}};function hb(a,b){a.K.length<a.tb?a.K.push(b):ib(a,b)}function ib(a,b){if(a.nb)a.nb(b);else if(fa(b))if(ea(b.I))b.I();else for(var c in b)delete b[c]}
D.prototype.z=function(){D.Q.z.call(this);for(var a=this.K;a.length;)ib(this,a.pop());delete this.K};var jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb;
(function(){function a(){return{e:0,v:0}}function b(){return[]}function c(){function a(b){b=h.call(a.src,a.key,b);if(!b)return b}return a}function d(){return new db}function f(){return new A}var e=fb&&!(qa(gb,"5.7")>=0),h;ob=function(a){h=a};if(e){jb=function(){return o.getObject()};kb=function(a){hb(o,a)};lb=function(){return j.getObject()};mb=function(a){hb(j,a)};nb=function(){return l.getObject()};pb=function(){hb(l,c())};qb=function(){return B.getObject()};rb=function(a){hb(B,a)};sb=function(){return v.getObject()};
tb=function(a){hb(v,a)};var o=new D(0,600);o.B=a;var j=new D(0,600);j.B=b;var l=new D(0,600);l.B=c;var B=new D(0,600);B.B=d;var v=new D(0,600);v.B=f}else jb=a,kb=aa,lb=b,mb=aa,nb=c,pb=aa,qb=d,rb=aa,sb=f,tb=aa})();var ub={},E={},F={},vb={};
function H(a,b,c,d,f){if(b)if(ca(b)){for(var e=0;e<b.length;e++)H(a,b[e],c,d,f);return k}else{var d=!!d,h=E;b in h||(h[b]=jb());h=h[b];d in h||(h[d]=jb(),h.e++);var h=h[d],o=ga(a),j;h.v++;if(h[o]){j=h[o];for(e=0;e<j.length;e++)if(h=j[e],h.aa==c&&h.Da==f){if(h.P)break;return j[e].key}}else j=h[o]=lb(),h.e++;e=nb();e.src=a;h=qb();h.u(c,e,a,b,d,f);c=h.key;e.key=c;j.push(h);ub[c]=h;F[o]||(F[o]=lb());F[o].push(h);a.addEventListener?(a==p||!a.mb)&&a.addEventListener(b,e,d):a.attachEvent(b in vb?vb[b]:vb[b]=
"on"+b,e);return c}else g(Error("Invalid event type"))}function wb(a,b,c,d,f){if(ca(b))for(var e=0;e<b.length;e++)wb(a,b[e],c,d,f);else{d=!!d;a:{e=E;if(b in e&&(e=e[b],d in e&&(e=e[d],a=ga(a),e[a]))){a=e[a];break a}a=k}if(a)for(e=0;e<a.length;e++)if(a[e].aa==c&&a[e].capture==d&&a[e].Da==f){xb(a[e].key);break}}}
function xb(a){if(ub[a]){var b=ub[a];if(!b.P){var c=b.src,d=b.type,f=b.Jb,e=b.capture;c.removeEventListener?(c==p||!c.mb)&&c.removeEventListener(d,f,e):c.detachEvent&&c.detachEvent(d in vb?vb[d]:vb[d]="on"+d,f);c=ga(c);f=E[d][e][c];if(F[c]){var h=F[c],o=Ua(h,b);o>=0&&y.splice.call(h,o,1);h.length==0&&delete F[c]}b.P=!0;f.wb=!0;yb(d,e,c,f);delete ub[a]}}}
function yb(a,b,c,d){if(!d.na&&d.wb){for(var f=0,e=0;f<d.length;f++)if(d[f].P){var h=d[f].Jb;h.src=k;pb(h);rb(d[f])}else f!=e&&(d[e]=d[f]),e++;d.length=e;d.wb=!1;e==0&&(mb(d),delete E[a][b][c],E[a][b].e--,E[a][b].e==0&&(kb(E[a][b]),delete E[a][b],E[a].e--),E[a].e==0&&(kb(E[a]),delete E[a]))}}
function zb(a){var b,c=0,d=b==k;b=!!b;if(a==k)Ra(F,function(a){for(var f=a.length-1;f>=0;f--){var e=a[f];if(d||b==e.capture)xb(e.key),c++}});else if(a=ga(a),F[a])for(var a=F[a],f=a.length-1;f>=0;f--){var e=a[f];if(d||b==e.capture)xb(e.key),c++}}function Ab(a,b,c,d,f){var e=1,b=ga(b);if(a[b]){a.v--;a=a[b];a.na?a.na++:a.na=1;try{for(var h=a.length,o=0;o<h;o++){var j=a[o];j&&!j.P&&(e&=Bb(j,f)!==!1)}}finally{a.na--,yb(c,d,b,a)}}return Boolean(e)}
function Bb(a,b){var c=a.handleEvent(b);a.kb&&xb(a.key);return c}
ob(function(a,b){if(!ub[a])return!0;var c=ub[a],d=c.type,f=E;if(!(d in f))return!0;var f=f[d],e,h;Za===i&&(Za=x&&!p.addEventListener);if(Za){var o;if(!(o=b))a:{o="window.event".split(".");for(var j=p;e=o.shift();)if(r(j[e]))j=j[e];else{o=k;break a}o=j}e=o;o=!0 in f;j=!1 in f;if(o){if(e.keyCode<0||e.returnValue!=i)return!0;a:{var l=!1;if(e.keyCode==0)try{e.keyCode=-1;break a}catch(B){l=!0}if(l||e.returnValue==i)e.returnValue=!0}}l=sb();l.u(e,this);e=!0;try{if(o){for(var v=lb(),C=l.currentTarget;C;C=
C.parentNode)v.push(C);h=f[!0];h.v=h.e;for(var G=v.length-1;!l.L&&G>=0&&h.v;G--)l.currentTarget=v[G],e&=Ab(h,v[G],d,!0,l);if(j){h=f[!1];h.v=h.e;for(G=0;!l.L&&G<v.length&&h.v;G++)l.currentTarget=v[G],e&=Ab(h,v[G],d,!1,l)}}else e=Bb(c,l)}finally{if(v)v.length=0,mb(v);l.I();tb(l)}return e}d=new A(b,this);try{e=Bb(c,d)}finally{d.I()}return e});var Cb=0;function Db(){}w(Db,ab);n=Db.prototype;n.mb=!0;n.Fa=k;n.addEventListener=function(a,b,c,d){H(this,a,b,c,d)};n.removeEventListener=function(a,b,c,d){wb(this,a,b,c,d)};
n.dispatchEvent=function(a){var b=a.type||a,c=E;if(b in c){if(s(a))a=new z(a,this);else if(a instanceof z)a.target=a.target||this;else{var d=a,a=new z(b,this);Ta(a,d)}var d=1,f,c=c[b],b=!0 in c,e;if(b){f=[];for(e=this;e;e=e.Fa)f.push(e);e=c[!0];e.v=e.e;for(var h=f.length-1;!a.L&&h>=0&&e.v;h--)a.currentTarget=f[h],d&=Ab(e,f[h],a.type,!0,a)&&a.ca!=!1}if(!1 in c)if(e=c[!1],e.v=e.e,b)for(h=0;!a.L&&h<f.length&&e.v;h++)a.currentTarget=f[h],d&=Ab(e,f[h],a.type,!1,a)&&a.ca!=!1;else for(f=this;!a.L&&f&&e.v;f=
f.Fa)a.currentTarget=f,d&=Ab(e,f,a.type,!1,a)&&a.ca!=!1;a=Boolean(d)}else a=!0;return a};n.z=function(){Db.Q.z.call(this);zb(this);this.Fa=k};function I(){this.i="base";this.Sb="X"+ja++}w(I,Db);I.prototype.className=m("i");I.prototype.id=m("Sb");I.prototype.print=function(){var a=Object.keys(this),b="",c="<unknown>",d=0;for(d in a){var f="this."+a[d],e=eval(f);f=="this._className"?c=e:b+=f+": "+e+"\n"}a="== X."+c+" ==\n";a+=b;return a};u("X.base",I);u("X.base.prototype.className",I.prototype.className);u("X.base.prototype.id",I.prototype.id);u("X.base.prototype.print",I.prototype.print);function J(a){var b="Unknown error!";r(a)&&(b=a);I.call(this);this.i="exception";this.oc=b;this.pc=Error().stack}w(J,I);u("X.exception",J);function K(a,b,c){(!t(a)||a<0||a>1||!t(b)||b<0||b>1||!t(c)||c<0||c>1)&&g(new J("Fatal: Wrong RGB values - must be in range 0..1!"));I.call(this);this.i="color";this.bb=a;this.Oa=b;this.Ka=c}w(K,I);K.prototype.red=m("bb");K.prototype.green=m("Oa");K.prototype.blue=m("Ka");K.prototype.o=function(){var a=Array(3);a[0]=this.bb;a[1]=this.Oa;a[2]=this.Ka;return a};u("X.color",K);u("X.color.prototype.red",K.prototype.red);u("X.color.prototype.green",K.prototype.green);u("X.color.prototype.blue",K.prototype.blue);
u("X.color.prototype.flatten",K.prototype.o);function Eb(a,b){var c;c=(c=a.className)&&typeof c.split=="function"?c.split(/\s+/):[];var d=Ya(arguments,1),f;f=c;for(var e=0,h=0;h<d.length;h++)Ua(f,d[h])>=0||(f.push(d[h]),e++);f=e==d.length;a.className=c.join(" ");return f};function Fb(a,b){this.width=a;this.height=b}function Gb(a,b){return a==b?!0:!a||!b?!1:a.width==b.width&&a.height==b.height}Fb.prototype.F=function(){return new Fb(this.width,this.height)};Fb.prototype.toString=function(){return"("+this.width+" x "+this.height+")"};Fb.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};Fb.prototype.scale=function(a){this.width*=a;this.height*=a;return this};var Hb=!x||Qa();!Ba&&!x||x&&Qa()||Ba&&Oa("1.9.1");x&&Oa("9");function Ib(a,b){this.x=q(a)?a:0;this.y=q(b)?b:0}Ib.prototype.F=function(){return new Ib(this.x,this.y)};Ib.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function Jb(a,b){Ra(b,function(b,d){d=="style"?a.style.cssText=b:d=="class"?a.className=b:d=="for"?a.htmlFor=b:d in Kb?a.setAttribute(Kb[d],b):d.lastIndexOf("aria-",0)==0?a.setAttribute(d,b):a[d]=b})}var Kb={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};
function Lb(a,b,c){var d=arguments,f=document,e=d[0],h=d[1];if(!Hb&&h&&(h.name||h.type)){e=["<",e];h.name&&e.push(' name="',ka(h.name),'"');if(h.type){e.push(' type="',ka(h.type),'"');var o={};Ta(o,h);h=o;delete h.type}e.push(">");e=e.join("")}e=f.createElement(e);if(h)s(h)?e.className=h:ca(h)?Eb.apply(k,[e].concat(h)):Jb(e,h);d.length>2&&Mb(f,e,d);return e}
function Mb(a,b,c){function d(c){c&&b.appendChild(s(c)?a.createTextNode(c):c)}for(var f=2;f<c.length;f++){var e=c[f];da(e)&&!(fa(e)&&e.nodeType>0)?Va(Nb(e)?Xa(e):e,d):d(e)}}function Nb(a){if(a&&typeof a.length=="number")if(fa(a))return typeof a.item=="function"||typeof a.item=="string";else if(ea(a))return typeof a.item=="function";return!1};function L(){I.call(this);this.i="console";this.wa=k}w(L,I);L.prototype.Ba=function(){if(!this.wa){var a;(a=(a=document)?a.parentWindow||a.defaultView:window)||g(new J("Fatal: Could not get the window!"));(a=a.console)||g(new J("Fatal: The console is not available!"));this.wa=a}return this.wa};L.prototype.O=function(a){var b=this.Ba();b&&b.log(a)};L.prototype.pb=function(a){var b=this.Ba();b&&b.error(a)};u("X.console",L);u("X.console.prototype.console_",L.prototype.Ba);
u("X.console.prototype.out",L.prototype.O);u("X.console.prototype.err",L.prototype.pb);function M(){I.call(this);this.i="shader";var a=this.w="";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexNormal;\n";a+="attribute vec3 vertexColor;\n";a+="attribute float vertexOpacity;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="uniform bool lighting;\n";a+="varying lowp vec4 fragmentColor;\n";a+="\n";a+="void main(void) {\n";a+="  if(lighting){";a+="  gl_Position = perspective * view * vec4(vertexPosition, 1.0);\n";a+="  fragmentColor = vec4(vertexColor,vertexOpacity);\n";
a+="  }";a+="  else{";a+="  gl_Position = perspective * view * vec4(vertexPosition, 1.0);\n";a+="  fragmentColor = vec4(0.0, 0.0, 0.0, 0.0);\n";a+="  }";a+="}\n";this.w=a;a=this.ya="";a+="varying lowp vec4 fragmentColor;\n";a+="\n";a+="void main(void) {\n";a+="  gl_FragColor = fragmentColor;\n";a+="}\n";this.ya=a;this.ab="vertexPosition";this.Ta="vertexNormal";this.Ma="vertexColor";this.Ya="vertexOpacity";this.s="lighting";this.hb="view";this.$a="perspective"}w(M,I);n=M.prototype;n.mc=m("w");
n.bc=m("ya");n.position=m("ab");n.color=m("Ma");n.view=m("hb");n.ba=m("$a");n.opacity=m("Ya");
n.Nb=function(){var a=31337,a=this.w.search(this.ab);a==-1&&g(new J("Fatal: Could not validate shader! The positionAttribute was bogus."));a=this.w.search(this.Ta);a==-1&&g(new J("Fatal: Could not validate shader! The normalAttribute was bogus."));a=this.w.search(this.Ma);a==-1&&g(new J("Fatal: Could not validate shader! The colorAttribute was bogus."));a=this.w.search(this.Ya);a==-1&&g(new J("Fatal: Could not validate shader! The opacityAttribute was bogus."));a=this.w.search(this.$a);a==-1&&g(new J("Fatal: Could not validate shader! The perspectiveUniform was bogus."));
a=this.w.search(this.hb);a==-1&&g(new J("Fatal: Could not validate shader! The viewUniform was bogus."));a=this.w.search(this.s);a==-1&&g(new J("Fatal: Could not validate shader! The lighting was bogus."));return!0};u("X.shaders",M);u("X.shaders.prototype.vertex",M.prototype.mc);u("X.shaders.prototype.fragment",M.prototype.bc);u("X.shaders.prototype.position",M.prototype.position);u("X.shaders.prototype.color",M.prototype.color);u("X.shaders.prototype.view",M.prototype.view);
u("X.shaders.prototype.perspective",M.prototype.ba);u("X.shaders.prototype.opacity",M.prototype.opacity);u("X.shaders.prototype.validate",M.prototype.Nb);function N(a,b){this.x=a;this.y=b}w(N,Ib);n=N.prototype;n.F=function(){return new N(this.x,this.y)};n.oa=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};n.scale=function(a){this.x*=a;this.y*=a;return this};n.qb=function(){this.x=-this.x;this.y=-this.y;return this};n.normalize=function(){return this.scale(1/this.oa())};n.add=function(a){this.x+=a.x;this.y+=a.y;return this};n.Ha=function(a){this.x-=a.x;this.y-=a.y;return this};function O(a,b){if(a instanceof O)this.j=a.Ia();else{var c;if(c=da(a))a:{for(var d=c=0;d<a.length;d++){if(!da(a[d])||c>0&&a[d].length!=c){c=!1;break a}for(var f=0;f<a[d].length;f++)if(!t(a[d][f])){c=!1;break a}if(c==0)c=a[d].length}c=c!=0}c?this.j=Xa(a):a instanceof Fb?this.j=Ob(a.height,a.width):t(a)&&t(b)&&a>0&&b>0?this.j=Ob(a,b):g(Error("Invalid argument(s) for Matrix contructor"))}this.f=new Fb(this.j[0].length,this.j.length)}
function Pb(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new O(b)}function Qb(a,b,c){for(var d=0;d<a.f.height;d++)for(var f=0;f<a.f.width;f++)b.call(c,a.j[d][f],d,f,a)}function Rb(a,b){var c=new O(a.f);Qb(a,function(d,f,e){c.j[f][e]=b.call(i,d,f,e,a)});return c}function Ob(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var f=0;f<b;f++)c[d][f]=0}return c}n=O.prototype;
n.add=function(a){Gb(this.f,a.f)||g(Error("Matrix summation is only supported on arrays of equal size"));return Rb(this,function(b,c,d){return b+a.j[c][d]})};function P(a,b,c,d){Sb(a,b,c)||g(Error("Index out of bounds when setting matrix value, ("+b+","+c+") in size ("+a.f.height+","+a.f.width+")"));a.j[b][c]=d}
n.multiply=function(a){if(a instanceof O)return this.f.width!=a.f.height&&g(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),Tb(this,a);else if(t(a))return Ub(this,a);else g(Error("A matrix can only be multiplied by a number or another matrix."))};n.Ha=function(a){Gb(this.f,a.f)||g(Error("Matrix subtraction is only supported on arrays of equal size."));return Rb(this,function(b,c,d){return b-a.j[c][d]})};n.Ia=m("j");
n.toString=function(){var a=0;Qb(this,function(b){b=String(b).length;b>a&&(a=b)});var b=[];Va(this.j,function(c){b.push("[ ");Va(c,function(c){c=String(c);b.push(Array(a-c.length+1).join(" ")+c+" ")});b.push("]\n")});return b.join("")};function Sb(a,b,c){return b>=0&&b<a.f.height&&c>=0&&c<a.f.width}function Tb(a,b){var c=new O(a.f.height,b.f.width);Qb(c,function(a,f,e){for(var h=a=0;h<this.f.width;h++)a+=(!Sb(this,f,h)?0:this.j[f][h])*(!Sb(b,h,e)?0:b.j[h][e]);P(c,f,e,a)},a);return c}
function Ub(a,b){return Rb(a,function(a){return a*b})};function Q(a,b,c){this.x=q(a)?a:0;this.y=q(b)?b:0;this.c=q(c)?c:0}Q.prototype.F=function(){return new Q(this.x,this.y,this.c)};Q.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.c+")"};Q.prototype.Ia=function(){return[this.x,this.y,this.c]};function R(a,b,c){this.x=a;this.y=b;this.c=c}w(R,Q);n=R.prototype;n.F=function(){return new R(this.x,this.y,this.c)};n.oa=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.c*this.c)};n.scale=function(a){this.x*=a;this.y*=a;this.c*=a;return this};n.qb=function(){this.x=-this.x;this.y=-this.y;this.c=-this.c;return this};n.normalize=function(){return this.scale(1/this.oa())};n.add=function(a){this.x+=a.x;this.y+=a.y;this.c+=a.c;return this};
n.Ha=function(a){this.x-=a.x;this.y-=a.y;this.c-=a.c;return this};function Vb(a,b){return new R(a.y*b.c-a.c*b.y,a.c*b.x-a.x*b.c,a.x*b.y-a.y*b.x)};O.prototype.o=function(){var a=[],b=this.f;if(b.height==0||b.width==0)return[];var c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(!Sb(this,c,d)?k:this.j[c][d]);return a};O.prototype.translate=function(a){this.f.width!=this.f.height&&g(new J("Fatal: Can not translate non-square matrix!"));var b=this.f,c=Pb(b.height);a instanceof N&&b.height==3?(P(c,0,2,a.x),P(c,1,2,a.y)):a instanceof R&&b.height==4?(P(c,0,3,a.x),P(c,1,3,a.y),P(c,2,3,a.c)):g(new J("Fatal: Translation failed!"));return this.multiply(c)};function Wb(a){this.$=a||Xb}function Xb(a,b){if(String(a)<String(b))return-1;else if(String(a)>String(b))return 1;return 0}n=Wb.prototype;n.q=k;n.$=k;n.D=k;n.C=k;n.e=0;
n.add=function(a){if(this.q==k)return this.C=this.D=this.q=new Yb(a),this.e=1,!0;var b=!1;Zb(this,function(c){var d=k;if(this.$(c.value,a)>0){if(d=c.left,c.left==k){var f=new Yb(a,c);c.left=f;if(c==this.D)this.D=f;b=!0;$b(this,c)}}else if(this.$(c.value,a)<0&&(d=c.right,c.right==k)){f=new Yb(a,c);c.right=f;if(c==this.C)this.C=f;b=!0;$b(this,c)}return d});b&&(this.e+=1);return b};
n.remove=function(a){var b=k;Zb(this,function(c){var d=k;if(this.$(c.value,a)>0)d=c.left;else if(this.$(c.value,a)<0)d=c.right;else if(b=c.value,c.left!=k||c.right!=k){var f=k,e;if(c.left!=k){e=ac(this,c.left);if(e!=c.left){if(e.parent.right=e.left)e.left.parent=e.parent;e.left=c.left;e.left.parent=e;f=e.parent}e.parent=c.parent;e.right=c.right;if(e.right)e.right.parent=e;if(c==this.C)this.C=e}else{e=bc(this,c.right);if(e!=c.right){if(e.parent.left=e.right)e.right.parent=e.parent;e.right=c.right;
e.right.parent=e;f=e.parent}e.parent=c.parent;e.left=c.left;if(e.left)e.left.parent=e;if(c==this.D)this.D=e}cc(c)?c.parent.left=e:dc(c)?c.parent.right=e:this.q=e;$b(this,f?f:e)}else if(cc(c)){this.uc=1;c.parent.left=k;if(c==this.D)this.D=c.parent;$b(this,c.parent)}else if(dc(c)){c.parent.right=k;if(c==this.C)this.C=c.parent;$b(this,c.parent)}else this.clear();return d});if(b)this.e=this.q?this.e-1:0;return b};n.clear=function(){this.C=this.D=this.q=k;this.e=0};
n.Ca=function(){var a=[];ec(this,function(b){a.push(b)});return a};function ec(a,b){if(a.q){var c,d=c=bc(a);for(c=c.left?c.left:c;d!=k;)if(d.left!=k&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var f=d,d=d.right!=k&&d.right!=c?d.right:d.parent;c=f}}}function Zb(a,b,c){for(c=c?c:a.q;c&&c!=k;)c=b.call(a,c)}
function $b(a,b){Zb(a,function(a){var b=a.left?a.left.height:0,f=a.right?a.right.height:0;b-f>1?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&fc(this,a.left),kc(this,a)):f-b>1&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&kc(this,a.right),fc(this,a));b=a.left?a.left.height:0;f=a.right?a.right.height:0;a.height=Math.max(b,f)+1;return a.parent},b)}
function fc(a,b){cc(b)?(b.parent.left=b.right,b.right.parent=b.parent):dc(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.q=b.right,a.q.parent=k);var c=b.right;b.right=b.right.left;if(b.right!=k)b.right.parent=b;c.left=b;b.parent=c}function kc(a,b){cc(b)?(b.parent.left=b.left,b.left.parent=b.parent):dc(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.q=b.left,a.q.parent=k);var c=b.left;b.left=b.left.right;if(b.left!=k)b.left.parent=b;c.right=b;b.parent=c}
function bc(a,b){if(!b)return a.D;var c=b;Zb(a,function(a){var b=k;if(a.left)b=c=a.left;return b},b);return c}function ac(a,b){if(!b)return a.C;var c=b;Zb(a,function(a){var b=k;if(a.right)b=c=a.right;return b},b);return c}function Yb(a,b){this.value=a;this.parent=b?b:k}Yb.prototype.left=k;Yb.prototype.right=k;Yb.prototype.height=1;function dc(a){return!!a.parent&&a.parent.right==a}function cc(a){return!!a.parent&&a.parent.left==a};function S(a,b,c){r(a)||g(new J("Fatal: Invalid GL Buffer!"));r(b)||g(new J("Fatal: Invalid number of items!"));r(c)||g(new J("Fatal: Invalid item size!"));I.call(this);this.i="buffer";this.T=a;this.Ra=b;this.U=c}w(S,I);S.prototype.cc=m("T");S.prototype.ec=m("Ra");S.prototype.fc=m("U");u("X.buffer",S);u("X.buffer.prototype.glBuffer",S.prototype.cc);u("X.buffer.prototype.itemCount",S.prototype.ec);u("X.buffer.prototype.itemSize",S.prototype.fc);var lc="StopIteration"in p?p.StopIteration:Error("StopIteration");function mc(){}mc.prototype.next=function(){g(lc)};mc.prototype.R=function(){return this};function T(a,b){this.p={};this.g=[];var c=arguments.length;if(c>1){c%2&&g(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){var f;if(a instanceof T)nc(a),f=a.g.concat(),d=a.Ca();else{var c=[],e=0;for(f in a)c[e++]=f;f=c;c=[];e=0;for(d in a)c[e++]=a[d];d=c}for(c=0;c<f.length;c++)this.set(f[c],d[c])}}n=T.prototype;n.e=0;n.fa=0;n.Ca=function(){nc(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.p[this.g[b]]);return a};
function oc(a,b){return pc(a.p,b)}function qc(a,b){for(var c=0;c<a.g.length;c++){var d=a.g[c];if(pc(a.p,d)&&a.p[d]==b)return!0}return!1}n.clear=function(){this.p={};this.fa=this.e=this.g.length=0};n.remove=function(a){return pc(this.p,a)?(delete this.p[a],this.e--,this.fa++,this.g.length>2*this.e&&nc(this),!0):!1};
function nc(a){if(a.e!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];pc(a.p,d)&&(a.g[c++]=d);b++}a.g.length=c}if(a.e!=a.g.length){for(var f={},c=b=0;b<a.g.length;)d=a.g[b],pc(f,d)||(a.g[c++]=d,f[d]=1),b++;a.g.length=c}}n.get=function(a,b){return pc(this.p,a)?this.p[a]:b};n.set=function(a,b){pc(this.p,a)||(this.e++,this.g.push(a),this.fa++);this.p[a]=b};n.F=function(){return new T(this)};
n.R=function(a){nc(this);var b=0,c=this.g,d=this.p,f=this.fa,e=this,h=new mc;h.next=function(){for(;;){f!=e.fa&&g(Error("The map has changed since the iterator was created"));b>=c.length&&g(lc);var h=c[b++];return a?h:d[h]}};return h};function pc(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function U(){I.call(this);this.i="colors";this.k=new T;this.H=-1}w(U,I);n=U.prototype;n.add=function(a){a instanceof Array&&a.length==3&&(a=new K(a[0],a[1],a[2]));(!r(a)||!(a instanceof K))&&g(new J("Fatal: Invalid color."));oc(this.k,++this.H)&&g(new J("Fatal: Could not get unique id."));this.k.set(this.H,a);return this.H};n.get=function(a){(!r(a)||!oc(this.k,a))&&g(new J("Fatal: Invalid id."));return this.k.get(a)};
n.remove=function(a){(!r(a)||!(a instanceof K))&&g(new J("Fatal: Invalid color."));if(!qc(this.k,a))return!1;var b=this.k.R(!0);try{for(;;){var c=b.next();if(this.k.get(c)==a)return this.k.remove(c)}}catch(d){d!=lc&&g(d)}};n.Ga=function(a){r(a)||g(new J("Fatal: Invalid id."));return!oc(this.k,a)?!1:this.k.remove(a)};n.clear=function(){this.k=new T};n.count=function(){return this.k.e};n.o=function(){var a=[],b=this.k.R(!0);try{for(;;)var c=this.k.get(b.next()).o(),a=a.concat(c)}catch(d){d!=lc&&g(d)}return a};
u("X.colors",U);u("X.colors.prototype.add",U.prototype.add);u("X.colors.prototype.get",U.prototype.get);u("X.colors.prototype.remove",U.prototype.remove);u("X.colors.prototype.removeById",U.prototype.Ga);u("X.colors.prototype.count",U.prototype.count);u("X.colors.prototype.flatten",U.prototype.o);function V(){I.call(this);this.i="points";this.l=new T;this.H=-1}w(V,I);n=V.prototype;n.add=function(a){r(a)||g(new J("Fatal: Invalid point."));ca(a)&&a.length==3&&(a=new Q(a[0],a[1],a[2]));a instanceof Q||g(new J("Fatal: Invalid point."));oc(this.l,++this.H)&&g(new J("Fatal: Could not get unique id."));this.l.set(this.H,a);return this.H};n.get=function(a){(!r(a)||!oc(this.l,a))&&g(new J("Fatal: Invalid id."));return this.l.get(a)};
n.remove=function(a){a instanceof Q||g(new J("Fatal: Invalid point."));if(!qc(this.l,a))return!1;var b=this.l.R(!0);try{for(;;){var c=b.next();if(this.l.get(c)==a)return this.l.remove(c)}}catch(d){d!=lc&&g(d)}};n.Ga=function(a){r(a)||g(new J("Fatal: Invalid id."));return!oc(this.l,a)?!1:this.l.remove(a)};n.clear=function(){this.l=new T};n.count=function(){return this.l.e};n.o=function(){var a=[],b=this.l.R(!0);try{for(;;)var c=this.l.get(b.next()).Ia(),a=a.concat(c)}catch(d){d!=lc&&g(d)}return a};
u("X.points",V);u("X.points.prototype.add",V.prototype.add);u("X.points.prototype.get",V.prototype.get);u("X.points.prototype.remove",V.prototype.remove);u("X.points.prototype.removeById",V.prototype.Ga);u("X.points.prototype.count",V.prototype.count);u("X.points.prototype.flatten",V.prototype.o);function rc(a){z.call(this,a)}w(rc,z);u("X.event",rc);u("X.event.uniqueId",function(a){return a+"_"+Cb++});function W(a,b){(!t(a)||!t(b))&&g(new J("Fatal: A camera needs valid width and height values."));I.call(this);this.i="camera";this.Rb=45;this.t=new R(0,0,100);this.A=new R(0,0,0);this.Vb=new R(0,1,0);var c=a/b,d=1*Math.tan(this.Rb*Math.PI/360),f=-d;this.Tb=new O([[2/(d*c-f*c),0,(d*c+f*c)/(d*c-f*c),0],[0,2/(d-f),(d+f)/(d-f),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]]);this.Z=sc(this,this.t,this.A)}w(W,I);var tc="pan_"+Cb++,uc="rotate_"+Cb++,vc="zoom_"+Cb++;n=W.prototype;
n.Ea=function(a){(!r(a)||!(a instanceof Y))&&g(new J("Fatal: Could not observe the interactor."));H(a,tc,this.Fb.bind(this));H(a,uc,this.Gb.bind(this));H(a,vc,this.Hb.bind(this))};n.Hb=function(a){a instanceof wc||g(new J("Fatal: Received no valid zoom event!"));a.za?this.Ob(a.ha):this.Pb(a.ha)};n.Fb=function(a){a instanceof xc||g(new J("Fatal: Received no valid pan event!"));this.Ib(a.S)};n.Gb=function(a){a instanceof yc||g(new J("Fatal: Received no valid rotate event!"));this.rotate(a.S)};
n.ba=m("Tb");n.view=m("Z");n.position=m("t");n.Ib=function(a){a instanceof N||g(new J("Fatal: Invalid distance vector for pan operation."));this.t.x+=a.x;this.t.y-=a.y;this.A.x+=a.x;this.A.y-=a.y;this.Z=sc(this,this.t,this.A);this.dispatchEvent(new zc)};n.rotate=function(a){a instanceof N||g(new J("Fatal: Invalid distance vector for rotate operation."));this.t.x+=a.x;this.t.y-=a.y;this.Z=sc(this,this.t,this.A);this.dispatchEvent(new zc)};
n.Ob=function(a){var b=30;r(a)&&!a&&(b=1);this.t.c-=b;this.A.c-=b;this.Z=sc(this,this.t,this.A);this.dispatchEvent(new zc)};n.Pb=function(a){var b=30;r(a)&&!a&&(b=1);this.t.c+=b;this.A.c+=b;this.Z=sc(this,this.t,this.A);this.dispatchEvent(new zc)};
function sc(a,b,c){(!(b instanceof R)||!(c instanceof R))&&g(new J("Fatal: 3D vectors required for calculating the view."));var d=Pb(4),c=new R(b.x-c.x,b.y-c.y,b.c-c.c),c=c.normalize(),a=a.Vb.F(),f=Vb(a,c),a=Vb(c,f),f=f.normalize(),a=a.normalize();P(d,0,0,f.x);P(d,0,1,f.y);P(d,0,2,f.c);P(d,0,3,0);P(d,1,0,a.x);P(d,1,1,a.y);P(d,1,2,a.c);P(d,1,3,0);P(d,2,0,c.x);P(d,2,1,c.y);P(d,2,2,c.c);P(d,2,3,0);P(d,3,0,0);P(d,3,1,0);P(d,3,2,0);P(d,3,3,1);b=b.F();return d.translate(b.qb())}
function xc(){z.call(this,tc);this.S=k}w(xc,rc);function yc(){z.call(this,uc);this.S=k;this.Qb=0}w(yc,rc);function wc(){z.call(this,vc);this.ha=this.za=!1}w(wc,rc);u("X.camera",W);u("X.camera.prototype.observe",W.prototype.Ea);u("X.camera.prototype.onZoom",W.prototype.Hb);u("X.camera.prototype.onPan",W.prototype.Fb);u("X.camera.prototype.onRotate",W.prototype.Gb);u("X.camera.prototype.perspective",W.prototype.ba);u("X.camera.prototype.view",W.prototype.view);u("X.camera.prototype.position",W.prototype.position);
u("X.camera.prototype.pan",W.prototype.Ib);u("X.camera.prototype.rotate",W.prototype.rotate);u("X.camera.prototype.zoomIn",W.prototype.Ob);u("X.camera.prototype.zoomOut",W.prototype.Pb);u("X.camera.prototype.observe",W.prototype.Ea);u("X.camera.PanEvent",xc);u("X.camera.RotateEvent",yc);u("X.camera.ZoomEvent",wc);function Z(a){var b=Ac;if(r(a)&&(a==Bc||a==Ac))b=a;I.call(this);this.i="object";this.Ub=b;this.La=k;this.d=new V;this.Aa=new V;this.h=new U;this.nc=this.qc=k;this.Xa=1;this.sc=!0}w(Z,I);var Ac="TRIANGLES",Bc="LINES";n=Z.prototype;n.type=m("Ub");n.ic=m("d");n.gc=m("Aa");n.Xb=m("h");n.color=m("La");n.da=function(a){!r(a)&&!(a instanceof K)&&g(new J("Fatal: Invalid color."));this.La=a};n.opacity=m("Xa");n.pa=function(a){(!t(a)||a>1||a<0)&&g(new J("Fatal: Invalid opacity."));this.Xa=a};
function Cc(a,b){(!r(a)||!r(b)||!(a instanceof Z)||!(b instanceof Z))&&g(new J("Fatal: Two valid X.objects are required for comparison."));if(a.opacity()<=b.opacity())return 1;else if(a.opacity()>b.opacity())return-1}u("X.object",Z);u("X.object.prototype.type",Z.prototype.type);u("X.object.prototype.points",Z.prototype.ic);u("X.object.prototype.normals",Z.prototype.gc);u("X.object.prototype.colors",Z.prototype.Xb);u("X.object.prototype.color",Z.prototype.color);u("X.object.prototype.setColor",Z.prototype.da);
u("X.object.prototype.opacity",Z.prototype.opacity);u("X.object.prototype.setOpacity",Z.prototype.pa);u("X.object.OPACITY_COMPARATOR",Cc);function Dc(a){this.ac=a;this.sb=H(this.ac,Ba?"DOMMouseScroll":"mousewheel",this)}w(Dc,Db);
Dc.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.J;if(a.type=="mousewheel"){c=1;if(x||Ca&&(Fa||Oa("532.0")))c=40;d=Ca&&wa&&-a.wheelDelta%c!=0?-a.wheelDelta:-a.wheelDelta/c;q(a.wheelDeltaX)?(b=Ca&&wa&&-a.wheelDeltaX%c!=0?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Ca&&wa&&-a.wheelDeltaY%c!=0?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,d>100?d=3:d<-100&&(d=-3),q(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;t(this.ub)&&(b=Math.min(Math.max(b,-this.ub),this.ub));t(this.vb)&&(c=Math.min(Math.max(c,
-this.vb),this.vb));b=new Ec(d,a,b,c);try{this.dispatchEvent(b)}finally{b.I()}};Dc.prototype.z=function(){Dc.Q.z.call(this);xb(this.sb);delete this.sb};function Ec(a,b,c,d){b&&this.u(b,i);this.type="mousewheel";this.detail=a;this.tc=c;this.Yb=d}w(Ec,A);function Y(a){(!r(a)||!(a instanceof Element))&&g(new J("Fatal: Could not add interactor to the given element."));I.call(this);this.i="interactor";this.N=a;this.Sa=k;this.ka=this.ja=this.V=!1;this.ia=new N(0,0)}w(Y,I);n=Y.prototype;n.zb=function(){this.Sa=new Dc(this.N);H(this.Sa,"mousewheel",this.Eb.bind(this))};n.xb=function(){H(this.N,"mousedown",this.Ab.bind(this));H(this.N,"mouseup",this.Db.bind(this));this.N.oncontextmenu=function(){return!1}};
n.yb=function(){H(this.N,"mousemove",this.Bb.bind(this));H(this.N,"mouseout",this.Cb.bind(this))};n.Ab=function(a){if(a.button==0)this.V=!0;else if(a.button==1)this.ja=!0;else if(a.button==2)this.ka=!0;a.preventDefault()};n.Db=function(a){if(a.button==0)this.V=!1;else if(a.button==1)this.ja=!1;else if(a.button==2)this.ka=!1;a.preventDefault()};n.Cb=function(a){this.ka=this.ja=this.V=!1;this.ia.x=0;this.ia.y=0;a.preventDefault()};
n.Bb=function(a){this.dispatchEvent("mouseup");a.preventDefault();var b=a.shiftKey,c=new N(a.clientX,a.clientY),a=this.ia.Ha(c);this.ia=c.F();if(Math.abs(a.x)<2)a.x=0;if(Math.abs(a.y)<2)a.y=0;if(a.oa()!=0)if(this.V&&!b)b=new yc,b.S=a,b.Qb=0,this.dispatchEvent(b);else if(this.ja||this.V&&b)b=new xc,b.S=a,this.dispatchEvent(b);else if(this.ka)b=new wc,b.za=a.y<0,b.ha=!1,this.dispatchEvent(b)};n.Eb=function(a){a.preventDefault();var b=new wc;b.za=a.Yb>0;b.ha=!0;this.dispatchEvent(b)};
u("X.interactor",Y);u("X.interactor.prototype.observeMouseWheel",Y.prototype.zb);u("X.interactor.prototype.observeMouseClicks",Y.prototype.xb);u("X.interactor.prototype.observeMouseMovement",Y.prototype.yb);u("X.interactor.prototype.onMouseDown",Y.prototype.Ab);u("X.interactor.prototype.onMouseUp",Y.prototype.Db);u("X.interactor.prototype.onMouseMovementOutside",Y.prototype.Cb);u("X.interactor.prototype.onMouseMovementInside",Y.prototype.Bb);u("X.interactor.prototype.onMouseWheel",Y.prototype.Eb);function $(a,b){if(!(this instanceof Fc)&&!(this instanceof Gc)){var c="";c+="Fatal: X.renderer should not be instantiated directly.";c+="Use X.renderer2D or X.renderer3D instead.";g(new J(c))}(!t(a)||!t(b))&&g(new J("Fatal: Invalid width or height for the renderer."));I.call(this);this.i="renderer";this.xa=-1;this.ib=a;this.Pa=b;this.Ja="#000000";this.Qa=this.G=this.la=this.ma=this.a=this.m=this.ga=k;this.Wa=new Wb(Cc);this.cb=new T;this.Ua=new T;this.Na=new T;this.Za=new T;this.s=!0}w($,I);
var Hc="render_"+Cb++;function zc(){z.call(this,Hc);this.rc=Date.now()}w(zc,rc);n=$.prototype;n.$b=m("xa");n.width=m("ib");n.lc=function(a){this.m&&this.m.style.setProperty("width",a.toString());this.ib=a};n.height=m("Pa");n.kc=function(a){this.m&&this.m.style.setProperty("height",a.toString());this.Pa=a};n.backgroundColor=m("Ja");n.Kb=function(a){this.m&&this.m.style.setProperty("background-color",a.toString());this.Ja=a};
n.canvas=function(){r(this.m)||g(new J("Fatal: No valid canvas for this renderer!"));return this.m};n.lb=function(){if(!this.ga){var a=document.body;a||g(new J("Fatal: Could not find <body></body>!"));this.ga=a}return this.ga};n.Lb=function(a){a||g(new J("Fatal: Could not find container!"));this.ga=a};n.ea=function(a){this.Lb(s(a)?document.getElementById(a):a)};n.Wb=m("G");n.dc=m("Qa");
n.u=function(){if(!r(this.m)){var a=Lb("canvas");a.style.setProperty("background-color",this.backgroundColor().toString());a.width=this.width();a.height=this.height();this.lb().appendChild(a);try{var b=a.getContext("experimental-webgl")}catch(c){g(new J("Fatal: Exception while getting GL Context!\n"+c))}b||g(new J("Fatal: WebGL not supported!"));try{b.viewport(0,0,this.width(),this.height()),b.clearColor(0,0,0,0),b.enable(b.BLEND),b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA),b.disable(b.DEPTH_TEST),
b.depthFunc(b.LEQUAL),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)}catch(d){g(new J("Fatal: Exception while accessing GL Context!\n"+d))}var f=new Y(a);f.zb();f.xb();f.yb();var e=new W(this.width(),this.height());e.Ea(f);H(e,Hc,this.M.bind(this));this.m=a;this.a=b;this.G=e;this.Qa=f;this.jb(new M)}};
n.jb=function(a){(!r(this.m)||!r(this.a)||!r(this.G))&&g(new J("Fatal: Renderer was not initialized properly!"));(!r(a)||!(a instanceof M))&&g(new J("Fatal: Could not add shaders!"));a.Nb();var b=this.a.createShader(this.a.FRAGMENT_SHADER),c=this.a.createShader(this.a.VERTEX_SHADER);this.a.shaderSource(b,a.ya);this.a.shaderSource(c,a.w);this.a.compileShader(b);this.a.compileShader(c);(!this.a.getShaderParameter(b,this.a.COMPILE_STATUS)||!this.a.getShaderParameter(c,this.a.COMPILE_STATUS))&&g(new J("Fatal: Shader compilation failed!"));
var d=this.a.createProgram();this.a.attachShader(d,c);this.a.attachShader(d,b);this.a.linkProgram(d);this.a.getProgramParameter(d,this.a.LINK_STATUS)||g(new J("Fatal: Could not create shader program!"));this.a.useProgram(d);this.gb=this.a.getAttribLocation(d,a.position());this.a.enableVertexAttribArray(this.gb);this.Va=this.a.getAttribLocation(d,a.Ta);this.a.enableVertexAttribArray(this.Va);this.eb=this.a.getAttribLocation(d,a.color());this.a.enableVertexAttribArray(this.eb);this.fb=this.a.getAttribLocation(d,
a.opacity());this.a.enableVertexAttribArray(this.fb);this.la=d;this.ma=a};
n.n=function(a){(!r(this.m)||!r(this.a)||!r(this.G))&&g(new J("Fatal: Renderer was not initialized properly!"));(!r(a)||!(a instanceof Z))&&g(new J("Fatal: Illegal object!"));var b=!1,c=new K(1,1,1),d=k;a.color()===k?(b=a.d.count()==a.h.count(),d=a.h):c=a.color();if(!b){d=new U;for(b=0;b<a.d.count();b++)d.add(c)}c=this.a.createBuffer();this.a.bindBuffer(this.a.ARRAY_BUFFER,c);this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(a.d.o()),this.a.STATIC_DRAW);c=new S(c,a.d.count(),3);b=this.a.createBuffer();
this.a.bindBuffer(this.a.ARRAY_BUFFER,b);this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(a.Aa.o()),this.a.STATIC_DRAW);var b=new S(b,a.Aa.count(),3),f=this.a.createBuffer();this.a.bindBuffer(this.a.ARRAY_BUFFER,f);this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(d.o()),this.a.STATIC_DRAW);var d=new S(f,d.count(),3),f=this.a.createBuffer(),e=Array(a.d.o().length),h;for(h=0;h<e.length;++h)e[h]=a.opacity();this.a.bindBuffer(this.a.ARRAY_BUFFER,f);this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(e),
this.a.STATIC_DRAW);f=new S(f,1,1);this.Wa.add(a)||g(new J("Fatal: Could not add object to this renderer."));this.cb.set(a.id(),c);this.Ua.set(a.id(),b);this.Na.set(a.id(),d);this.Za.set(a.id(),f)};
n.M=function(){(!this.m||!this.a||!this.G)&&g(new J("Fatal: The renderer was not initialized properly!"));this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var a=this.G.ba(),b=this.G.view();this.a.uniformMatrix4fv(this.a.getUniformLocation(this.la,this.ma.ba()),!1,new Float32Array(a.o()));this.a.uniformMatrix4fv(this.a.getUniformLocation(this.la,this.ma.view()),!1,new Float32Array(b.o()));this.a.uniform1i(this.a.getUniformLocation(this.la,this.ma.s),this.s);var a=this.Wa.Ca(),b=a.length,
c;for(c=0;c<b;++c){var d=a[c];if(d){var f=d.id(),e=this.cb.get(f),h=this.Ua.get(f),o=this.Na.get(f),f=this.Za.get(f);this.a.bindBuffer(this.a.ARRAY_BUFFER,e.T);this.a.vertexAttribPointer(this.gb,e.U,this.a.FLOAT,!1,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,h.T);this.a.vertexAttribPointer(this.Va,h.U,this.a.FLOAT,!1,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,o.T);this.a.vertexAttribPointer(this.eb,o.U,this.a.FLOAT,!1,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,f.T);this.a.vertexAttribPointer(this.fb,
f.U,this.a.FLOAT,!1,0,0);h=-1;if(d.type()==Ac)h=this.a.TRIANGLES;else if(d.type()==Bc)h=this.a.LINES;this.a.drawArrays(h,0,e.Ra)}else g(new J("Fatal: Could not retrieve object for (re-)drawing!"))}};u("X.renderer",$);u("X.renderer.prototype.dimension",$.prototype.$b);u("X.renderer.prototype.width",$.prototype.width);u("X.renderer.prototype.setWidth",$.prototype.lc);u("X.renderer.prototype.height",$.prototype.height);u("X.renderer.prototype.setHeight",$.prototype.kc);
u("X.renderer.prototype.backgroundColor",$.prototype.backgroundColor);u("X.renderer.prototype.setBackgroundColor",$.prototype.Kb);u("X.renderer.prototype.canvas",$.prototype.canvas);u("X.renderer.prototype.container",$.prototype.lb);u("X.renderer.prototype.setContainer",$.prototype.Lb);u("X.renderer.prototype.setContainerById",$.prototype.ea);u("X.renderer.prototype.camera",$.prototype.Wb);u("X.renderer.prototype.interactor",$.prototype.dc);u("X.renderer.prototype.init",$.prototype.u);
u("X.renderer.prototype.addShaders",$.prototype.jb);u("X.renderer.prototype.addObject",$.prototype.n);u("X.renderer.prototype.render",$.prototype.M);u("X.renderer.RenderEvent",zc);function Fc(a,b){$.call(this,a,b);this.i="renderer2D";this.xa=2}w(Fc,$);u("X.renderer2D",Fc);function Ic(a,b,c,d,f){(!r(a)||!(a instanceof R))&&g(new J("Fatal: Invalid center for the cuboid!"));(!t(b)||!t(c)||!t(d))&&g(new J("Fatal: Wrong edge lengths for the cuboid!"));Z.call(this,f);this.i="cuboid";this.r=a;this.W=b;this.X=c;this.Y=d;this.b=1;this.va=this.ua=this.ta=this.sa=this.ra=this.qa=k;Jc(this)}w(Ic,Z);
function Kc(a){var b=new K(1,0,0),c=new K(0,1,0),d=new K(0,0,1),f=new K(1,1,0),e=new K(1,0,1),h=new K(0,1,1);(!r(b)||!(b instanceof K))&&g(new J("Fatal: Wrong color for side A!"));(!r(c)||!(c instanceof K))&&g(new J("Fatal: Wrong color for side B!"));(!r(d)||!(d instanceof K))&&g(new J("Fatal: Wrong color for side C!"));(!r(f)||!(f instanceof K))&&g(new J("Fatal: Wrong color for side D!"));(!r(e)||!(e instanceof K))&&g(new J("Fatal: Wrong color for side E!"));(!r(h)||!(h instanceof K))&&g(new J("Fatal: Wrong color for side F!"));
a.qa=b;a.ra=c;a.sa=d;a.ta=f;a.ua=e;a.va=h;Jc(a)}Ic.prototype.Mb=function(a){t(a)||g(new J("Fatal: Wrong spacing value!"));this.b=a;Jc(this)};
function Jc(a){a.d.clear();a.h.clear();var b=new R(a.r.x-a.W,a.r.y+a.X,a.r.c+a.Y),c=new R(a.r.x+a.W,a.r.y+a.X,a.r.c+a.Y),d=new R(a.r.x-a.W,a.r.y-a.X,a.r.c+a.Y),f=new R(a.r.x-a.W,a.r.y+a.X,a.r.c-a.Y),e=2*a.W/a.b,h=2*a.X/a.b,o=2*a.Y/a.b,j,l=0;for(j=0;j<e;++j)for(l=0;l<h;++l)if(a.d.add([f.x+j*a.b,f.y-l*a.b,f.c]),a.d.add([f.x+j*a.b+1,f.y-l*a.b,f.c]),a.d.add([f.x+j*a.b,f.y-l*a.b-1,f.c]),a.d.add([f.x+j*a.b+1,f.y-l*a.b,f.c]),a.d.add([f.x+j*a.b,f.y-l*a.b-1,f.c]),a.d.add([f.x+j*a.b+1,f.y-l*a.b-1,f.c]),a.va){var B;
for(B=0;B<6;++B)a.h.add(a.va)}for(j=0;j<e;++j)for(l=0;l<o;++l)if(a.d.add([b.x+j*a.b,b.y,b.c-l*a.b]),a.d.add([b.x+j*a.b+1,b.y,b.c-l*a.b]),a.d.add([b.x+j*a.b,b.y,b.c-l*a.b-1]),a.d.add([b.x+j*a.b+1,b.y,b.c-l*a.b]),a.d.add([b.x+j*a.b,b.y,b.c-l*a.b-1]),a.d.add([b.x+j*a.b+1,b.y,b.c-l*a.b-1]),a.ra)for(f=0;f<6;++f)a.h.add(a.ra);for(j=0;j<h;++j)for(l=0;l<o;++l)if(a.d.add([c.x,c.y-j*a.b,c.c-l*a.b]),a.d.add([c.x,c.y-j*a.b-1,c.c-l*a.b]),a.d.add([c.x,c.y-j*a.b,c.c-l*a.b-1]),a.d.add([c.x,c.y-j*a.b-1,c.c-l*a.b]),
a.d.add([c.x,c.y-j*a.b,c.c-l*a.b-1]),a.d.add([c.x,c.y-j*a.b-1,c.c-l*a.b-1]),a.sa)for(f=0;f<6;++f)a.h.add(a.sa);for(j=0;j<e;++j)for(l=0;l<o;++l)if(a.d.add([d.x+j*a.b,d.y,d.c-l*a.b]),a.d.add([d.x+j*a.b+1,d.y,d.c-l*a.b]),a.d.add([d.x+j*a.b,d.y,d.c-l*a.b-1]),a.d.add([d.x+j*a.b+1,d.y,d.c-l*a.b]),a.d.add([d.x+j*a.b,d.y,d.c-l*a.b-1]),a.d.add([d.x+j*a.b+1,d.y,d.c-l*a.b-1]),a.ta)for(c=0;c<6;++c)a.h.add(a.ta);for(j=0;j<h;++j)for(l=0;l<o;++l)if(a.d.add([b.x,b.y-j*a.b,b.c-l*a.b]),a.d.add([b.x,b.y-j*a.b-1,b.c-
l*a.b]),a.d.add([b.x,b.y-j*a.b,b.c-l*a.b-1]),a.d.add([b.x,b.y-j*a.b-1,b.c-l*a.b]),a.d.add([b.x,b.y-j*a.b,b.c-l*a.b-1]),a.d.add([b.x,b.y-j*a.b-1,b.c-l*a.b-1]),a.ua)for(d=0;d<6;++d)a.h.add(a.ua);for(j=0;j<e;++j)for(l=0;l<h;++l)if(a.d.add([b.x+j*a.b,b.y-l*a.b,b.c]),a.d.add([b.x+j*a.b+1,b.y-l*a.b,b.c]),a.d.add([b.x+j*a.b,b.y-l*a.b-1,b.c]),a.d.add([b.x+j*a.b+1,b.y-l*a.b,b.c]),a.d.add([b.x+j*a.b,b.y-l*a.b-1,b.c]),a.d.add([b.x+j*a.b+1,b.y-l*a.b-1,b.c]),a.qa)for(o=0;o<6;++o)a.h.add(a.qa)}u("X.cuboid",Ic);
u("X.cuboid.prototype.setSpacing",Ic.prototype.Mb);function Lc(a,b,c){Ic.call(this,a,b,b,b,c);this.i="cube"}w(Lc,Ic);u("X.cube",Lc);function Gc(a,b){$.call(this,a,b);this.i="renderer3D";this.xa=3}w(Gc,$);u("X.renderer3D",Gc);var Mc={jc:function(){var a=new L;a.O("Starting sampleApp.init..");try{var b=document.getElementById("lighting").checked,c=new Fc(300,300);c.ea("sliceView1");c.u();c.s=b;var d=new Fc(300,300);d.ea("sliceView2");d.u();d.s=b;var f=new Fc(300,300);f.ea("sliceView3");f.u();f.s=b;var e=new Gc(912,400);e.ea("threeDView");e.Kb("#b3b3e7");e.u();e.s=b;var h=new Z;h.d.add([2,2,0]);h.d.add([3,3,0]);h.d.add([1,2.5,0]);h.da(new K(1,0,0));h.h.add(new K(1,1,1));h.h.add(new K(1,1,1));h.h.add(new K(1,1,1));var o=
new Z(Bc);o.d.add([20,20,0]);o.d.add([30,30,0]);o.d.add([10,20.5,0]);o.d.add([10,40.5,0]);o.h.add(new K(1,1,1));o.h.add(new K(1,0,0));o.h.add(new K(0,0,1));o.h.add(new K(0,0,1));o.pa(0.5);var j=new Z;j.d.add([-40,-40,0]);j.d.add([-50,-50,0]);j.d.add([-30,-30,0]);j.d.add([10,20.5,0]);var l=new K(0,1,0),B=new Z;B.d.add([-30,40,0]);B.d.add([-50,30,0]);B.d.add([-30,30,0]);B.d.add([-10,20,0]);B.da(l);B.pa(0.5);var v=new K(0,1,0),C=new Z;C.d.add([-30,40,-10]);C.d.add([-50,30,-10]);C.d.add([-20,10,-10]);
C.d.add([-10,10,-10]);C.da(v);C.pa(0.1);var G=new Ic(new R(10,10,10),5,10,20);Kc(G);G.Mb(2);var gc=new Lc(new R(-10,-10,-10),5);gc.da(new K(0,0,1));var hc=new Lc(new R(0,0,0),3);Kc(hc);c.n(h);d.n(h);f.n(h);e.n(h);e.n(o);e.n(j);e.n(B);e.n(C);e.n(G);e.n(gc);e.n(hc);setInterval(function(){c.s=b;c.M();d.s=b;d.M();f.s=b;f.M();e.s=b;e.M()},15);a.O(c.print());a.O(d.print());a.O(f.print());a.O(e.print());var Nc=function(a){var a=a.target.result.split("\n"),b=new Z,c;for(c=0;c<a.length;c++){var d=a[c].split(" ");
d[3]=="vertex"&&b.d.add([d[4],d[5],d[6]])}e.n(b);e.M()},ic=document.getElementById("threeDView");ic.addEventListener("dragover",function(a){a.stopPropagation();a.preventDefault()},!1);ic.addEventListener("drop",function(a){a.stopPropagation();a.preventDefault();var a=a.dataTransfer.files,b,c=0;for(b=0;c=a[b];b++){var d=new FileReader;d.onloadend=Nc;d.readAsText(c)}},!1)}catch(jc){jc instanceof J&&a.pb(jc.print())}}};u("sampleApp",Mc);u("sampleApp.run",Mc.jc);
